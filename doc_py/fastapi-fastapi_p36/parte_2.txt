* Die alternative Dokumentation wird ebenfalls den neuen Abfrageparameter und -inhalt widerspiegeln:

![ReDoc](https://fastapi.tiangolo.com/img/index/index-06-redoc-02.png)

### Zusammenfassung

Zusammengefasst deklarieren Sie **einmal** die Typen von Parametern, Body, etc. als Funktionsparameter.

Das machen Sie mit modernen Standard-Python-Typen.

Sie m√ºssen keine neue Syntax, Methoden oder Klassen einer bestimmten Bibliothek usw. lernen.

Nur Standard-**Python+**.

Zum Beispiel f√ºr ein `int`:

```Python
item_id: int
```

oder f√ºr ein komplexeres `Item`-Modell:

```Python
item: Item
```

... und mit dieser einen Deklaration erhalten Sie:

* Editor-Unterst√ºtzung, einschlie√ülich:
    * Code-Vervollst√§ndigung.
    * Typpr√ºfungen.
* Validierung von Daten:
    * Automatische und eindeutige Fehler, wenn die Daten ung√ºltig sind.
    * Validierung auch f√ºr tief verschachtelte JSON-Objekte.
* <abbr title="auch bekannt als: Serialisierung, Parsen, Marshalling">Konvertierung</abbr> von Eingabedaten: Aus dem Netzwerk kommend, zu Python-Daten und -Typen. Lesen von:
    * JSON.
    * Pfad-Parametern.
    * Abfrage-Parametern.
    * Cookies.
    * Header-Feldern.
    * Formularen.
    * Dateien.
* <abbr title="auch bekannt als: Serialisierung, Parsen, Marshalling">Konvertierung</abbr> von Ausgabedaten: Konvertierung von Python-Daten und -Typen zu Netzwerkdaten (als JSON):
    * Konvertieren von Python-Typen (`str`, `int`, `float`, `bool`, `list`, usw.).
    * `Datetime`-Objekte.
    * `UUID`-Objekte.
    * Datenbankmodelle.
    * ... und viele mehr.
* Automatische interaktive API-Dokumentation, einschlie√ülich 2 alternativer Benutzeroberfl√§chen:
    * Swagger UI.
    * ReDoc.

---

Um auf das vorherige Codebeispiel zur√ºckzukommen, **FastAPI** wird:

* √úberpr√ºfen, dass es eine `item_id` im Pfad f√ºr `GET`- und `PUT`-Anfragen gibt.
* √úberpr√ºfen, ob die `item_id` vom Typ `int` f√ºr `GET`- und `PUT`-Anfragen ist.
    * Falls nicht, wird dem Client ein n√ºtzlicher, eindeutiger Fehler angezeigt.
* Pr√ºfen, ob es einen optionalen Abfrageparameter namens `q` (wie in `http://127.0.0.1:8000/items/foo?q=somequery`) f√ºr `GET`-Anfragen gibt.
    * Da der `q`-Parameter mit `= None` deklariert ist, ist er optional.
    * Ohne das `None` w√§re er erforderlich (wie der Body im Fall von `PUT`).
* Bei `PUT`-Anfragen an `/items/{item_id}` den Body als JSON lesen:
    * Pr√ºfen, ob er ein erforderliches Attribut `name` hat, das ein `str` sein muss.
    * Pr√ºfen, ob er ein erforderliches Attribut `price` hat, das ein `float` sein muss.
    * Pr√ºfen, ob er ein optionales Attribut `is_offer` hat, das ein `bool` sein muss, falls vorhanden.
    * All dies w√ºrde auch f√ºr tief verschachtelte JSON-Objekte funktionieren.
* Automatisch von und nach JSON konvertieren.
* Alles mit OpenAPI dokumentieren, welches verwendet werden kann von:
    * Interaktiven Dokumentationssystemen.
    * Automatisch Client-Code generierenden Systemen f√ºr viele Sprachen.
* Zwei interaktive Dokumentation-Webschnittstellen direkt zur Verf√ºgung stellen.

---

Wir haben nur an der Oberfl√§che gekratzt, aber Sie bekommen schon eine Vorstellung davon, wie das Ganze funktioniert.

Versuchen Sie, diese Zeile zu √§ndern:

```Python
    return {"item_name": item.name, "item_id": item_id}
```

... von:

```Python
        ... "item_name": item.name ...
```

... zu:

```Python
        ... "item_price": item.price ...
```

... und sehen Sie, wie Ihr Editor die Attribute automatisch ausf√ºllt und ihre Typen kennt:

![Editor Unterst√ºtzung](https://fastapi.tiangolo.com/img/vscode-completion.png)

F√ºr ein vollst√§ndigeres Beispiel, mit weiteren Funktionen, siehe das <a href="https://fastapi.tiangolo.com/tutorial/">Tutorial - Benutzerhandbuch</a>.

**Spoiler-Alarm**: Das Tutorial - Benutzerhandbuch enth√§lt:

* Deklaration von **Parametern** von anderen verschiedenen Stellen wie: **Header-Felder**, **Cookies**, **Formularfelder** und **Dateien**.
* Wie man **Validierungseinschr√§nkungen** wie `maximum_length` oder `regex` setzt.
* Ein sehr leistungsf√§higes und einfach zu bedienendes System f√ºr **<abbr title="Dependency Injection ‚Äì Einbringen von Abh√§ngigkeiten: Auch bekannt als Komponenten, Ressourcen, Provider, Services, Injectables">Dependency Injection</abbr>**.
* Sicherheit und Authentifizierung, einschlie√ülich Unterst√ºtzung f√ºr **OAuth2** mit **JWT-Tokens** und **HTTP-Basic**-Authentifizierung.
* Fortgeschrittenere (aber ebenso einfache) Techniken zur Deklaration **tief verschachtelter JSON-Modelle** (dank Pydantic).
* **GraphQL** Integration mit <a href="https://strawberry.rocks" class="external-link" target="_blank">Strawberry</a> und anderen Bibliotheken.
* Viele zus√§tzliche Funktionen (dank Starlette) wie:
    * **WebSockets**
    * extrem einfache Tests auf Basis von `httpx` und `pytest`
    * **CORS**
    * **Cookie Sessions**
    * ... und mehr.

## Performanz

Unabh√§ngige TechEmpower-Benchmarks zeigen **FastAPI**-Anwendungen, die unter Uvicorn laufen, als <a href="https://www.techempower.com/benchmarks/#section=test&runid=7464e520-0dc2-473d-bd34-dbdfd7e85911&hw=ph&test=query&l=zijzen-7" class="external-link" target="_blank">eines der schnellsten verf√ºgbaren Python-Frameworks</a>, nur noch hinter Starlette und Uvicorn selbst (intern von FastAPI verwendet).

Um mehr dar√ºber zu erfahren, siehe den Abschnitt <a href="https://fastapi.tiangolo.com/benchmarks/" class="internal-link" target="_blank">Benchmarks</a>.

## Optionale Abh√§ngigkeiten

Wird von Pydantic verwendet:

* <a href="https://github.com/JoshData/python-email-validator" target="_blank"><code>email-validator</code></a> - f√ºr E-Mail-Validierung.
* <a href="https://docs.pydantic.dev/latest/usage/pydantic_settings/" target="_blank"><code>pydantic-settings</code></a> - f√ºr die Verwaltung von Einstellungen.
* <a href="https://docs.pydantic.dev/latest/usage/types/extra_types/extra_types/" target="_blank"><code>pydantic-extra-types</code></a> - f√ºr zus√§tzliche Typen, mit Pydantic zu verwenden.

Wird von Starlette verwendet:

* <a href="https://www.python-httpx.org" target="_blank"><code>httpx</code></a> - erforderlich, wenn Sie den `TestClient` verwenden m√∂chten.
* <a href="https://jinja.palletsprojects.com" target="_blank"><code>jinja2</code></a> - erforderlich, wenn Sie die Standardkonfiguration f√ºr Templates verwenden m√∂chten.
* <a href="https://github.com/Kludex/python-multipart" target="_blank"><code>python-multipart</code></a> - erforderlich, wenn Sie Formulare mittels `request.form()` <abbr title="Konvertieren des Strings, der aus einer HTTP-Anfrage stammt, nach Python-Daten">‚Äûparsen‚Äú</abbr> m√∂chten.
* <a href="https://pythonhosted.org/itsdangerous/" target="_blank"><code>itsdangerous</code></a> - erforderlich f√ºr `SessionMiddleware` Unterst√ºtzung.
* <a href="https://pyyaml.org/wiki/PyYAMLDocumentation" target="_blank"><code>pyyaml</code></a> - erforderlich f√ºr Starlette's `SchemaGenerator` Unterst√ºtzung (Sie brauchen das wahrscheinlich nicht mit FastAPI).
* <a href="https://github.com/esnme/ultrajson" target="_blank"><code>ujson</code></a> - erforderlich, wenn Sie `UJSONResponse` verwenden m√∂chten.

Wird von FastAPI / Starlette verwendet:

* <a href="https://www.uvicorn.org" target="_blank"><code>uvicorn</code></a> - f√ºr den Server, der Ihre Anwendung l√§dt und serviert.
* <a href="https://github.com/ijl/orjson" target="_blank"><code>orjson</code></a> - erforderlich, wenn Sie `ORJSONResponse` verwenden m√∂chten.

Sie k√∂nnen diese alle mit `pip install "fastapi[all]"` installieren.

## Lizenz

Dieses Projekt ist unter den Bedingungen der MIT-Lizenz lizenziert.


================================================
File: /docs/de/docs/project-generation.md
================================================
# Projektgenerierung ‚Äì Vorlage

Sie k√∂nnen einen Projektgenerator f√ºr den Einstieg verwenden, welcher einen Gro√üteil der Ersteinrichtung, Sicherheit, Datenbank und einige API-Endpunkte bereits f√ºr Sie erstellt.

Ein Projektgenerator verf√ºgt immer √ºber ein sehr spezifisches Setup, das Sie aktualisieren und an Ihre eigenen Bed√ºrfnisse anpassen sollten, aber es k√∂nnte ein guter Ausgangspunkt f√ºr Ihr Projekt sein.

## Full Stack FastAPI PostgreSQL

GitHub: <a href="https://github.com/tiangolo/full-stack-fastapi-postgresql" class="external-link" target="_blank">https://github.com/tiangolo/full-stack-fastapi-postgresql</a>

### Full Stack FastAPI PostgreSQL ‚Äì Funktionen

* Vollst√§ndige **Docker**-Integration (Docker-basiert).
* Docker-Schwarmmodus-Deployment.
* **Docker Compose**-Integration und Optimierung f√ºr die lokale Entwicklung.
* **Produktionsbereit** Python-Webserver, verwendet Uvicorn und Gunicorn.
* Python <a href="https://github.com/fastapi/fastapi" class="external-link" target="_blank">**FastAPI**</a>-Backend:
    * **Schnell**: Sehr hohe Leistung, auf Augenh√∂he mit **NodeJS** und **Go** (dank Starlette und Pydantic).
    * **Intuitiv**: Hervorragende Editor-Unterst√ºtzung. <abbr title="Auch bekannt als automatische Vervollst√§ndigung, IntelliSense">Codevervollst√§ndigung</abbr> √ºberall. Weniger Zeitaufwand f√ºr das Debuggen.
    * **Einfach**: Einfach zu bedienen und zu erlernen. Weniger Zeit f√ºr das Lesen von Dokumentationen.
    * **Kurz**: Codeverdoppelung minimieren. Mehrere Funktionalit√§ten aus jeder Parameterdeklaration.
    * **Robust**: Erhalten Sie produktionsbereiten Code. Mit automatischer, interaktiver Dokumentation.
    * **Standards-basiert**: Basierend auf (und vollst√§ndig kompatibel mit) den offenen Standards f√ºr APIs: <a href="https://github.com/OAI/OpenAPI-Specification" class="external-link" target="_blank">OpenAPI</a> und <a href="https://json-schema.org/" class="external-link" target="_blank">JSON Schema</a>.
    * <a href="https://fastapi.tiangolo.com/features/" class="external-link" target="_blank">**Viele weitere Funktionen**</a>, einschlie√ülich automatischer Validierung, Serialisierung, interaktiver Dokumentation, Authentifizierung mit OAuth2-JWT-Tokens, usw.
* **Sicheres Passwort**-Hashing standardm√§√üig.
* **JWT-Token**-Authentifizierung.
* **SQLAlchemy**-Modelle (unabh√§ngig von Flask-Erweiterungen, sodass sie direkt mit Celery-Workern verwendet werden k√∂nnen).
* Grundlegende Startmodelle f√ºr Benutzer (√§ndern und entfernen Sie nach Bedarf).
* **Alembic**-Migrationen.
* **CORS** (Cross Origin Resource Sharing).
* **Celery**-Worker, welche Modelle und Code aus dem Rest des Backends selektiv importieren und verwenden k√∂nnen.
* REST-Backend-Tests basierend auf **Pytest**, integriert in Docker, sodass Sie die vollst√§ndige API-Interaktion unabh√§ngig von der Datenbank testen k√∂nnen. Da es in Docker ausgef√ºhrt wird, kann jedes Mal ein neuer Datenspeicher von Grund auf erstellt werden (Sie k√∂nnen also ElasticSearch, MongoDB, CouchDB oder was auch immer Sie m√∂chten verwenden und einfach testen, ob die API funktioniert).
* Einfache Python-Integration mit **Jupyter-Kerneln** f√ºr Remote- oder In-Docker-Entwicklung mit Erweiterungen wie Atom Hydrogen oder Visual Studio Code Jupyter.
* **Vue**-Frontend:
    * Mit Vue CLI generiert.
    * Handhabung der **JWT-Authentifizierung**.
    * Login-View.
    * Nach der Anmeldung Hauptansicht des Dashboards.
    * Haupt-Dashboard mit Benutzererstellung und -bearbeitung.
    * Bearbeitung des eigenen Benutzers.
    * **Vuex**.
    * **Vue-Router**.
    * **Vuetify** f√ºr sch√∂ne Material-Designkomponenten.
    * **TypeScript**.
    * Docker-Server basierend auf **Nginx** (konfiguriert, um gut mit Vue-Router zu funktionieren).
    * Mehrstufigen Docker-Erstellung, sodass Sie kompilierten Code nicht speichern oder committen m√ºssen.
    * Frontend-Tests, welche zur Erstellungszeit ausgef√ºhrt werden (k√∂nnen auch deaktiviert werden).
    * So modular wie m√∂glich gestaltet, sodass es sofort einsatzbereit ist. Sie k√∂nnen es aber mit Vue CLI neu generieren oder es so wie Sie m√∂chten erstellen und wiederverwenden, was Sie m√∂chten.
* **PGAdmin** f√ºr die PostgreSQL-Datenbank, k√∂nnen Sie problemlos √§ndern, sodass PHPMyAdmin und MySQL verwendet wird.
* **Flower** f√ºr die √úberwachung von Celery-Jobs.
* Load Balancing zwischen Frontend und Backend mit **Traefik**, sodass Sie beide unter derselben Domain haben k√∂nnen, getrennt durch den Pfad, aber von unterschiedlichen Containern ausgeliefert.
* Traefik-Integration, einschlie√ülich automatischer Generierung von Let's Encrypt-**HTTPS**-Zertifikaten.
* GitLab **CI** (kontinuierliche Integration), einschlie√ülich Frontend- und Backend-Testen.

## Full Stack FastAPI Couchbase

GitHub: <a href="https://github.com/tiangolo/full-stack-fastapi-couchbase" class="external-link" target="_blank">https://github.com/tiangolo/full-stack-fastapi-couchbase</a>

‚ö†Ô∏è **WARNUNG** ‚ö†Ô∏è

Wenn Sie ein neues Projekt von Grund auf starten, pr√ºfen Sie die Alternativen hier.

Zum Beispiel k√∂nnte der Projektgenerator <a href="https://github.com/tiangolo/full-stack-fastapi-postgresql" class="external-link" target="_blank">Full Stack FastAPI PostgreSQL</a> eine bessere Alternative sein, da er aktiv gepflegt und genutzt wird. Und er enth√§lt alle neuen Funktionen und Verbesserungen.

Es steht Ihnen weiterhin frei, den Couchbase-basierten Generator zu verwenden, wenn Sie m√∂chten. Er sollte wahrscheinlich immer noch gut funktionieren, und wenn Sie bereits ein Projekt damit erstellt haben, ist das auch in Ordnung (und Sie haben es wahrscheinlich bereits an Ihre Bed√ºrfnisse angepasst).

Weitere Informationen hierzu finden Sie in der Dokumentation des Repos.

## Full Stack FastAPI MongoDB

... k√∂nnte sp√§ter kommen, abh√§ngig von meiner verf√ºgbaren Zeit und anderen Faktoren. üòÖ üéâ

## Modelle f√ºr maschinelles Lernen mit spaCy und FastAPI

GitHub: <a href="https://github.com/microsoft/cookiecutter-spacy-fastapi" class="external-link" target="_blank">https://github.com/microsoft/cookiecutter-spacy-fastapi</a>

### Modelle f√ºr maschinelles Lernen mit spaCy und FastAPI ‚Äì Funktionen

* **spaCy** NER-Modellintegration.
* **Azure Cognitive Search**-Anforderungsformat integriert.
* **Produktionsbereit** Python-Webserver, verwendet Uvicorn und Gunicorn.
* **Azure DevOps** Kubernetes (AKS) CI/CD-Deployment integriert.
* **Mehrsprachig** W√§hlen Sie bei der Projekteinrichtung ganz einfach eine der integrierten Sprachen von spaCy aus.
* **Einfach erweiterbar** auf andere Modellframeworks (Pytorch, Tensorflow), nicht nur auf SpaCy.


================================================
File: /docs/de/docs/python-types.md
================================================
# Einf√ºhrung in Python-Typen

Python hat Unterst√ºtzung f√ºr optionale ‚ÄûTyphinweise‚Äú (Englisch: ‚ÄûType Hints‚Äú). Auch ‚ÄûTyp Annotationen‚Äú genannt.

Diese **‚ÄûTyphinweise‚Äú** oder -Annotationen sind eine spezielle Syntax, die es erlaubt, den <abbr title="Zum Beispiel: str, int, float, bool">Typ</abbr> einer Variablen zu deklarieren.

Durch das Deklarieren von Typen f√ºr Ihre Variablen k√∂nnen Editoren und Tools bessere Unterst√ºtzung bieten.

Dies ist lediglich eine **schnelle Anleitung / Auffrischung** √ºber Pythons Typhinweise. Sie deckt nur das Minimum ab, das n√∂tig ist, um diese mit **FastAPI** zu verwenden ... was tats√§chlich sehr wenig ist.

**FastAPI** basiert vollst√§ndig auf diesen Typhinweisen, sie geben der Anwendung viele Vorteile und M√∂glichkeiten.

Aber selbst wenn Sie **FastAPI** nie verwenden, wird es f√ºr Sie n√ºtzlich sein, ein wenig dar√ºber zu lernen.

/// note | Hinweis

Wenn Sie ein Python-Experte sind und bereits alles √ºber Typhinweise wissen, √ºberspringen Sie dieses Kapitel und fahren Sie mit dem n√§chsten fort.

///

## Motivation

Fangen wir mit einem einfachen Beispiel an:

{* ../../docs_src/python_types/tutorial001.py *}

Dieses Programm gibt aus:

```
John Doe
```

Die Funktion macht Folgendes:

* Nimmt einen `first_name` und `last_name`.
* Schreibt den ersten Buchstaben eines jeden Wortes gro√ü, mithilfe von `title()`.
* <abbr title="F√ºge zu einer Einheit zusammen, eins nach dem anderen.">Verkettet</abbr> sie mit einem Leerzeichen in der Mitte.

{* ../../docs_src/python_types/tutorial001.py hl[2] *}

### Bearbeiten Sie es

Es ist ein sehr einfaches Programm.

Aber nun stellen Sie sich vor, Sie w√ºrden es selbst schreiben.

Irgendwann sind die Funktions-Parameter fertig, Sie starten mit der Definition des K√∂rpers ...

Aber dann m√ºssen Sie ‚Äûdiese Methode aufrufen, die den ersten Buchstaben in Gro√übuchstaben umwandelt‚Äú.

War es `upper`? War es `uppercase`? `first_uppercase`? `capitalize`?

Dann versuchen Sie es mit dem langj√§hrigen Freund des Programmierers, der Editor-Autovervollst√§ndigung.

Sie geben den ersten Parameter der Funktion ein, `first_name`, dann einen Punkt (`.`) und dr√ºcken `Strg+Leertaste`, um die Vervollst√§ndigung auszul√∂sen.

Aber leider erhalten Sie nichts N√ºtzliches:

<img src="/img/python-types/image01.png">

### Typen hinzuf√ºgen

Lassen Sie uns eine einzelne Zeile aus der vorherigen Version √§ndern.

Wir √§ndern den folgenden Teil, die Parameter der Funktion, von:

```Python
    first_name, last_name
```

zu:

```Python
    first_name: str, last_name: str
```

Das war's.

Das sind die ‚ÄûTyphinweise‚Äú:

{* ../../docs_src/python_types/tutorial002.py hl[1] *}

Das ist nicht das gleiche wie das Deklarieren von Defaultwerten, wie es hier der Fall ist:

```Python
    first_name="john", last_name="doe"
```

Das ist eine andere Sache.

Wir verwenden Doppelpunkte (`:`), nicht Gleichheitszeichen (`=`).

Und das Hinzuf√ºgen von Typhinweisen √§ndert normalerweise nichts an dem, was ohne sie passieren w√ºrde.

Aber jetzt stellen Sie sich vor, Sie sind wieder mitten in der Erstellung dieser Funktion, aber mit Typhinweisen.

An derselben Stelle versuchen Sie, die Autovervollst√§ndigung mit ‚ÄûStrg+Leertaste‚Äú auszul√∂sen, und Sie sehen:

<img src="/img/python-types/image02.png">

Hier k√∂nnen Sie durch die Optionen bl√§ttern, bis Sie diejenige finden, bei der es ‚ÄûKlick‚Äú macht:

<img src="/img/python-types/image03.png">

## Mehr Motivation

Sehen Sie sich diese Funktion an, sie hat bereits Typhinweise:

{* ../../docs_src/python_types/tutorial003.py hl[1] *}

Da der Editor die Typen der Variablen kennt, erhalten Sie nicht nur Code-Vervollst√§ndigung, sondern auch eine Fehlerpr√ºfung:

<img src="/img/python-types/image04.png">

Jetzt, da Sie wissen, dass Sie das reparieren m√ºssen, konvertieren Sie `age` mittels `str(age)` in einen String:

{* ../../docs_src/python_types/tutorial004.py hl[2] *}

## Deklarieren von Typen

Sie haben gerade den Haupt-Einsatzort f√ºr die Deklaration von Typhinweisen gesehen. Als Funktionsparameter.

Das ist auch meistens, wie sie in **FastAPI** verwendet werden.

### Einfache Typen

Sie k√∂nnen alle Standard-Python-Typen deklarieren, nicht nur `str`.

Zum Beispiel diese:

* `int`
* `float`
* `bool`
* `bytes`

{* ../../docs_src/python_types/tutorial005.py hl[1] *}

### Generische Typen mit Typ-Parametern

Es gibt Datenstrukturen, die andere Werte enthalten k√∂nnen, wie etwa `dict`, `list`, `set` und `tuple`. Die inneren Werte k√∂nnen auch ihren eigenen Typ haben.

Diese Typen mit inneren Typen werden ‚Äû**generische**‚Äú Typen genannt. Es ist m√∂glich, sie mit ihren inneren Typen zu deklarieren.

Um diese Typen und die inneren Typen zu deklarieren, k√∂nnen Sie Pythons Standardmodul `typing` verwenden. Es existiert speziell f√ºr die Unterst√ºtzung dieser Typhinweise.

#### Neuere Python-Versionen

Die Syntax, welche `typing` verwendet, ist **kompatibel** mit allen Versionen, von Python 3.6 aufw√§rts zu den neuesten, inklusive Python 3.9, Python 3.10, usw.

Mit der Weiterentwicklung von Python kommen **neuere Versionen** heraus, mit verbesserter Unterst√ºtzung f√ºr Typannotationen, und in vielen F√§llen m√ºssen Sie gar nicht mehr das `typing`-Modul importieren, um Typannotationen zu schreiben.

Wenn Sie eine neuere Python-Version f√ºr Ihr Projekt w√§hlen k√∂nnen, werden Sie aus dieser zus√§tzlichen Vereinfachung Nutzen ziehen k√∂nnen.

In der gesamten Dokumentation gibt es Beispiele, welche kompatibel mit unterschiedlichen Python-Versionen sind (wenn es Unterschiede gibt).

Zum Beispiel bedeutet ‚Äû**Python 3.6+**‚Äú, dass das Beispiel kompatibel mit Python 3.6 oder h√∂her ist (inklusive 3.7, 3.8, 3.9, 3.10, usw.). Und ‚Äû**Python 3.9+**‚Äú bedeutet, es ist kompatibel mit Python 3.9 oder h√∂her (inklusive 3.10, usw.).

Wenn Sie √ºber die **neueste Version von Python** verf√ºgen, verwenden Sie die Beispiele f√ºr die neueste Version, diese werden die **beste und einfachste Syntax** haben, zum Beispiel, ‚Äû**Python 3.10+**‚Äú.

#### Liste

Definieren wir zum Beispiel eine Variable, die eine `list` von `str` ‚Äì eine Liste von Strings ‚Äì sein soll.

//// tab | Python 3.9+

Deklarieren Sie die Variable mit der gleichen Doppelpunkt-Syntax (`:`).

Als Typ nehmen Sie `list`.

Da die Liste ein Typ ist, welcher innere Typen enth√§lt, werden diese von eckigen Klammern umfasst:

```Python hl_lines="1"
{!> ../../docs_src/python_types/tutorial006_py39.py!}
```

////

//// tab | Python 3.8+

Von `typing` importieren Sie `List` (mit Gro√übuchstaben `L`):

```Python hl_lines="1"
{!> ../../docs_src/python_types/tutorial006.py!}
```

Deklarieren Sie die Variable mit der gleichen Doppelpunkt-Syntax (`:`).

Als Typ nehmen Sie das `List`, das Sie von `typing` importiert haben.

Da die Liste ein Typ ist, welcher innere Typen enth√§lt, werden diese von eckigen Klammern umfasst:

```Python hl_lines="4"
{!> ../../docs_src/python_types/tutorial006.py!}
```

////

/// tip | Tipp

Die inneren Typen in den eckigen Klammern werden als ‚ÄûTyp-Parameter‚Äú bezeichnet.

In diesem Fall ist `str` der Typ-Parameter, der an `List` √ºbergeben wird (oder `list` in Python 3.9 und dar√ºber).

///

Das bedeutet: Die Variable `items` ist eine Liste ‚Äì `list` ‚Äì und jedes der Elemente in dieser Liste ist ein String ‚Äì `str`.

/// tip | Tipp

Wenn Sie Python 3.9 oder h√∂her verwenden, m√ºssen Sie `List` nicht von `typing` importieren, Sie k√∂nnen stattdessen den regul√§ren `list`-Typ verwenden.

///

Auf diese Weise kann Ihr Editor Sie auch bei der Bearbeitung von Eintr√§gen aus der Liste unterst√ºtzen:

<img src="/img/python-types/image05.png">

Ohne Typen ist das fast unm√∂glich zu erreichen.

Beachten Sie, dass die Variable `item` eines der Elemente in der Liste `items` ist.

Und trotzdem wei√ü der Editor, dass es sich um ein `str` handelt, und bietet entsprechende Unterst√ºtzung.

#### Tupel und Menge

Das Gleiche gilt f√ºr die Deklaration eines Tupels ‚Äì `tuple` ‚Äì und einer Menge ‚Äì `set`:

//// tab | Python 3.9+

```Python hl_lines="1"
{!> ../../docs_src/python_types/tutorial007_py39.py!}
```

////

//// tab | Python 3.8+

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial007.py!}
```

////

Das bedeutet:

* Die Variable `items_t` ist ein `tuple` mit 3 Elementen, einem `int`, einem weiteren `int` und einem `str`.
* Die Variable `items_s` ist ein `set`, und jedes seiner Elemente ist vom Typ `bytes`.

#### Dict

Um ein `dict` zu definieren, √ºbergeben Sie zwei Typ-Parameter, getrennt durch Kommas.

Der erste Typ-Parameter ist f√ºr die Schl√ºssel des `dict`.

Der zweite Typ-Parameter ist f√ºr die Werte des `dict`:

//// tab | Python 3.9+

```Python hl_lines="1"
{!> ../../docs_src/python_types/tutorial008_py39.py!}
```

////

//// tab | Python 3.8+

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial008.py!}
```

////

Das bedeutet:

* Die Variable `prices` ist ein `dict`:
    * Die Schl√ºssel dieses `dict` sind vom Typ `str` (z. B. die Namen der einzelnen Artikel).
    * Die Werte dieses `dict` sind vom Typ `float` (z. B. der Preis jedes Artikels).

#### <abbr title="Union ‚Äì Verbund, Einheit‚Äö Vereinigung: Eines von Mehreren">Union</abbr>

Sie k√∂nnen deklarieren, dass eine Variable einer von **verschiedenen Typen** sein kann, zum Beispiel ein `int` oder ein `str`.

In Python 3.6 und h√∂her (inklusive Python 3.10) k√∂nnen Sie den `Union`-Typ von `typing` verwenden und die m√∂glichen Typen innerhalb der eckigen Klammern auflisten.

In Python 3.10 gibt es zus√§tzlich eine **neue Syntax**, die es erlaubt, die m√∂glichen Typen getrennt von einem <abbr title='Allgemein: ‚Äûoder‚Äú. In anderem Zusammenhang auch ‚ÄûBitweises ODER‚Äú, aber letztere Bedeutung ist hier nicht relevant'>vertikalen Balken (`|`)</abbr> aufzulisten.

//// tab | Python 3.10+

```Python hl_lines="1"
{!> ../../docs_src/python_types/tutorial008b_py310.py!}
```

////

//// tab | Python 3.8+

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial008b.py!}
```

////

In beiden F√§llen bedeutet das, dass `item` ein `int` oder ein `str` sein kann.

#### Vielleicht `None`

Sie k√∂nnen deklarieren, dass ein Wert ein `str`, aber vielleicht auch `None` sein kann.

In Python 3.6 und dar√ºber (inklusive Python 3.10) k√∂nnen Sie das deklarieren, indem Sie `Optional` vom `typing` Modul importieren und verwenden.

{* ../../docs_src/python_types/tutorial009.py hl[1,4] *}

Wenn Sie `Optional[str]` anstelle von nur `str` verwenden, wird Ihr Editor Ihnen dabei helfen, Fehler zu erkennen, bei denen Sie annehmen k√∂nnten, dass ein Wert immer eine String (`str`) ist, obwohl er auch `None` sein k√∂nnte.

`Optional[Something]` ist tats√§chlich eine Abk√ºrzung f√ºr `Union[Something, None]`, diese beiden sind √§quivalent.

Das bedeutet auch, dass Sie in Python 3.10 `Something | None` verwenden k√∂nnen:

//// tab | Python 3.10+

```Python hl_lines="1"
{!> ../../docs_src/python_types/tutorial009_py310.py!}
```

////

//// tab | Python 3.8+

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial009.py!}
```

////

//// tab | Python 3.8+ Alternative

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial009b.py!}
```

////

#### `Union` oder `Optional` verwenden?

Wenn Sie eine Python-Version unterhalb 3.10 verwenden, hier ist mein sehr **subjektiver** Standpunkt dazu:

* üö® Vermeiden Sie `Optional[SomeType]`
* Stattdessen ‚ú® **verwenden Sie `Union[SomeType, None]`** ‚ú®.

Beide sind √§quivalent und im Hintergrund dasselbe, aber ich empfehle `Union` statt `Optional`, weil das Wort ‚Äû**optional**‚Äú impliziert, dass dieser Wert, zum Beispiel als Funktionsparameter, optional ist. Tats√§chlich bedeutet es aber nur ‚ÄûDer Wert kann `None` sein‚Äú, selbst wenn der Wert nicht optional ist und ben√∂tigt wird.

Ich denke, `Union[SomeType, None]` ist expliziter bez√ºglich seiner Bedeutung.

Es geht nur um W√∂rter und Namen. Aber diese Worte k√∂nnen beeinflussen, wie Sie und Ihre Teamkollegen √ºber den Code denken.

Nehmen wir zum Beispiel diese Funktion:

{* ../../docs_src/python_types/tutorial009c.py hl[1,4] *}

Der Parameter `name` ist definiert als `Optional[str]`, aber er ist **nicht optional**, Sie k√∂nnen die Funktion nicht ohne diesen Parameter aufrufen:

```Python
say_hi()  # Oh, nein, das l√∂st einen Fehler aus! üò±
```

Der `name` Parameter wird **immer noch ben√∂tigt** (nicht *optional*), weil er keinen Default-Wert hat. `name` akzeptiert aber dennoch `None` als Wert:

```Python
say_hi(name=None)  # Das funktioniert, None is g√ºltig üéâ
```

Die gute Nachricht ist, dass Sie sich dar√ºber keine Sorgen mehr machen m√ºssen, wenn Sie Python 3.10 verwenden, da Sie einfach `|` verwenden k√∂nnen, um Vereinigungen von Typen zu definieren:

{* ../../docs_src/python_types/tutorial009c_py310.py hl[1,4] *}

Und dann m√ºssen Sie sich nicht mehr um Namen wie `Optional` und `Union` k√ºmmern. üòé

#### Generische Typen

Diese Typen, die Typ-Parameter in eckigen Klammern akzeptieren, werden **generische Typen** oder **Generics** genannt.

//// tab | Python 3.10+

Sie k√∂nnen die eingebauten Typen als Generics verwenden (mit eckigen Klammern und Typen darin):

* `list`
* `tuple`
* `set`
* `dict`

Verwenden Sie f√ºr den Rest, wie unter Python 3.8, das `typing`-Modul:

* `Union`
* `Optional` (so wie unter Python 3.8)
* ... und andere.

In Python 3.10 k√∂nnen Sie als Alternative zu den Generics `Union` und `Optional` den <abbr title='Allgemein: ‚Äûoder‚Äú. In anderem Zusammenhang auch ‚ÄûBitweises ODER‚Äú, aber letztere Bedeutung ist hier nicht relevant'>vertikalen Balken (`|`)</abbr> verwenden, um Vereinigungen von Typen zu deklarieren, das ist besser und einfacher.

////

//// tab | Python 3.9+

Sie k√∂nnen die eingebauten Typen als Generics verwenden (mit eckigen Klammern und Typen darin):

* `list`
* `tuple`
* `set`
* `dict`

Verwenden Sie f√ºr den Rest, wie unter Python 3.8, das `typing`-Modul:

* `Union`
* `Optional`
* ... und andere.

////

//// tab | Python 3.8+

* `List`
* `Tuple`
* `Set`
* `Dict`
* `Union`
* `Optional`
* ... und andere.

////

### Klassen als Typen

Sie k√∂nnen auch eine Klasse als Typ einer Variablen deklarieren.

Nehmen wir an, Sie haben eine Klasse `Person`, mit einem Namen:

{* ../../docs_src/python_types/tutorial010.py hl[1:3] *}

Dann k√∂nnen Sie eine Variable vom Typ `Person` deklarieren:

{* ../../docs_src/python_types/tutorial010.py hl[6] *}

Und wiederum bekommen Sie die volle Editor-Unterst√ºtzung:

<img src="/img/python-types/image06.png">

Beachten Sie, das bedeutet: ‚Äû`one_person` ist eine **Instanz** der Klasse `Person`‚Äú.

Es bedeutet nicht: ‚Äû`one_person` ist die **Klasse** genannt `Person`‚Äú.

## Pydantic Modelle

<a href="https://pydantic-docs.helpmanual.io/" class="external-link" target="_blank">Pydantic</a> ist eine Python-Bibliothek f√ºr die Validierung von Daten.

Sie deklarieren die ‚ÄûForm‚Äú der Daten als Klassen mit Attributen.

Und jedes Attribut hat einen Typ.

Dann erzeugen Sie eine Instanz dieser Klasse mit einigen Werten, und Pydantic validiert die Werte, konvertiert sie in den passenden Typ (falls notwendig) und gibt Ihnen ein Objekt mit allen Daten.

Und Sie erhalten volle Editor-Unterst√ºtzung f√ºr dieses Objekt.

Ein Beispiel aus der offiziellen Pydantic Dokumentation:

//// tab | Python 3.10+

```Python
{!> ../../docs_src/python_types/tutorial011_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!> ../../docs_src/python_types/tutorial011_py39.py!}
```

////

//// tab | Python 3.8+

```Python
{!> ../../docs_src/python_types/tutorial011.py!}
```

////

/// info

Um mehr √ºber <a href="https://pydantic-docs.helpmanual.io/" class="external-link" target="_blank">Pydantic zu erfahren, schauen Sie sich dessen Dokumentation an</a>.

///

**FastAPI** basiert vollst√§ndig auf Pydantic.

Viel mehr von all dem werden Sie in praktischer Anwendung im [Tutorial - Benutzerhandbuch](tutorial/index.md){.internal-link target=_blank} sehen.

/// tip | Tipp

Pydantic verh√§lt sich speziell, wenn Sie `Optional` oder `Union[Etwas, None]` ohne einen Default-Wert verwenden. Sie k√∂nnen dar√ºber in der Pydantic Dokumentation unter <a href="https://docs.pydantic.dev/2.3/usage/models/#required-fields" class="external-link" target="_blank">Required fields</a> mehr erfahren.

///

## Typhinweise mit Metadaten-Annotationen

Python bietet auch die M√∂glichkeit, **zus√§tzliche Metadaten** in Typhinweisen unterzubringen, mittels `Annotated`.

//// tab | Python 3.9+

In Python 3.9 ist `Annotated` ein Teil der Standardbibliothek, Sie k√∂nnen es von `typing` importieren.

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial013_py39.py!}
```

////

//// tab | Python 3.8+

In Versionen niedriger als Python 3.9 importieren Sie `Annotated` von `typing_extensions`.

Es wird bereits mit **FastAPI** installiert sein.

```Python hl_lines="1  4"
{!> ../../docs_src/python_types/tutorial013.py!}
```

////

Python selbst macht nichts mit `Annotated`. F√ºr Editoren und andere Tools ist der Typ immer noch `str`.

Aber Sie k√∂nnen `Annotated` nutzen, um **FastAPI** mit Metadaten zu versorgen, die ihm sagen, wie sich ihre Anwendung verhalten soll.

Wichtig ist, dass **der erste *Typ-Parameter***, den Sie `Annotated` √ºbergeben, der **tats√§chliche Typ** ist. Der Rest sind Metadaten f√ºr andere Tools.

Im Moment m√ºssen Sie nur wissen, dass `Annotated` existiert, und dass es Standard-Python ist. üòé

Sp√§ter werden Sie sehen, wie **m√§chtig** es sein kann.

/// tip | Tipp

Der Umstand, dass es **Standard-Python** ist, bedeutet, dass Sie immer noch die **bestm√∂gliche Entwickler-Erfahrung** in ihrem Editor haben, sowie mit den Tools, die Sie nutzen, um ihren Code zu analysieren, zu refaktorisieren, usw. ‚ú®

Und ebenfalls, dass Ihr Code sehr kompatibel mit vielen anderen Python-Tools und -Bibliotheken sein wird. üöÄ

///

## Typhinweise in **FastAPI**

**FastAPI** macht sich diese Typhinweise zunutze, um mehrere Dinge zu tun.

Mit **FastAPI** deklarieren Sie Parameter mit Typhinweisen, und Sie erhalten:

* **Editorunterst√ºtzung**.
* **Typ-Pr√ºfungen**.

... und **FastAPI** verwendet dieselben Deklarationen, um:

* **Anforderungen** zu definieren: aus Anfrage-Pfadparametern, Abfrageparametern, Header-Feldern, Bodys, Abh√§ngigkeiten, usw.
* **Daten umzuwandeln**: aus der Anfrage in den erforderlichen Typ.
* **Daten zu validieren**: aus jeder Anfrage:
    * **Automatische Fehler** generieren, die an den Client zur√ºckgegeben werden, wenn die Daten ung√ºltig sind.
* Die API mit OpenAPI zu **dokumentieren**:
    * Die dann von den Benutzeroberfl√§chen der automatisch generierten interaktiven Dokumentation verwendet wird.

Das mag alles abstrakt klingen. Machen Sie sich keine Sorgen. Sie werden all das in Aktion sehen im [Tutorial - Benutzerhandbuch](tutorial/index.md){.internal-link target=_blank}.

Das Wichtigste ist, dass **FastAPI** durch die Verwendung von Standard-Python-Typen an einer einzigen Stelle (anstatt weitere Klassen, Dekoratoren usw. hinzuzuf√ºgen) einen Gro√üteil der Arbeit f√ºr Sie erledigt.

/// info

Wenn Sie bereits das ganze Tutorial durchgearbeitet haben und mehr √ºber Typen erfahren wollen, dann ist eine gute Ressource <a href="https://mypy.readthedocs.io/en/latest/cheat_sheet_py3.html" class="external-link" target="_blank">der ‚ÄûCheat Sheet‚Äú von `mypy`</a>.

///


================================================
File: /docs/de/docs/about/index.md
================================================
# √úber

√úber FastAPI, sein Design, seine Inspiration und mehr. ü§ì


================================================
File: /docs/de/docs/advanced/additional-responses.md
================================================
# Zus√§tzliche Responses in OpenAPI

/// warning | Achtung

Dies ist ein eher fortgeschrittenes Thema.

Wenn Sie mit **FastAPI** beginnen, ben√∂tigen Sie dies m√∂glicherweise nicht.

///

Sie k√∂nnen zus√§tzliche Responses mit zus√§tzlichen Statuscodes, Medientypen, Beschreibungen, usw. deklarieren.

Diese zus√§tzlichen Responses werden in das OpenAPI-Schema aufgenommen, sodass sie auch in der API-Dokumentation erscheinen.

F√ºr diese zus√§tzlichen Responses m√ºssen Sie jedoch sicherstellen, dass Sie eine `Response`, wie etwa `JSONResponse`, direkt zur√ºckgeben, mit Ihrem Statuscode und Inhalt.

## Zus√§tzliche Response mit `model`

Sie k√∂nnen Ihren *Pfadoperation-Dekoratoren* einen Parameter `responses` √ºbergeben.

Der nimmt ein `dict` entgegen, die Schl√ºssel sind Statuscodes f√ºr jede Response, wie etwa `200`, und die Werte sind andere `dict`s mit den Informationen f√ºr jede Response.

Jedes dieser Response-`dict`s kann einen Schl√ºssel `model` haben, welcher ein Pydantic-Modell enth√§lt, genau wie `response_model`.

**FastAPI** nimmt dieses Modell, generiert dessen JSON-Schema und f√ºgt es an der richtigen Stelle in OpenAPI ein.

Um beispielsweise eine weitere Response mit dem Statuscode `404` und einem Pydantic-Modell `Message` zu deklarieren, k√∂nnen Sie schreiben:

{* ../../docs_src/additional_responses/tutorial001.py hl[18,22] *}

/// note | Hinweis

Beachten Sie, dass Sie die `JSONResponse` direkt zur√ºckgeben m√ºssen.

///

/// info

Der `model`-Schl√ºssel ist nicht Teil von OpenAPI.

**FastAPI** nimmt das Pydantic-Modell von dort, generiert das JSON-Schema und f√ºgt es an der richtigen Stelle ein.

Die richtige Stelle ist:

* Im Schl√ºssel `content`, der als Wert ein weiteres JSON-Objekt (`dict`) hat, welches Folgendes enth√§lt:
    * Ein Schl√ºssel mit dem Medientyp, z. B. `application/json`, der als Wert ein weiteres JSON-Objekt hat, welches Folgendes enth√§lt:
        * Ein Schl√ºssel `schema`, der als Wert das JSON-Schema aus dem Modell hat, hier ist die richtige Stelle.
            * **FastAPI** f√ºgt hier eine Referenz auf die globalen JSON-Schemas an einer anderen Stelle in Ihrer OpenAPI hinzu, anstatt es direkt einzubinden. Auf diese Weise k√∂nnen andere Anwendungen und Clients diese JSON-Schemas direkt verwenden, bessere Tools zur Codegenerierung bereitstellen, usw.

///

Die generierten Responses in der OpenAPI f√ºr diese *Pfadoperation* lauten:

```JSON hl_lines="3-12"
{
    "responses": {
        "404": {
            "description": "Additional Response",
            "content": {
                "application/json": {
                    "schema": {
                        "$ref": "#/components/schemas/Message"
                    }
                }
            }
        },
        "200": {
            "description": "Successful Response",
            "content": {
                "application/json": {
                    "schema": {
                        "$ref": "#/components/schemas/Item"
                    }
                }
            }
        },
        "422": {
            "description": "Validation Error",
            "content": {
                "application/json": {
                    "schema": {
                        "$ref": "#/components/schemas/HTTPValidationError"
                    }
                }
            }
        }
    }
}
```

Die Schemas werden von einer anderen Stelle innerhalb des OpenAPI-Schemas referenziert:

```JSON hl_lines="4-16"
{
    "components": {
        "schemas": {
            "Message": {
                "title": "Message",
                "required": [
                    "message"
                ],
                "type": "object",
                "properties": {
                    "message": {
                        "title": "Message",
                        "type": "string"
                    }
                }
            },
            "Item": {
                "title": "Item",
                "required": [
                    "id",
                    "value"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "title": "Id",
                        "type": "string"
                    },
                    "value": {
                        "title": "Value",
                        "type": "string"
                    }
                }
            },
            "ValidationError": {
                "title": "ValidationError",
                "required": [
                    "loc",
                    "msg",
                    "type"
                ],
                "type": "object",
                "properties": {
                    "loc": {
                        "title": "Location",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "msg": {
                        "title": "Message",
                        "type": "string"
                    },
                    "type": {
                        "title": "Error Type",
                        "type": "string"
                    }
                }
            },
            "HTTPValidationError": {
                "title": "HTTPValidationError",
                "type": "object",
                "properties": {
                    "detail": {
                        "title": "Detail",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ValidationError"
                        }
                    }
                }
            }
        }
    }
}
```

## Zus√§tzliche Medientypen f√ºr die Haupt-Response

Sie k√∂nnen denselben `responses`-Parameter verwenden, um verschiedene Medientypen f√ºr dieselbe Haupt-Response hinzuzuf√ºgen.

Sie k√∂nnen beispielsweise einen zus√§tzlichen Medientyp `image/png` hinzuf√ºgen und damit deklarieren, dass Ihre *Pfadoperation* ein JSON-Objekt (mit dem Medientyp `application/json`) oder ein PNG-Bild zur√ºckgeben kann:

{* ../../docs_src/additional_responses/tutorial002.py hl[19:24,28] *}

/// note | Hinweis

Beachten Sie, dass Sie das Bild direkt mit einer `FileResponse` zur√ºckgeben m√ºssen.

///

/// info

Sofern Sie in Ihrem Parameter `responses` nicht explizit einen anderen Medientyp angeben, geht FastAPI davon aus, dass die Response denselben Medientyp wie die Haupt-Response-Klasse hat (Standardm√§√üig `application/json`).

Wenn Sie jedoch eine benutzerdefinierte Response-Klasse mit `None` als Medientyp angegeben haben, verwendet FastAPI `application/json` f√ºr jede zus√§tzliche Response, die √ºber ein zugeh√∂riges Modell verf√ºgt.

///

## Informationen kombinieren

Sie k√∂nnen auch Response-Informationen von mehreren Stellen kombinieren, einschlie√ülich der Parameter `response_model`, `status_code` und `responses`.

Sie k√∂nnen ein `response_model` deklarieren, indem Sie den Standardstatuscode `200` (oder bei Bedarf einen benutzerdefinierten) verwenden und dann zus√§tzliche Informationen f√ºr dieselbe Response in `responses` direkt im OpenAPI-Schema deklarieren.

**FastAPI** beh√§lt die zus√§tzlichen Informationen aus `responses` und kombiniert sie mit dem JSON-Schema aus Ihrem Modell.

Sie k√∂nnen beispielsweise eine Response mit dem Statuscode `404` deklarieren, die ein Pydantic-Modell verwendet und √ºber eine benutzerdefinierte Beschreibung (`description`) verf√ºgt.

Und eine Response mit dem Statuscode `200`, die Ihr `response_model` verwendet, aber ein benutzerdefiniertes Beispiel (`example`) enth√§lt:

{* ../../docs_src/additional_responses/tutorial003.py hl[20:31] *}

Es wird alles kombiniert und in Ihre OpenAPI eingebunden und in der API-Dokumentation angezeigt:

<img src="/img/tutorial/additional-responses/image01.png">

## Vordefinierte und benutzerdefinierte Responses kombinieren

M√∂glicherweise m√∂chten Sie einige vordefinierte Responses haben, die f√ºr viele *Pfadoperationen* gelten, Sie m√∂chten diese jedoch mit benutzerdefinierten Responses kombinieren, die f√ºr jede *Pfadoperation* erforderlich sind.

In diesen F√§llen k√∂nnen Sie die Python-Technik zum ‚ÄûEntpacken‚Äú eines `dict`s mit `**dict_to_unpack` verwenden:

```Python
old_dict = {
    "old key": "old value",
    "second old key": "second old value",
}
new_dict = {**old_dict, "new key": "new value"}
```

Hier wird `new_dict` alle Schl√ºssel-Wert-Paare von `old_dict` plus das neue Schl√ºssel-Wert-Paar enthalten:

```Python
{
    "old key": "old value",
    "second old key": "second old value",
    "new key": "new value",
}
```

Mit dieser Technik k√∂nnen Sie einige vordefinierte Responses in Ihren *Pfadoperationen* wiederverwenden und sie mit zus√§tzlichen benutzerdefinierten Responses kombinieren.

Zum Beispiel:

{* ../../docs_src/additional_responses/tutorial004.py hl[13:17,26] *}

## Weitere Informationen zu OpenAPI-Responses

Um zu sehen, was genau Sie in die Responses aufnehmen k√∂nnen, k√∂nnen Sie die folgenden Abschnitte in der OpenAPI-Spezifikation √ºberpr√ºfen:

* <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.1.0.md#responsesObject" class="external-link" target="_blank">OpenAPI Responses Object</a>, enth√§lt das `Response Object`.
* <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.1.0.md#responseObject" class="external-link" target="_blank">OpenAPI Response Object</a>, Sie k√∂nnen alles davon direkt in jede Response innerhalb Ihres `responses`-Parameter einf√ºgen. Einschlie√ülich `description`, `headers`, `content` (darin deklarieren Sie verschiedene Medientypen und JSON-Schemas) und `links`.


================================================
File: /docs/de/docs/advanced/additional-status-codes.md
================================================
# Zus√§tzliche Statuscodes

Standardm√§√üig liefert **FastAPI** die R√ºckgabewerte (Responses) als `JSONResponse` zur√ºck und f√ºgt den Inhalt der jeweiligen *Pfadoperation* in das `JSONResponse` Objekt ein.

Es wird der Default-Statuscode oder derjenige verwendet, den Sie in Ihrer *Pfadoperation* festgelegt haben.

## Zus√§tzliche Statuscodes

Wenn Sie neben dem Hauptstatuscode weitere Statuscodes zur√ºckgeben m√∂chten, k√∂nnen Sie dies tun, indem Sie direkt eine `Response` zur√ºckgeben, wie etwa eine `JSONResponse`, und den zus√§tzlichen Statuscode direkt festlegen.

Angenommen, Sie m√∂chten eine *Pfadoperation* haben, die das Aktualisieren von Artikeln erm√∂glicht und bei Erfolg den HTTP-Statuscode 200 ‚ÄûOK‚Äú zur√ºckgibt.

Sie m√∂chten aber auch, dass sie neue Artikel akzeptiert. Und wenn die Elemente vorher nicht vorhanden waren, werden diese Elemente erstellt und der HTTP-Statuscode 201 ‚ÄûCreated‚Äú zur√ºckgegeben.

Um dies zu erreichen, importieren Sie `JSONResponse`, und geben Sie Ihren Inhalt direkt zur√ºck, indem Sie den gew√ºnschten `status_code` setzen:

{* ../../docs_src/additional_status_codes/tutorial001_an_py310.py hl[4,25] *}

/// warning | Achtung

Wenn Sie eine `Response` direkt zur√ºckgeben, wie im obigen Beispiel, wird sie direkt zur√ºckgegeben.

Sie wird nicht mit einem Modell usw. serialisiert.

Stellen Sie sicher, dass sie die gew√ºnschten Daten enth√§lt und dass die Werte g√ºltiges JSON sind (wenn Sie `JSONResponse` verwenden).

///

/// note | Technische Details

Sie k√∂nnen auch `from starlette.responses import JSONResponse` verwenden.

**FastAPI** bietet dieselben `starlette.responses` auch via `fastapi.responses` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Die meisten verf√ºgbaren Responses kommen aber direkt von Starlette. Das Gleiche gilt f√ºr `status`.

///

## OpenAPI- und API-Dokumentation

Wenn Sie zus√§tzliche Statuscodes und Responses direkt zur√ºckgeben, werden diese nicht in das OpenAPI-Schema (die API-Dokumentation) aufgenommen, da FastAPI keine M√∂glichkeit hat, im Voraus zu wissen, was Sie zur√ºckgeben werden.

Sie k√∂nnen das jedoch in Ihrem Code dokumentieren, indem Sie Folgendes verwenden: [Zus√§tzliche Responses](additional-responses.md){.internal-link target=_blank}.


================================================
File: /docs/de/docs/advanced/advanced-dependencies.md
================================================
# Fortgeschrittene Abh√§ngigkeiten

## Parametrisierte Abh√§ngigkeiten

Alle Abh√§ngigkeiten, die wir bisher gesehen haben, waren festgelegte Funktionen oder Klassen.

Es kann jedoch F√§lle geben, in denen Sie Parameter f√ºr eine Abh√§ngigkeit festlegen m√∂chten, ohne viele verschiedene Funktionen oder Klassen zu deklarieren.

Stellen wir uns vor, wir m√∂chten eine Abh√§ngigkeit haben, die pr√ºft, ob ein Query-Parameter `q` einen vordefinierten Inhalt hat.

Aber wir wollen diesen vordefinierten Inhalt per Parameter festlegen k√∂nnen.

## Eine ‚Äûaufrufbare‚Äú Instanz

In Python gibt es eine M√∂glichkeit, eine Instanz einer Klasse ‚Äûaufrufbar‚Äú (‚Äûcallable‚Äú) zu machen.

Nicht die Klasse selbst (die bereits aufrufbar ist), sondern eine Instanz dieser Klasse.

Dazu deklarieren wir eine Methode `__call__`:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[12] *}

In diesem Fall ist dieses `__call__` das, was **FastAPI** verwendet, um nach zus√§tzlichen Parametern und Unterabh√§ngigkeiten zu suchen, und das ist es auch, was sp√§ter aufgerufen wird, um einen Wert an den Parameter in Ihrer *Pfadoperation-Funktion* zu √ºbergeben.

## Die Instanz parametrisieren

Und jetzt k√∂nnen wir `__init__` verwenden, um die Parameter der Instanz zu deklarieren, die wir zum `Parametrisieren` der Abh√§ngigkeit verwenden k√∂nnen:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[9] *}

In diesem Fall wird **FastAPI** `__init__` nie ber√ºhren oder sich darum k√ºmmern, wir werden es direkt in unserem Code verwenden.

## Eine Instanz erstellen

Wir k√∂nnten eine Instanz dieser Klasse erstellen mit:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[18] *}

Und auf diese Weise k√∂nnen wir unsere Abh√§ngigkeit ‚Äûparametrisieren‚Äú, die jetzt `"bar"` enth√§lt, als das Attribut `checker.fixed_content`.

## Die Instanz als Abh√§ngigkeit verwenden

Dann k√∂nnten wir diesen `checker` in einem `Depends(checker)` anstelle von `Depends(FixedContentQueryChecker)` verwenden, da die Abh√§ngigkeit die Instanz `checker` und nicht die Klasse selbst ist.

Und beim Aufl√∂sen der Abh√§ngigkeit ruft **FastAPI** diesen `checker` wie folgt auf:

```Python
checker(q="somequery")
```

... und √ºbergibt, was immer das als Wert dieser Abh√§ngigkeit in unserer *Pfadoperation-Funktion* zur√ºckgibt, als den Parameter `fixed_content_included`:

{* ../../docs_src/dependencies/tutorial011_an_py39.py hl[22] *}

/// tip | Tipp

Das alles mag gek√ºnstelt wirken. Und es ist m√∂glicherweise noch nicht ganz klar, welchen Nutzen das hat.

Diese Beispiele sind bewusst einfach gehalten, zeigen aber, wie alles funktioniert.

In den Kapiteln zum Thema Sicherheit gibt es Hilfsfunktionen, die auf die gleiche Weise implementiert werden.

Wenn Sie das hier alles verstanden haben, wissen Sie bereits, wie diese Sicherheits-Hilfswerkzeuge unter der Haube funktionieren.

///


================================================
File: /docs/de/docs/advanced/async-tests.md
================================================
# Asynchrone Tests

Sie haben bereits gesehen, wie Sie Ihre **FastAPI**-Anwendungen mit dem bereitgestellten `TestClient` testen. Bisher haben Sie nur gesehen, wie man synchrone Tests schreibt, ohne `async`hrone Funktionen zu verwenden.

Die M√∂glichkeit, in Ihren Tests asynchrone Funktionen zu verwenden, k√∂nnte beispielsweise n√ºtzlich sein, wenn Sie Ihre Datenbank asynchron abfragen. Stellen Sie sich vor, Sie m√∂chten das Senden von Requests an Ihre FastAPI-Anwendung testen und dann √ºberpr√ºfen, ob Ihr Backend die richtigen Daten erfolgreich in die Datenbank geschrieben hat, w√§hrend Sie eine asynchrone Datenbankbibliothek verwenden.

Schauen wir uns an, wie wir das machen k√∂nnen.

## pytest.mark.anyio

Wenn wir in unseren Tests asynchrone Funktionen aufrufen m√∂chten, m√ºssen unsere Testfunktionen asynchron sein. AnyIO stellt hierf√ºr ein nettes Plugin zur Verf√ºgung, mit dem wir festlegen k√∂nnen, dass einige Testfunktionen asynchron aufgerufen werden sollen.

## HTTPX

Auch wenn Ihre **FastAPI**-Anwendung normale `def`-Funktionen anstelle von `async def` verwendet, handelt es sich darunter immer noch um eine `async`hrone Anwendung.

Der `TestClient` macht unter der Haube magisches, um die asynchrone FastAPI-Anwendung in Ihren normalen `def`-Testfunktionen, mithilfe von Standard-Pytest aufzurufen. Aber diese Magie funktioniert nicht mehr, wenn wir sie in asynchronen Funktionen verwenden. Durch die asynchrone Ausf√ºhrung unserer Tests k√∂nnen wir den `TestClient` nicht mehr in unseren Testfunktionen verwenden.

Der `TestClient` basiert auf <a href="https://www.python-httpx.org" class="external-link" target="_blank">HTTPX</a> und gl√ºcklicherweise k√∂nnen wir ihn direkt verwenden, um die API zu testen.

## Beispiel

Betrachten wir als einfaches Beispiel eine Dateistruktur √§hnlich der in [Gr√∂√üere Anwendungen](../tutorial/bigger-applications.md){.internal-link target=_blank} und [Testen](../tutorial/testing.md){.internal-link target=_blank}:

```
.
‚îú‚îÄ‚îÄ app
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.py
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ test_main.py
```

Die Datei `main.py` h√§tte als Inhalt:

{* ../../docs_src/async_tests/main.py *}

Die Datei `test_main.py` h√§tte die Tests f√ºr `main.py`, das k√∂nnte jetzt so aussehen:

{* ../../docs_src/async_tests/test_main.py *}

## Es ausf√ºhren

Sie k√∂nnen Ihre Tests wie gewohnt ausf√ºhren mit:

<div class="termy">

```console
$ pytest

---> 100%
```

</div>

## Details

Der Marker `@pytest.mark.anyio` teilt pytest mit, dass diese Testfunktion asynchron aufgerufen werden soll:

{* ../../docs_src/async_tests/test_main.py hl[7] *}

/// tip | Tipp

Beachten Sie, dass die Testfunktion jetzt `async def` ist und nicht nur `def` wie zuvor, wenn Sie den `TestClient` verwenden.

///

Dann k√∂nnen wir einen `AsyncClient` mit der App erstellen und mit `await` asynchrone Requests an ihn senden.

{* ../../docs_src/async_tests/test_main.py hl[9:12] *}

Das ist das √Ñquivalent zu:

```Python
response = client.get('/')
```

... welches wir verwendet haben, um unsere Requests mit dem `TestClient` zu machen.

/// tip | Tipp

Beachten Sie, dass wir async/await mit dem neuen `AsyncClient` verwenden ‚Äì der Request ist asynchron.

///

/// warning | Achtung

Falls Ihre Anwendung auf Lifespan-Events angewiesen ist, der `AsyncClient` l√∂st diese Events nicht aus. Um sicherzustellen, dass sie ausgel√∂st werden, verwenden Sie `LifespanManager` von <a href="https://github.com/florimondmanca/asgi-lifespan#usage" class="external-link" target="_blank">florimondmanca/asgi-lifespan</a>.

///

## Andere asynchrone Funktionsaufrufe

Da die Testfunktion jetzt asynchron ist, k√∂nnen Sie in Ihren Tests neben dem Senden von Requests an Ihre FastAPI-Anwendung jetzt auch andere `async`hrone Funktionen aufrufen (und `await`en), genau so, wie Sie diese an anderer Stelle in Ihrem Code aufrufen w√ºrden.

/// tip | Tipp

Wenn Sie einen `RuntimeError: Task attached to a different loop` erhalten, wenn Sie asynchrone Funktionsaufrufe in Ihre Tests integrieren (z. B. bei Verwendung von <a href="https://stackoverflow.com/questions/41584243/runtimeerror-task-attached-to-a-different-loop" class="external-link" target="_blank">MongoDBs MotorClient</a>), dann denken Sie daran, Objekte zu instanziieren, die einen Event Loop nur innerhalb asynchroner Funktionen ben√∂tigen, z. B. einen `@app.on_event("startup")`-Callback.

///


================================================
File: /docs/de/docs/advanced/behind-a-proxy.md
================================================
# Hinter einem Proxy

In manchen Situationen m√ºssen Sie m√∂glicherweise einen **Proxy**-Server wie Traefik oder Nginx verwenden, mit einer Konfiguration, die ein zus√§tzliches Pfadpr√§fix hinzuf√ºgt, das von Ihrer Anwendung nicht gesehen wird.

In diesen F√§llen k√∂nnen Sie `root_path` verwenden, um Ihre Anwendung zu konfigurieren.

Der `root_path` (‚ÄûWurzelpfad‚Äú) ist ein Mechanismus, der von der ASGI-Spezifikation bereitgestellt wird (auf der FastAPI via Starlette aufbaut).

Der `root_path` wird verwendet, um diese speziellen F√§lle zu handhaben.

Und er wird auch intern beim Mounten von Unteranwendungen verwendet.

## Proxy mit einem abgetrennten Pfadpr√§fix

Ein Proxy mit einem abgetrennten Pfadpr√§fix bedeutet in diesem Fall, dass Sie einen Pfad unter `/app` in Ihrem Code deklarieren k√∂nnten, dann aber, eine Ebene dar√ºber, den Proxy hinzuf√ºgen, der Ihre **FastAPI**-Anwendung unter einem Pfad wie `/api/v1` platziert.

In diesem Fall w√ºrde der urspr√ºngliche Pfad `/app` tats√§chlich unter `/api/v1/app` bereitgestellt.

Auch wenn Ihr gesamter Code unter der Annahme geschrieben ist, dass es nur `/app` gibt.

{* ../../docs_src/behind_a_proxy/tutorial001.py hl[6] *}

Und der Proxy w√ºrde das **Pfadpr√§fix** on-the-fly **"entfernen**", bevor er die Anfrage an Uvicorn √ºbermittelt, daf√ºr sorgend, dass Ihre Anwendung davon √ºberzeugt ist, dass sie unter `/app` bereitgestellt wird, sodass Sie nicht Ihren gesamten Code dahingehend aktualisieren m√ºssen, das Pr√§fix `/api/v1` zu verwenden.

Bis hierher w√ºrde alles wie gewohnt funktionieren.

Wenn Sie dann jedoch die Benutzeroberfl√§che der integrierten Dokumentation (das Frontend) √∂ffnen, wird angenommen, dass sich das OpenAPI-Schema unter `/openapi.json` anstelle von `/api/v1/openapi.json` befindet.

Das Frontend (das im Browser l√§uft) w√ºrde also versuchen, `/openapi.json` zu erreichen und w√§re nicht in der Lage, das OpenAPI-Schema abzurufen.

Da wir f√ºr unsere Anwendung einen Proxy mit dem Pfadpr√§fix `/api/v1` haben, muss das Frontend das OpenAPI-Schema unter `/api/v1/openapi.json` abrufen.

```mermaid
graph LR

browser("Browser")
proxy["Proxy auf http://0.0.0.0:9999/api/v1/app"]
server["Server auf http://127.0.0.1:8000/app"]

browser --> proxy
proxy --> server
```

/// tip | Tipp

Die IP `0.0.0.0` wird √ºblicherweise verwendet, um anzudeuten, dass das Programm alle auf diesem Computer/Server verf√ºgbaren IPs abh√∂rt.

///

Die Benutzeroberfl√§che der Dokumentation w√ºrde ben√∂tigen, dass das OpenAPI-Schema deklariert, dass sich dieser API-`server` unter `/api/v1` (hinter dem Proxy) befindet. Zum Beispiel:

```JSON hl_lines="4-8"
{
    "openapi": "3.1.0",
    // Hier mehr Einstellungen
    "servers": [
        {
            "url": "/api/v1"
        }
    ],
    "paths": {
            // Hier mehr Einstellungen
    }
}
```

In diesem Beispiel k√∂nnte der ‚ÄûProxy‚Äú etwa **Traefik** sein. Und der Server w√§re so etwas wie **Uvicorn**, auf dem Ihre FastAPI-Anwendung ausgef√ºhrt wird.

### Bereitstellung des `root_path`

Um dies zu erreichen, k√∂nnen Sie die Kommandozeilenoption `--root-path` wie folgt verwenden:

<div class="termy">

```console
$ uvicorn main:app --root-path /api/v1

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

Falls Sie Hypercorn verwenden, das hat auch die Option `--root-path`.

/// note | Technische Details

Die ASGI-Spezifikation definiert einen `root_path` f√ºr diesen Anwendungsfall.

Und die Kommandozeilenoption `--root-path` stellt diesen `root_path` bereit.

///

### √úberpr√ºfen des aktuellen `root_path`

Sie k√∂nnen den aktuellen `root_path` abrufen, der von Ihrer Anwendung f√ºr jede Anfrage verwendet wird. Er ist Teil des `scope`-Dictionarys (das ist Teil der ASGI-Spezifikation).

Hier f√ºgen wir ihn, nur zu Demonstrationszwecken, in die Nachricht ein.

{* ../../docs_src/behind_a_proxy/tutorial001.py hl[8] *}

Wenn Sie Uvicorn dann starten mit:

<div class="termy">

```console
$ uvicorn main:app --root-path /api/v1

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

w√§re die Response etwa:

```JSON
{
    "message": "Hello World",
    "root_path": "/api/v1"
}
```

### Festlegen des `root_path` in der FastAPI-Anwendung

Falls Sie keine M√∂glichkeit haben, eine Kommandozeilenoption wie `--root-path` oder √§hnlich zu √ºbergeben, k√∂nnen Sie als Alternative beim Erstellen Ihrer FastAPI-Anwendung den Parameter `root_path` setzen:

{* ../../docs_src/behind_a_proxy/tutorial002.py hl[3] *}

Die √úbergabe des `root_path` an `FastAPI` w√§re das √Ñquivalent zur √úbergabe der `--root-path`-Kommandozeilenoption an Uvicorn oder Hypercorn.

### √úber `root_path`

Beachten Sie, dass der Server (Uvicorn) diesen `root_path` f√ºr nichts anderes au√üer die Weitergabe an die Anwendung verwendet.

Aber wenn Sie mit Ihrem Browser auf <a href="http://127.0.0.1:8000" class="external-link" target="_blank">http://127.0.0.1:8000/app</a> gehen, sehen Sie die normale Antwort:

```JSON
{
    "message": "Hello World",
    "root_path": "/api/v1"
}
```

Es wird also nicht erwartet, dass unter `http://127.0.0.1:8000/api/v1/app` darauf zugegriffen wird.

Uvicorn erwartet, dass der Proxy unter `http://127.0.0.1:8000/app` auf Uvicorn zugreift, und dann liegt es in der Verantwortung des Proxys, das zus√§tzliche `/api/v1`-Pr√§fix dar√ºber hinzuzuf√ºgen.

## √úber Proxys mit einem abgetrennten Pfadpr√§fix

Bedenken Sie, dass ein Proxy mit abgetrennten Pfadpr√§fix nur eine von vielen Konfigurationsm√∂glichkeiten ist.

Wahrscheinlich wird in vielen F√§llen die Standardeinstellung sein, dass der Proxy kein abgetrenntes Pfadpr√§fix hat.

In einem solchen Fall (ohne ein abgetrenntes Pfadpr√§fix) w√ºrde der Proxy auf etwas wie `https://myawesomeapp.com` lauschen, und wenn der Browser dann zu `https://myawesomeapp.com/api/v1/` wechselt, und Ihr Server (z. B. Uvicorn) auf `http://127.0.0.1:8000` lauscht, w√ºrde der Proxy (ohne ein abgetrenntes Pfadpr√§fix) √ºber denselben Pfad auf Uvicorn zugreifen: `http://127.0.0.1:8000/api/v1/app`.

## Lokal testen mit Traefik

Sie k√∂nnen das Experiment mit einem abgetrennten Pfadpr√§fix ganz einfach lokal ausf√ºhren, indem Sie <a href="https://docs.traefik.io/" class="external-link" target="_blank">Traefik</a> verwenden.

<a href="https://github.com/containous/traefik/releases" class="external-link" target="_blank">Laden Sie Traefik herunter</a>, es ist eine einzelne Bin√§rdatei, Sie k√∂nnen die komprimierte Datei extrahieren und sie direkt vom Terminal aus ausf√ºhren.

Dann erstellen Sie eine Datei `traefik.toml` mit:

```TOML hl_lines="3"
[entryPoints]
  [entryPoints.http]
    address = ":9999"

[providers]
  [providers.file]
    filename = "routes.toml"
```

Dadurch wird Traefik angewiesen, Port 9999 abzuh√∂ren und eine andere Datei `routes.toml` zu verwenden.

/// tip | Tipp

Wir verwenden Port 9999 anstelle des Standard-HTTP-Ports 80, damit Sie ihn nicht mit Administratorrechten (`sudo`) ausf√ºhren m√ºssen.

///

Erstellen Sie nun die andere Datei `routes.toml`:

```TOML hl_lines="5  12  20"
[http]
  [http.middlewares]

    [http.middlewares.api-stripprefix.stripPrefix]
      prefixes = ["/api/v1"]

  [http.routers]

    [http.routers.app-http]
      entryPoints = ["http"]
      service = "app"
      rule = "PathPrefix(`/api/v1`)"
      middlewares = ["api-stripprefix"]

  [http.services]

    [http.services.app]
      [http.services.app.loadBalancer]
        [[http.services.app.loadBalancer.servers]]
          url = "http://127.0.0.1:8000"
```

Diese Datei konfiguriert Traefik, das Pfadpr√§fix `/api/v1` zu verwenden.

Und dann leitet Traefik seine Anfragen an Ihren Uvicorn weiter, der unter `http://127.0.0.1:8000` l√§uft.

Starten Sie nun Traefik:

<div class="termy">

```console
$ ./traefik --configFile=traefik.toml

INFO[0000] Configuration loaded from file: /home/user/awesomeapi/traefik.toml
```

</div>

Und jetzt starten Sie Ihre Anwendung mit Uvicorn, indem Sie die Option `--root-path` verwenden:

<div class="termy">

```console
$ uvicorn main:app --root-path /api/v1

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

### Die Responses betrachten

Wenn Sie nun zur URL mit dem Port f√ºr Uvicorn gehen: <a href="http://127.0.0.1:8000/app" class="external-link" target="_blank">http://127.0.0.1:8000/app</a>, sehen Sie die normale Response:

```JSON
{
    "message": "Hello World",
    "root_path": "/api/v1"
}
```

/// tip | Tipp

Beachten Sie, dass, obwohl Sie unter `http://127.0.0.1:8000/app` darauf zugreifen, als `root_path` angezeigt wird `/api/v1`, welches aus der Option `--root-path` stammt.

///

√ñffnen Sie nun die URL mit dem Port f√ºr Traefik, einschlie√ülich des Pfadpr√§fixes: <a href="http://127.0.0.1:9999/api/v1/app" class="external-link" target="_blank">http://127.0.0.1:9999/api/v1/app</a>.

Wir bekommen die gleiche Response:

```JSON
{
    "message": "Hello World",
    "root_path": "/api/v1"
}
```

Diesmal jedoch unter der URL mit dem vom Proxy bereitgestellten Pr√§fixpfad: `/api/v1`.

Die Idee hier ist nat√ºrlich, dass jeder √ºber den Proxy auf die Anwendung zugreifen soll, daher ist die Version mit dem Pfadpr√§fix `/api/v1` die ‚Äûkorrekte‚Äú.

Und die von Uvicorn direkt bereitgestellte Version ohne Pfadpr√§fix (`http://127.0.0.1:8000/app`) w√§re ausschlie√ülich f√ºr den Zugriff durch den _Proxy_ (Traefik) bestimmt.

Dies demonstriert, wie der Proxy (Traefik) das Pfadpr√§fix verwendet und wie der Server (Uvicorn) den `root_path` aus der Option `--root-path` verwendet.

### Es in der Dokumentationsoberfl√§che betrachten

Jetzt folgt der spa√üige Teil. ‚ú®

Der ‚Äûoffizielle‚Äú Weg, auf die Anwendung zuzugreifen, w√§re √ºber den Proxy mit dem von uns definierten Pfadpr√§fix. Wenn Sie also die von Uvicorn direkt bereitgestellte Dokumentationsoberfl√§che ohne das Pfadpr√§fix in der URL ausprobieren, wird es erwartungsgem√§√ü nicht funktionieren, da erwartet wird, dass der Zugriff √ºber den Proxy erfolgt.

Sie k√∂nnen das unter <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> sehen:

<img src="/img/tutorial/behind-a-proxy/image01.png">

Wenn wir jedoch unter der ‚Äûoffiziellen‚Äú URL, √ºber den Proxy mit Port `9999`, unter `/api/v1/docs`, auf die Dokumentationsoberfl√§che zugreifen, funktioniert es ordnungsgem√§√ü! üéâ

Sie k√∂nnen das unter <a href="http://127.0.0.1:9999/api/v1/docs" class="external-link" target="_blank">http://127.0.0.1:9999/api/v1/docs</a> testen:

<img src="/img/tutorial/behind-a-proxy/image02.png">

Genau so, wie wir es wollten. ‚úîÔ∏è

Dies liegt daran, dass FastAPI diesen `root_path` verwendet, um den Default-`server` in OpenAPI mit der von `root_path` bereitgestellten URL zu erstellen.

## Zus√§tzliche Server

/// warning | Achtung

Dies ist ein fortgeschrittener Anwendungsfall. √úberspringen Sie das gerne.

///

Standardm√§√üig erstellt **FastAPI** einen `server` im OpenAPI-Schema mit der URL f√ºr den `root_path`.

Sie k√∂nnen aber auch andere alternative `server` bereitstellen, beispielsweise wenn Sie m√∂chten, dass *dieselbe* Dokumentationsoberfl√§che mit einer Staging- und Produktionsumgebung interagiert.

Wenn Sie eine benutzerdefinierte Liste von Servern (`servers`) √ºbergeben und es einen `root_path` gibt (da Ihre API hinter einem Proxy l√§uft), f√ºgt **FastAPI** einen ‚ÄûServer‚Äú mit diesem `root_path` am Anfang der Liste ein.

Zum Beispiel:

{* ../../docs_src/behind_a_proxy/tutorial003.py hl[4:7] *}

Erzeugt ein OpenAPI-Schema, wie:

```JSON hl_lines="5-7"
{
    "openapi": "3.1.0",
    // Hier mehr Einstellungen
    "servers": [
        {
            "url": "/api/v1"
        },
        {
            "url": "https://stag.example.com",
            "description": "Staging environment"
        },
        {
            "url": "https://prod.example.com",
            "description": "Production environment"
        }
    ],
    "paths": {
            // Hier mehr Einstellungen
    }
}
```

/// tip | Tipp

Beachten Sie den automatisch generierten Server mit dem `URL`-Wert `/api/v1`, welcher vom `root_path` stammt.

///

In der Dokumentationsoberfl√§che unter <a href="http://127.0.0.1:9999/api/v1/docs" class="external-link" target="_blank">http://127.0.0.1:9999/api/v1/docs</a> w√ºrde es so aussehen:

<img src="/img/tutorial/behind-a-proxy/image03.png">

/// tip | Tipp

Die Dokumentationsoberfl√§che interagiert mit dem von Ihnen ausgew√§hlten Server.

///

### Den automatischen Server von `root_path` deaktivieren

Wenn Sie nicht m√∂chten, dass **FastAPI** einen automatischen Server inkludiert, welcher `root_path` verwendet, k√∂nnen Sie den Parameter `root_path_in_servers=False` verwenden:

{* ../../docs_src/behind_a_proxy/tutorial004.py hl[9] *}

Dann wird er nicht in das OpenAPI-Schema aufgenommen.

## Mounten einer Unteranwendung

Wenn Sie gleichzeitig eine Unteranwendung mounten (wie beschrieben in [Unteranwendungen ‚Äì Mounts](sub-applications.md){.internal-link target=_blank}) und einen Proxy mit `root_path` verwenden wollen, k√∂nnen Sie das normal tun, wie Sie es erwarten w√ºrden.

FastAPI verwendet intern den `root_path` auf intelligente Weise, sodass es einfach funktioniert. ‚ú®


================================================
File: /docs/de/docs/advanced/custom-response.md
================================================
# Benutzerdefinierte Response ‚Äì HTML, Stream, Datei, andere

Standardm√§√üig gibt **FastAPI** die Responses mittels `JSONResponse` zur√ºck.

Sie k√∂nnen das √ºberschreiben, indem Sie direkt eine `Response` zur√ºckgeben, wie in [Eine Response direkt zur√ºckgeben](response-directly.md){.internal-link target=_blank} gezeigt.

Wenn Sie jedoch direkt eine `Response` zur√ºckgeben, werden die Daten nicht automatisch konvertiert und die Dokumentation wird nicht automatisch generiert (zum Beispiel wird der spezifische ‚ÄûMedientyp‚Äú, der im HTTP-Header `Content-Type` angegeben ist, nicht Teil der generierten OpenAPI).

Sie k√∂nnen aber auch die `Response`, die Sie verwenden m√∂chten, im *Pfadoperation-Dekorator* deklarieren.

Der Inhalt, den Sie von Ihrer *Pfadoperation-Funktion* zur√ºckgeben, wird in diese `Response` eingef√ºgt.

Und wenn diese `Response` einen JSON-Medientyp (`application/json`) hat, wie es bei `JSONResponse` und `UJSONResponse` der Fall ist, werden die von Ihnen zur√ºckgegebenen Daten automatisch mit jedem Pydantic `response_model` konvertiert (und gefiltert), das Sie im *Pfadoperation-Dekorator* deklariert haben.

/// note | Hinweis

Wenn Sie eine Response-Klasse ohne Medientyp verwenden, erwartet FastAPI, dass Ihre Response keinen Inhalt hat, und dokumentiert daher das Format der Response nicht in deren generierter OpenAPI-Dokumentation.

///

## `ORJSONResponse` verwenden

Um beispielsweise noch etwas Leistung herauszuholen, k√∂nnen Sie <a href="https://github.com/ijl/orjson" class="external-link" target="_blank">`orjson`</a> installieren und verwenden, und die Response als `ORJSONResponse` deklarieren.

Importieren Sie die `Response`-Klasse (-Unterklasse), die Sie verwenden m√∂chten, und deklarieren Sie sie im *Pfadoperation-Dekorator*.

Bei umfangreichen Responses ist die direkte R√ºckgabe einer `Response` viel schneller als ein Dictionary zur√ºckzugeben.

Das liegt daran, dass FastAPI standardm√§√üig jedes enthaltene Element √ºberpr√ºft und sicherstellt, dass es als JSON serialisierbar ist, und zwar unter Verwendung desselben [JSON-kompatiblen Encoders](../tutorial/encoder.md){.internal-link target=_blank}, der im Tutorial erl√§utert wurde. Dadurch k√∂nnen Sie **beliebige Objekte** zur√ºckgeben, zum Beispiel Datenbankmodelle.

Wenn Sie jedoch sicher sind, dass der von Ihnen zur√ºckgegebene Inhalt **mit JSON serialisierbar** ist, k√∂nnen Sie ihn direkt an die Response-Klasse √ºbergeben und die zus√§tzliche Arbeit vermeiden, die FastAPI h√§tte, indem es Ihren zur√ºckgegebenen Inhalt durch den `jsonable_encoder` leitet, bevor es ihn an die Response-Klasse √ºbergibt.

{* ../../docs_src/custom_response/tutorial001b.py hl[2,7] *}

/// info

Der Parameter `response_class` wird auch verwendet, um den ‚ÄûMedientyp‚Äú der Response zu definieren.

In diesem Fall wird der HTTP-Header `Content-Type` auf `application/json` gesetzt.

Und er wird als solcher in OpenAPI dokumentiert.

///

/// tip | Tipp

Die `ORJSONResponse` ist derzeit nur in FastAPI verf√ºgbar, nicht in Starlette.

///

## HTML-Response

Um eine Response mit HTML direkt von **FastAPI** zur√ºckzugeben, verwenden Sie `HTMLResponse`.

* Importieren Sie `HTMLResponse`.
* √úbergeben Sie `HTMLResponse` als den Parameter `response_class` Ihres *Pfadoperation-Dekorators*.

{* ../../docs_src/custom_response/tutorial002.py hl[2,7] *}

/// info

Der Parameter `response_class` wird auch verwendet, um den ‚ÄûMedientyp‚Äú der Response zu definieren.

In diesem Fall wird der HTTP-Header `Content-Type` auf `text/html` gesetzt.

Und er wird als solcher in OpenAPI dokumentiert.

///

### Eine `Response` zur√ºckgeben

Wie in [Eine Response direkt zur√ºckgeben](response-directly.md){.internal-link target=_blank} gezeigt, k√∂nnen Sie die Response auch direkt in Ihrer *Pfadoperation* √ºberschreiben, indem Sie diese zur√ºckgeben.

Das gleiche Beispiel von oben, das eine `HTMLResponse` zur√ºckgibt, k√∂nnte so aussehen:

{* ../../docs_src/custom_response/tutorial003.py hl[2,7,19] *}

/// warning | Achtung

Eine `Response`, die direkt von Ihrer *Pfadoperation-Funktion* zur√ºckgegeben wird, wird in OpenAPI nicht dokumentiert (zum Beispiel wird der `Content-Type` nicht dokumentiert) und ist in der automatischen interaktiven Dokumentation nicht sichtbar.

///

/// info

Nat√ºrlich stammen der eigentliche `Content-Type`-Header, der Statuscode, usw., aus dem `Response`-Objekt, das Sie zur√ºckgegeben haben.

///

### In OpenAPI dokumentieren und `Response` √ºberschreiben

Wenn Sie die Response innerhalb der Funktion √ºberschreiben und gleichzeitig den ‚ÄûMedientyp‚Äú in OpenAPI dokumentieren m√∂chten, k√∂nnen Sie den `response_class`-Parameter verwenden UND ein `Response`-Objekt zur√ºckgeben.

Die `response_class` wird dann nur zur Dokumentation der OpenAPI-Pfadoperation* verwendet, Ihre `Response` wird jedoch unver√§ndert verwendet.

#### Eine `HTMLResponse` direkt zur√ºckgeben

Es k√∂nnte zum Beispiel so etwas sein:

{* ../../docs_src/custom_response/tutorial004.py hl[7,21,23] *}

In diesem Beispiel generiert die Funktion `generate_html_response()` bereits eine `Response` und gibt sie zur√ºck, anstatt das HTML in einem `str` zur√ºckzugeben.

Indem Sie das Ergebnis des Aufrufs von `generate_html_response()` zur√ºckgeben, geben Sie bereits eine `Response` zur√ºck, die das Standardverhalten von **FastAPI** √ºberschreibt.

Aber da Sie die `HTMLResponse` auch in der `response_class` √ºbergeben haben, wei√ü **FastAPI**, dass sie in OpenAPI und der interaktiven Dokumentation als HTML mit `text/html` zu dokumentieren ist:

<img src="/img/tutorial/custom-response/image01.png">

## Verf√ºgbare Responses

Hier sind einige der verf√ºgbaren Responses.

Bedenken Sie, dass Sie `Response` verwenden k√∂nnen, um alles andere zur√ºckzugeben, oder sogar eine benutzerdefinierte Unterklasse zu erstellen.

/// note | Technische Details

Sie k√∂nnen auch `from starlette.responses import HTMLResponse` verwenden.

**FastAPI** bietet dieselben `starlette.responses` auch via `fastapi.responses` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Die meisten verf√ºgbaren Responses kommen aber direkt von Starlette.

///

### `Response`

Die Hauptklasse `Response`, alle anderen Responses erben von ihr.

Sie k√∂nnen sie direkt zur√ºckgeben.

Sie akzeptiert die folgenden Parameter:

* `content` ‚Äì Ein `str` oder `bytes`.
* `status_code` ‚Äì Ein `int`-HTTP-Statuscode.
* `headers` ‚Äì Ein `dict` von Strings.
* `media_type` ‚Äì Ein `str`, der den Medientyp angibt. Z. B. `"text/html"`.

FastAPI (eigentlich Starlette) f√ºgt automatisch einen Content-Length-Header ein. Au√üerdem wird es einen Content-Type-Header einf√ºgen, der auf dem media_type basiert, und f√ºr Texttypen einen Zeichensatz (charset) anf√ºgen.

{* ../../docs_src/response_directly/tutorial002.py hl[1,18] *}

### `HTMLResponse`

Nimmt Text oder Bytes entgegen und gibt eine HTML-Response zur√ºck, wie Sie oben gelesen haben.

### `PlainTextResponse`

Nimmt Text oder Bytes entgegen und gibt eine Plain-Text-Response zur√ºck.

{* ../../docs_src/custom_response/tutorial005.py hl[2,7,9] *}

### `JSONResponse`

Nimmt einige Daten entgegen und gibt eine `application/json`-codierte Response zur√ºck.

Dies ist die Standard-Response, die in **FastAPI** verwendet wird, wie Sie oben gelesen haben.

### `ORJSONResponse`

Eine schnelle alternative JSON-Response mit <a href="https://github.com/ijl/orjson" class="external-link" target="_blank">`orjson`</a>, wie Sie oben gelesen haben.

### `UJSONResponse`

Eine alternative JSON-Response mit <a href="https://github.com/ultrajson/ultrajson" class="external-link" target="_blank">`ujson`</a>.

/// warning | Achtung

`ujson` ist bei der Behandlung einiger Sonderf√§lle weniger sorgf√§ltig als Pythons eingebaute Implementierung.

///

{* ../../docs_src/custom_response/tutorial001.py hl[2,7] *}

/// tip | Tipp

M√∂glicherweise ist `ORJSONResponse` eine schnellere Alternative.

///

### `RedirectResponse`

Gibt eine HTTP-Weiterleitung (HTTP-Redirect) zur√ºck. Verwendet standardm√§√üig den Statuscode 307 ‚Äì Tempor√§re Weiterleitung (Temporary Redirect).

Sie k√∂nnen eine `RedirectResponse` direkt zur√ºckgeben:

{* ../../docs_src/custom_response/tutorial006.py hl[2,9] *}

---

Oder Sie k√∂nnen sie im Parameter `response_class` verwenden:


{* ../../docs_src/custom_response/tutorial006b.py hl[2,7,9] *}

Wenn Sie das tun, k√∂nnen Sie die URL direkt von Ihrer *Pfadoperation*-Funktion zur√ºckgeben.

In diesem Fall ist der verwendete `status_code` der Standardcode f√ºr die `RedirectResponse`, also `307`.

---

Sie k√∂nnen den Parameter `status_code` auch in Kombination mit dem Parameter `response_class` verwenden:

{* ../../docs_src/custom_response/tutorial006c.py hl[2,7,9] *}

### `StreamingResponse`

Nimmt einen asynchronen Generator oder einen normalen Generator/Iterator und streamt den Responsebody.

{* ../../docs_src/custom_response/tutorial007.py hl[2,14] *}

#### Verwendung von `StreamingResponse` mit datei√§hnlichen Objekten

Wenn Sie ein datei√§hnliches (file-like) Objekt haben (z. B. das von `open()` zur√ºckgegebene Objekt), k√∂nnen Sie eine Generatorfunktion erstellen, um √ºber dieses datei√§hnliche Objekt zu iterieren.

Auf diese Weise m√ºssen Sie nicht alles zuerst in den Arbeitsspeicher lesen und k√∂nnen diese Generatorfunktion an `StreamingResponse` √ºbergeben und zur√ºckgeben.

Das umfasst viele Bibliotheken zur Interaktion mit Cloud-Speicher, Videoverarbeitung und anderen.

```{ .python .annotate hl_lines="2  10-12  14" }
{!../../docs_src/custom_response/tutorial008.py!}
```

1. Das ist die Generatorfunktion. Es handelt sich um eine ‚ÄûGeneratorfunktion‚Äú, da sie `yield`-Anweisungen enth√§lt.
2. Durch die Verwendung eines `with`-Blocks stellen wir sicher, dass das datei√§hnliche Objekt geschlossen wird, nachdem die Generatorfunktion fertig ist. Also, nachdem sie mit dem Senden der Response fertig ist.
3. Dieses `yield from` weist die Funktion an, √ºber das Ding namens `file_like` zu iterieren. Und dann f√ºr jeden iterierten Teil, diesen Teil so zur√ºckzugeben, als wenn er aus dieser Generatorfunktion (`iterfile`) stammen w√ºrde.

    Es handelt sich also hier um eine Generatorfunktion, die die ‚Äûgenerierende‚Äú Arbeit intern auf etwas anderes √ºbertr√§gt.

    Auf diese Weise k√∂nnen wir das Ganze in einen `with`-Block einf√ºgen und so sicherstellen, dass das dateiartige Objekt nach Abschluss geschlossen wird.

/// tip | Tipp

Beachten Sie, dass wir, da wir Standard-`open()` verwenden, welches `async` und `await` nicht unterst√ºtzt, hier die Pfadoperation mit normalen `def` deklarieren.

///

### `FileResponse`

Streamt eine Datei asynchron als Response.

Nimmt zur Instanziierung einen anderen Satz von Argumenten entgegen als die anderen Response-Typen:

* `path` ‚Äì Der Dateipfad zur Datei, die gestreamt werden soll.
* `headers` ‚Äì Alle benutzerdefinierten Header, die inkludiert werden sollen, als Dictionary.
* `media_type` ‚Äì Ein String, der den Medientyp angibt. Wenn nicht gesetzt, wird der Dateiname oder Pfad verwendet, um auf einen Medientyp zu schlie√üen.
* `filename` ‚Äì Wenn gesetzt, wird das in der `Content-Disposition` der Response eingef√ºgt.

Datei-Responses enthalten die entsprechenden `Content-Length`-, `Last-Modified`- und `ETag`-Header.

{* ../../docs_src/custom_response/tutorial009.py hl[2,10] *}

Sie k√∂nnen auch den Parameter `response_class` verwenden:

{* ../../docs_src/custom_response/tutorial009b.py hl[2,8,10] *}

In diesem Fall k√∂nnen Sie den Dateipfad direkt von Ihrer *Pfadoperation*-Funktion zur√ºckgeben.

## Benutzerdefinierte Response-Klasse

Sie k√∂nnen Ihre eigene benutzerdefinierte Response-Klasse erstellen, die von `Response` erbt und diese verwendet.

Nehmen wir zum Beispiel an, dass Sie <a href="https://github.com/ijl/orjson" class="external-link" target="_blank">`orjson`</a> verwenden m√∂chten, aber mit einigen benutzerdefinierten Einstellungen, die in der enthaltenen `ORJSONResponse`-Klasse nicht verwendet werden.

Sie m√∂chten etwa, dass Ihre Response einger√ºcktes und formatiertes JSON zur√ºckgibt. Daf√ºr m√∂chten Sie die orjson-Option `orjson.OPT_INDENT_2` verwenden.

Sie k√∂nnten eine `CustomORJSONResponse` erstellen. Das Wichtigste, was Sie tun m√ºssen, ist, eine `Response.render(content)`-Methode zu erstellen, die den Inhalt als `bytes` zur√ºckgibt:

{* ../../docs_src/custom_response/tutorial009c.py hl[9:14,17] *}

Statt:

```json
{"message": "Hello World"}
```

... wird die Response jetzt Folgendes zur√ºckgeben:

```json
{
  "message": "Hello World"
}
```

Nat√ºrlich werden Sie wahrscheinlich viel bessere M√∂glichkeiten finden, Vorteil daraus zu ziehen, als JSON zu formatieren. üòâ

## Standard-Response-Klasse

Beim Erstellen einer **FastAPI**-Klasseninstanz oder eines `APIRouter`s k√∂nnen Sie angeben, welche Response-Klasse standardm√§√üig verwendet werden soll.

Der Parameter, der das definiert, ist `default_response_class`.

Im folgenden Beispiel verwendet **FastAPI** standardm√§√üig `ORJSONResponse` in allen *Pfadoperationen*, anstelle von `JSONResponse`.

{* ../../docs_src/custom_response/tutorial010.py hl[2,4] *}

/// tip | Tipp

Sie k√∂nnen dennoch weiterhin `response_class` in *Pfadoperationen* √ºberschreiben, wie bisher.

///

## Zus√§tzliche Dokumentation

Sie k√∂nnen auch den Medientyp und viele andere Details in OpenAPI mit `responses` deklarieren: [Zus√§tzliche Responses in OpenAPI](additional-responses.md){.internal-link target=_blank}.


================================================
File: /docs/de/docs/advanced/dataclasses.md
================================================
# Verwendung von Datenklassen

FastAPI basiert auf **Pydantic** und ich habe Ihnen gezeigt, wie Sie Pydantic-Modelle verwenden k√∂nnen, um Requests und Responses zu deklarieren.

Aber FastAPI unterst√ºtzt auf die gleiche Weise auch die Verwendung von <a href="https://docs.python.org/3/library/dataclasses.html" class="external-link" target="_blank">`dataclasses`</a>:

{* ../../docs_src/dataclasses/tutorial001.py hl[1,7:12,19:20] *}

Das ist dank **Pydantic** ebenfalls m√∂glich, da es <a href="https://pydantic-docs.helpmanual.io/usage/dataclasses/#use-of-stdlib-dataclasses-with-basemodel" class="external-link" target="_blank">`dataclasses` intern unterst√ºtzt</a>.

Auch wenn im obige Code Pydantic nicht explizit vorkommt, verwendet FastAPI Pydantic, um diese Standard-Datenklassen in Pydantics eigene Variante von Datenklassen zu konvertieren.

Und nat√ºrlich wird das gleiche unterst√ºtzt:

* Validierung der Daten
* Serialisierung der Daten
* Dokumentation der Daten, usw.

Das funktioniert genauso wie mit Pydantic-Modellen. Und tats√§chlich wird es unter der Haube mittels Pydantic auf die gleiche Weise bewerkstelligt.

/// info

Bedenken Sie, dass Datenklassen nicht alles k√∂nnen, was Pydantic-Modelle k√∂nnen.

Daher m√ºssen Sie m√∂glicherweise weiterhin Pydantic-Modelle verwenden.

Wenn Sie jedoch eine Menge Datenklassen herumliegen haben, ist dies ein guter Trick, um sie f√ºr eine Web-API mithilfe von FastAPI zu verwenden. ü§ì

///

## Datenklassen als `response_model`

Sie k√∂nnen `dataclasses` auch im Parameter `response_model` verwenden:

{* ../../docs_src/dataclasses/tutorial002.py hl[1,7:13,19] *}

Die Datenklasse wird automatisch in eine Pydantic-Datenklasse konvertiert.

Auf diese Weise wird deren Schema in der Benutzeroberfl√§che der API-Dokumentation angezeigt:

<img src="/img/tutorial/dataclasses/image01.png">

## Datenklassen in verschachtelten Datenstrukturen

Sie k√∂nnen `dataclasses` auch mit anderen Typannotationen kombinieren, um verschachtelte Datenstrukturen zu erstellen.

In einigen F√§llen m√ºssen Sie m√∂glicherweise immer noch Pydantics Version von `dataclasses` verwenden. Zum Beispiel, wenn Sie Fehler in der automatisch generierten API-Dokumentation haben.

In diesem Fall k√∂nnen Sie einfach die Standard-`dataclasses` durch `pydantic.dataclasses` ersetzen, was einen direkten Ersatz darstellt:

{* ../../docs_src/dataclasses/tutorial003.py hl[1,5,8:11,14:17,23:25,28] *}

1. Wir importieren `field` weiterhin von Standard-`dataclasses`.

2. `pydantic.dataclasses` ist ein direkter Ersatz f√ºr `dataclasses`.

3. Die Datenklasse `Author` enth√§lt eine Liste von `Item`-Datenklassen.

4. Die Datenklasse `Author` wird im `response_model`-Parameter verwendet.

5. Sie k√∂nnen andere Standard-Typannotationen mit Datenklassen als Requestbody verwenden.

    In diesem Fall handelt es sich um eine Liste von `Item`-Datenklassen.

6. Hier geben wir ein Dictionary zur√ºck, das `items` enth√§lt, welches eine Liste von Datenklassen ist.

    FastAPI ist weiterhin in der Lage, die Daten nach JSON zu <abbr title="Konvertieren der Daten in ein √ºbertragbares Format">serialisieren</abbr>.

7. Hier verwendet das `response_model` als Typannotation eine Liste von `Author`-Datenklassen.

    Auch hier k√∂nnen Sie `dataclasses` mit Standard-Typannotationen kombinieren.

8. Beachten Sie, dass diese *Pfadoperation-Funktion* regul√§res `def` anstelle von `async def` verwendet.

    Wie immer k√∂nnen Sie in FastAPI `def` und `async def` beliebig kombinieren.

    Wenn Sie eine Auffrischung dar√ºber ben√∂tigen, wann welche Anwendung sinnvoll ist, lesen Sie den Abschnitt ‚ÄûIn Eile?‚Äú in der Dokumentation zu [`async` und `await`](../async.md#in-eile){.internal-link target=_blank}.

9. Diese *Pfadoperation-Funktion* gibt keine Datenklassen zur√ºck (obwohl dies m√∂glich w√§re), sondern eine Liste von Dictionarys mit internen Daten.

    FastAPI verwendet den Parameter `response_model` (der Datenklassen enth√§lt), um die Response zu konvertieren.

Sie k√∂nnen `dataclasses` mit anderen Typannotationen auf vielf√§ltige Weise kombinieren, um komplexe Datenstrukturen zu bilden.

Weitere Einzelheiten finden Sie in den Bemerkungen im Quellcode oben.

## Mehr erfahren

Sie k√∂nnen `dataclasses` auch mit anderen Pydantic-Modellen kombinieren, von ihnen erben, sie in Ihre eigenen Modelle einbinden, usw.

Weitere Informationen finden Sie in der <a href="https://pydantic-docs.helpmanual.io/usage/dataclasses/" class="external-link" target="_blank">Pydantic-Dokumentation zu Datenklassen</a>.

## Version

Dies ist verf√ºgbar seit FastAPI-Version `0.67.0`. üîñ


================================================
File: /docs/de/docs/advanced/events.md
================================================
# Lifespan-Events

Sie k√∂nnen Logik (Code) definieren, die ausgef√ºhrt werden soll, bevor die Anwendung **hochf√§hrt**. Dies bedeutet, dass dieser Code **einmal** ausgef√ºhrt wird, **bevor** die Anwendung **beginnt, Requests entgegenzunehmen**.

Auf die gleiche Weise k√∂nnen Sie Logik (Code) definieren, die ausgef√ºhrt werden soll, wenn die Anwendung **heruntergefahren** wird. In diesem Fall wird dieser Code **einmal** ausgef√ºhrt, **nachdem** m√∂glicherweise **viele Requests** bearbeitet wurden.

Da dieser Code ausgef√ºhrt wird, bevor die Anwendung **beginnt**, Requests entgegenzunehmen, und unmittelbar, nachdem sie die Bearbeitung von Requests **abgeschlossen hat**, deckt er die gesamte **Lebensdauer ‚Äì ‚ÄûLifespan‚Äú** ‚Äì der Anwendung ab (das Wort ‚ÄûLifespan‚Äú wird gleich wichtig sein üòâ).

Dies kann sehr n√ºtzlich sein, um **Ressourcen** einzurichten, die Sie in der gesamten Anwendung verwenden wollen und die von Requests **gemeinsam genutzt** werden und/oder die Sie anschlie√üend **aufr√§umen** m√ºssen. Zum Beispiel ein Pool von Datenbankverbindungen oder das Laden eines gemeinsam genutzten Modells f√ºr maschinelles Lernen.

## Anwendungsfall

Beginnen wir mit einem Beispiel-**Anwendungsfall** und schauen uns dann an, wie wir ihn mit dieser Methode implementieren k√∂nnen.

Stellen wir uns vor, Sie verf√ºgen √ºber einige **Modelle f√ºr maschinelles Lernen**, die Sie zur Bearbeitung von Requests verwenden m√∂chten. ü§ñ

Die gleichen Modelle werden von den Requests gemeinsam genutzt, es handelt sich also nicht um ein Modell pro Request, pro Benutzer, oder √§hnliches.

Stellen wir uns vor, dass das Laden des Modells **eine ganze Weile dauern** kann, da viele **Daten von der Festplatte** gelesen werden m√ºssen. Sie m√∂chten das also nicht f√ºr jeden Request tun.

Sie k√∂nnten das auf der obersten Ebene des Moduls/der Datei machen, aber das w√ºrde auch bedeuten, dass **das Modell geladen wird**, selbst wenn Sie nur einen einfachen automatisierten Test ausf√ºhren, dann w√§re dieser Test **langsam**, weil er warten m√ºsste, bis das Modell geladen ist, bevor er einen davon unabh√§ngigen Teil des Codes ausf√ºhren k√∂nnte.

Das wollen wir besser machen: Laden wir das Modell, bevor die Requests bearbeitet werden, aber unmittelbar bevor die Anwendung beginnt, Requests zu empfangen, und nicht, w√§hrend der Code geladen wird.

## Lifespan

Sie k√∂nnen diese Logik beim *Hochfahren* und *Herunterfahren* mithilfe des `lifespan`-Parameters der `FastAPI`-App und eines ‚ÄûKontextmanagers‚Äú definieren (ich zeige Ihnen gleich, was das ist).

Beginnen wir mit einem Beispiel und sehen es uns dann im Detail an.

Wir erstellen eine asynchrone Funktion `lifespan()` mit `yield` wie folgt:

{* ../../docs_src/events/tutorial003.py hl[16,19] *}

Hier simulieren wir das langsame *Hochfahren*, das Laden des Modells, indem wir die (Fake-)Modellfunktion vor dem `yield` in das Dictionary mit Modellen f√ºr maschinelles Lernen einf√ºgen. Dieser Code wird ausgef√ºhrt, **bevor** die Anwendung **beginnt, Requests entgegenzunehmen**, w√§hrend des *Hochfahrens*.

Und dann, direkt nach dem `yield`, entladen wir das Modell. Dieser Code wird unmittelbar vor dem *Herunterfahren* ausgef√ºhrt, **nachdem** die Anwendung **die Bearbeitung von Requests abgeschlossen hat**. Dadurch k√∂nnten beispielsweise Ressourcen wie Arbeitsspeicher oder eine GPU freigegeben werden.

/// tip | Tipp

Das *Herunterfahren* w√ºrde erfolgen, wenn Sie die Anwendung **stoppen**.

M√∂glicherweise m√ºssen Sie eine neue Version starten, oder Sie haben es einfach satt, sie auszuf√ºhren. ü§∑

///

### Lifespan-Funktion

Das Erste, was auff√§llt, ist, dass wir eine asynchrone Funktion mit `yield` definieren. Das ist sehr √§hnlich zu Abh√§ngigkeiten mit `yield`.

{* ../../docs_src/events/tutorial003.py hl[14:19] *}

Der erste Teil der Funktion, vor dem `yield`, wird ausgef√ºhrt **bevor** die Anwendung startet.

Und der Teil nach `yield` wird ausgef√ºhrt, **nachdem** die Anwendung beendet ist.

### Asynchroner Kontextmanager

Wie Sie sehen, ist die Funktion mit einem `@asynccontextmanager` versehen.

Dadurch wird die Funktion in einen sogenannten ‚Äû**asynchronen Kontextmanager**‚Äú umgewandelt.

{* ../../docs_src/events/tutorial003.py hl[1,13] *}

Ein **Kontextmanager** in Python ist etwas, das Sie in einer `with`-Anweisung verwenden k√∂nnen, zum Beispiel kann `open()` als Kontextmanager verwendet werden:

```Python
with open("file.txt") as file:
    file.read()
```

In neueren Versionen von Python gibt es auch einen **asynchronen Kontextmanager**. Sie w√ºrden ihn mit `async with` verwenden:

```Python
async with lifespan(app):
    await do_stuff()
```

Wenn Sie wie oben einen Kontextmanager oder einen asynchronen Kontextmanager erstellen, f√ºhrt dieser vor dem Betreten des `with`-Blocks den Code vor dem `yield` aus, und nach dem Verlassen des `with`-Blocks wird er den Code nach dem `yield` ausf√ºhren.

In unserem obigen Codebeispiel verwenden wir ihn nicht direkt, sondern √ºbergeben ihn an FastAPI, damit es ihn verwenden kann.

Der Parameter `lifespan` der `FastAPI`-App ben√∂tigt einen **asynchronen Kontextmanager**, wir k√∂nnen ihm also unseren neuen asynchronen Kontextmanager `lifespan` √ºbergeben.

{* ../../docs_src/events/tutorial003.py hl[22] *}

## Alternative Events (deprecated)

/// warning | Achtung

Der empfohlene Weg, das *Hochfahren* und *Herunterfahren* zu handhaben, ist die Verwendung des `lifespan`-Parameters der `FastAPI`-App, wie oben beschrieben. Wenn Sie einen `lifespan`-Parameter √ºbergeben, werden die `startup`- und `shutdown`-Eventhandler nicht mehr aufgerufen. Es ist entweder alles `lifespan` oder alles Events, nicht beides.

Sie k√∂nnen diesen Teil wahrscheinlich √ºberspringen.

///

Es gibt eine alternative M√∂glichkeit, diese Logik zu definieren, sodass sie beim *Hochfahren* und beim *Herunterfahren* ausgef√ºhrt wird.

Sie k√∂nnen <abbr title="Eventhandler ‚Äì Ereignisbehandler: Funktion, die bei jedem Eintreten eines bestimmten Ereignisses ausgef√ºhrt wird">Eventhandler</abbr> (Funktionen) definieren, die ausgef√ºhrt werden sollen, bevor die Anwendung hochgefahren wird oder wenn die Anwendung heruntergefahren wird.

Diese Funktionen k√∂nnen mit `async def` oder normalem `def` deklariert werden.

### `startup`-Event

Um eine Funktion hinzuzuf√ºgen, die vor dem Start der Anwendung ausgef√ºhrt werden soll, deklarieren Sie diese mit dem Event `startup`:

{* ../../docs_src/events/tutorial001.py hl[8] *}

In diesem Fall initialisiert die Eventhandler-Funktion `startup` die ‚ÄûDatenbank‚Äú der Items (nur ein `dict`) mit einigen Werten.

Sie k√∂nnen mehr als eine Eventhandler-Funktion hinzuf√ºgen.

Und Ihre Anwendung empf√§ngt erst dann Anfragen, wenn alle `startup`-Eventhandler abgeschlossen sind.

### `shutdown`-Event

Um eine Funktion hinzuzuf√ºgen, die beim Herunterfahren der Anwendung ausgef√ºhrt werden soll, deklarieren Sie sie mit dem Event `shutdown`:

{* ../../docs_src/events/tutorial002.py hl[6] *}

Hier schreibt die `shutdown`-Eventhandler-Funktion eine Textzeile `"Application shutdown"` in eine Datei `log.txt`.

/// info

In der Funktion `open()` bedeutet `mode="a"` ‚Äûappend‚Äú (‚Äûanh√§ngen‚Äú), sodass die Zeile nach dem, was sich in dieser Datei befindet, hinzugef√ºgt wird, ohne den vorherigen Inhalt zu √ºberschreiben.

///

/// tip | Tipp

Beachten Sie, dass wir in diesem Fall eine Standard-Python-Funktion `open()` verwenden, die mit einer Datei interagiert.

Es handelt sich also um I/O (Input/Output), welches ‚ÄûWarten‚Äú erfordert, bis Dinge auf die Festplatte geschrieben werden.

Aber `open()` verwendet nicht `async` und `await`.

Daher deklarieren wir die Eventhandler-Funktion mit Standard-`def` statt mit `async def`.

///

### `startup` und `shutdown` zusammen

Es besteht eine hohe Wahrscheinlichkeit, dass die Logik f√ºr Ihr *Hochfahren* und *Herunterfahren* miteinander verkn√ºpft ist. Vielleicht m√∂chten Sie etwas beginnen und es dann beenden, eine Ressource laden und sie dann freigeben usw.

Bei getrennten Funktionen, die keine gemeinsame Logik oder Variablen haben, ist dies schwieriger, da Sie Werte in globalen Variablen speichern oder √§hnliche Tricks verwenden m√ºssen.

Aus diesem Grund wird jetzt empfohlen, stattdessen `lifespan` wie oben erl√§utert zu verwenden.

## Technische Details

Nur ein technisches Detail f√ºr die neugierigen Nerds. ü§ì

In der technischen ASGI-Spezifikation ist dies Teil des <a href="https://asgi.readthedocs.io/en/latest/specs/lifespan.html" class="external-link" target="_blank">Lifespan Protokolls</a> und definiert Events namens `startup` und `shutdown`.

/// info

Weitere Informationen zu Starlettes `lifespan`-Handlern finden Sie in <a href="https://www.starlette.io/lifespan/" class="external-link" target="_blank">Starlettes Lifespan-Dokumentation</a>.

Einschlie√ülich, wie man Lifespan-Zustand handhabt, der in anderen Bereichen Ihres Codes verwendet werden kann.

///

## Unteranwendungen

üö® Beachten Sie, dass diese Lifespan-Events (Hochfahren und Herunterfahren) nur f√ºr die Hauptanwendung ausgef√ºhrt werden, nicht f√ºr [Unteranwendungen ‚Äì Mounts](sub-applications.md){.internal-link target=_blank}.


================================================
File: /docs/de/docs/advanced/generate-clients.md
================================================
# Clients generieren

Da **FastAPI** auf der OpenAPI-Spezifikation basiert, erhalten Sie automatische Kompatibilit√§t mit vielen Tools, einschlie√ülich der automatischen API-Dokumentation (bereitgestellt von Swagger UI).

Ein besonderer Vorteil, der nicht unbedingt offensichtlich ist, besteht darin, dass Sie f√ºr Ihre API **Clients generieren** k√∂nnen (manchmal auch <abbr title="Software Development Kits">**SDKs**</abbr> genannt), f√ºr viele verschiedene **Programmiersprachen**.

## OpenAPI-Client-Generatoren

Es gibt viele Tools zum Generieren von Clients aus **OpenAPI**.

Ein g√§ngiges Tool ist <a href="https://openapi-generator.tech/" class="external-link" target="_blank">OpenAPI Generator</a>.

Wenn Sie ein **Frontend** erstellen, ist <a href="https://github.com/hey-api/openapi-ts" class="external-link" target="_blank">openapi-ts</a> eine sehr interessante Alternative.

## Client- und SDK-Generatoren ‚Äì Sponsor

Es gibt auch einige **vom Unternehmen entwickelte** Client- und SDK-Generatoren, die auf OpenAPI (FastAPI) basieren. In einigen F√§llen k√∂nnen diese Ihnen **weitere Funktionalit√§t** zus√§tzlich zu qualitativ hochwertigen generierten SDKs/Clients bieten.

Einige von diesen ‚ú® [**sponsern FastAPI**](../help-fastapi.md#den-autor-sponsern){.internal-link target=_blank} ‚ú®, das gew√§hrleistet die kontinuierliche und gesunde **Entwicklung** von FastAPI und seinem **√ñkosystem**.

Und es zeigt deren wahres Engagement f√ºr FastAPI und seine **Community** (Sie), da diese Ihnen nicht nur einen **guten Service** bieten m√∂chten, sondern auch sicherstellen m√∂chten, dass Sie √ºber ein **gutes und gesundes Framework** verf√ºgen, FastAPI. üôá

Beispielsweise k√∂nnten Sie <a href="https://speakeasy.com/?utm_source=fastapi+repo&utm_medium=github+sponsorship" class="external-link" target="_blank">Speakeasy</a> ausprobieren.

Es gibt auch mehrere andere Unternehmen, welche √§hnliche Dienste anbieten und die Sie online suchen und finden k√∂nnen. ü§ì

## Einen TypeScript-Frontend-Client generieren

Beginnen wir mit einer einfachen FastAPI-Anwendung:

{* ../../docs_src/generate_clients/tutorial001_py39.py hl[7:9,12:13,16:17,21] *}

Beachten Sie, dass die *Pfadoperationen* die Modelle definieren, welche diese f√ºr die Request- und Response-<abbr title="Die eigentlichen Nutzdaten, abz√ºglich der Metadaten">Payload</abbr> verwenden, indem sie die Modelle `Item` und `ResponseMessage` verwenden.

### API-Dokumentation

Wenn Sie zur API-Dokumentation gehen, werden Sie sehen, dass diese die **Schemas** f√ºr die Daten enth√§lt, welche in Requests gesendet und in Responses empfangen werden:

<img src="/img/tutorial/generate-clients/image01.png">

Sie k√∂nnen diese Schemas sehen, da sie mit den Modellen in der Anwendung deklariert wurden.

Diese Informationen sind im **OpenAPI-Schema** der Anwendung verf√ºgbar und werden dann in der API-Dokumentation angezeigt (von Swagger UI).

Und dieselben Informationen aus den Modellen, die in OpenAPI enthalten sind, k√∂nnen zum **Generieren des Client-Codes** verwendet werden.

### Einen TypeScript-Client generieren

Nachdem wir nun die Anwendung mit den Modellen haben, k√∂nnen wir den Client-Code f√ºr das Frontend generieren.

#### `openapi-ts` installieren

Sie k√∂nnen `openapi-ts` in Ihrem Frontend-Code installieren mit:

<div class="termy">

```console
$ npm install @hey-api/openapi-ts --save-dev

---> 100%
```

</div>

#### Client-Code generieren

Um den Client-Code zu generieren, k√∂nnen Sie das Kommandozeilentool `openapi-ts` verwenden, das soeben installiert wurde.

Da es im lokalen Projekt installiert ist, k√∂nnten Sie diesen Befehl wahrscheinlich nicht direkt aufrufen, sondern w√ºrden ihn in Ihre Datei `package.json` einf√ºgen.

Diese k√∂nnte so aussehen:

```JSON  hl_lines="7"
{
  "name": "frontend-app",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "generate-client": "openapi-ts --input http://localhost:8000/openapi.json --output ./src/client --client axios"
  },
  "author": "",
  "license": "",
  "devDependencies": {
    "@hey-api/openapi-ts": "^0.27.38",
    "typescript": "^4.6.2"
  }
}
```

Nachdem Sie das NPM-Skript `generate-client` dort stehen haben, k√∂nnen Sie es ausf√ºhren mit:

<div class="termy">

```console
$ npm run generate-client

frontend-app@1.0.0 generate-client /home/user/code/frontend-app
> openapi-ts --input http://localhost:8000/openapi.json --output ./src/client --client axios
```

</div>

Dieser Befehl generiert Code in `./src/client` und verwendet intern `axios` (die Frontend-HTTP-Bibliothek).

### Den Client-Code ausprobieren

Jetzt k√∂nnen Sie den Client-Code importieren und verwenden. Er k√∂nnte wie folgt aussehen, beachten Sie, dass Sie automatische Codevervollst√§ndigung f√ºr die Methoden erhalten:

<img src="/img/tutorial/generate-clients/image02.png">

Sie erhalten au√üerdem automatische Vervollst√§ndigung f√ºr die zu sendende Payload:

<img src="/img/tutorial/generate-clients/image03.png">

/// tip | Tipp

Beachten Sie die automatische Vervollst√§ndigung f√ºr `name` und `price`, welche in der FastAPI-Anwendung im `Item`-Modell definiert wurden.

///

Sie erhalten Inline-Fehlerberichte f√ºr die von Ihnen gesendeten Daten:

<img src="/img/tutorial/generate-clients/image04.png">

Das Response-Objekt hat auch automatische Vervollst√§ndigung:

<img src="/img/tutorial/generate-clients/image05.png">

## FastAPI-Anwendung mit Tags

In vielen F√§llen wird Ihre FastAPI-Anwendung gr√∂√üer sein und Sie werden wahrscheinlich Tags verwenden, um verschiedene Gruppen von *Pfadoperationen* zu separieren.

Beispielsweise k√∂nnten Sie einen Abschnitt f√ºr **Items (Artikel)** und einen weiteren Abschnitt f√ºr **Users (Benutzer)** haben, und diese k√∂nnten durch Tags getrennt sein:

{* ../../docs_src/generate_clients/tutorial002_py39.py hl[21,26,34] *}

### Einen TypeScript-Client mit Tags generieren

Wenn Sie unter Verwendung von Tags einen Client f√ºr eine FastAPI-Anwendung generieren, wird normalerweise auch der Client-Code anhand der Tags getrennt.

Auf diese Weise k√∂nnen Sie die Dinge f√ºr den Client-Code richtig ordnen und gruppieren:

<img src="/img/tutorial/generate-clients/image06.png">

In diesem Fall haben Sie:

* `ItemsService`
* `UsersService`

### Client-Methodennamen

Im Moment sehen die generierten Methodennamen wie `createItemItemsPost` nicht sehr sauber aus:

```TypeScript
ItemsService.createItemItemsPost({name: "Plumbus", price: 5})
```

... das liegt daran, dass der Client-Generator f√ºr jede *Pfadoperation* die OpenAPI-interne **Operation-ID** verwendet.

OpenAPI erfordert, dass jede Operation-ID innerhalb aller *Pfadoperationen* eindeutig ist. Daher verwendet FastAPI den **Funktionsnamen**, den **Pfad** und die **HTTP-Methode/-Operation**, um diese Operation-ID zu generieren. Denn so kann sichergestellt werden, dass die Operation-IDs eindeutig sind.

Aber ich zeige Ihnen als n√§chstes, wie Sie das verbessern k√∂nnen. ü§ì

## Benutzerdefinierte Operation-IDs und bessere Methodennamen

Sie k√∂nnen die Art und Weise, wie diese Operation-IDs **generiert** werden, **√§ndern**, um sie einfacher zu machen und **einfachere Methodennamen** in den Clients zu haben.

In diesem Fall m√ºssen Sie auf andere Weise sicherstellen, dass jede Operation-ID **eindeutig** ist.

Sie k√∂nnten beispielsweise sicherstellen, dass jede *Pfadoperation* einen Tag hat, und dann die Operation-ID basierend auf dem **Tag** und dem **Namen** der *Pfadoperation* (dem Funktionsnamen) generieren.

### Funktion zum Generieren einer eindeutigen ID erstellen

FastAPI verwendet eine **eindeutige ID** f√ºr jede *Pfadoperation*, diese wird f√ºr die **Operation-ID** und auch f√ºr die Namen aller ben√∂tigten benutzerdefinierten Modelle f√ºr Requests oder Responses verwendet.

Sie k√∂nnen diese Funktion anpassen. Sie nimmt eine `APIRoute` und gibt einen String zur√ºck.

Hier verwendet sie beispielsweise den ersten Tag (Sie werden wahrscheinlich nur einen Tag haben) und den Namen der *Pfadoperation* (den Funktionsnamen).

Anschlie√üend k√∂nnen Sie diese benutzerdefinierte Funktion als Parameter `generate_unique_id_function` an **FastAPI** √ºbergeben:

{* ../../docs_src/generate_clients/tutorial003_py39.py hl[6:7,10] *}

### Einen TypeScript-Client mit benutzerdefinierten Operation-IDs generieren

Wenn Sie nun den Client erneut generieren, werden Sie feststellen, dass er √ºber die verbesserten Methodennamen verf√ºgt:

<img src="/img/tutorial/generate-clients/image07.png">

Wie Sie sehen, haben die Methodennamen jetzt den Tag und dann den Funktionsnamen, aber keine Informationen aus dem URL-Pfad und der HTTP-Operation.

### Vorab-Modifikation der OpenAPI-Spezifikation f√ºr den Client-Generator

Der generierte Code enth√§lt immer noch etwas **verdoppelte Information**.

Wir wissen bereits, dass diese Methode mit den **Items** zusammenh√§ngt, da sich dieses Wort in `ItemsService` befindet (vom Tag √ºbernommen), aber wir haben auch immer noch den Tagnamen im Methodennamen vorangestellt. üòï

Wir werden das wahrscheinlich weiterhin f√ºr OpenAPI im Allgemeinen beibehalten wollen, da dadurch sichergestellt wird, dass die Operation-IDs **eindeutig** sind.

Aber f√ºr den generierten Client k√∂nnten wir die OpenAPI-Operation-IDs direkt vor der Generierung der Clients **modifizieren**, um diese Methodennamen sch√∂ner und **sauberer** zu machen.

Wir k√∂nnten das OpenAPI-JSON in eine Datei `openapi.json` herunterladen und dann mit einem Skript wie dem folgenden **den vorangestellten Tag entfernen**:

{* ../../docs_src/generate_clients/tutorial004.py *}

//// tab | Node.js

```Javascript
{!> ../../docs_src/generate_clients/tutorial004.js!}
```

////

Damit w√ºrden die Operation-IDs von Dingen wie `items-get_items` in `get_items` umbenannt, sodass der Client-Generator einfachere Methodennamen generieren kann.

### Einen TypeScript-Client mit der modifizierten OpenAPI generieren

Da das Endergebnis nun in einer Datei `openapi.json` vorliegt, w√ºrden Sie die `package.json` √§ndern, um diese lokale Datei zu verwenden, zum Beispiel:

```JSON  hl_lines="7"
{
  "name": "frontend-app",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "generate-client": "openapi-ts --input ./openapi.json --output ./src/client --client axios"
  },
  "author": "",
  "license": "",
  "devDependencies": {
    "@hey-api/openapi-ts": "^0.27.38",
    "typescript": "^4.6.2"
  }
}
```

Nach der Generierung des neuen Clients h√§tten Sie nun **saubere Methodennamen** mit allen **Autovervollst√§ndigungen**, **Inline-Fehlerberichten**, usw.:

<img src="/img/tutorial/generate-clients/image08.png">

## Vorteile

Wenn Sie die automatisch generierten Clients verwenden, erhalten Sie **automatische Codevervollst√§ndigung** f√ºr:

* Methoden.
* Request-Payloads im Body, Query-Parameter, usw.
* Response-Payloads.

Au√üerdem erhalten Sie f√ºr alles **Inline-Fehlerberichte**.

Und wann immer Sie den Backend-Code aktualisieren und das Frontend **neu generieren**, stehen alle neuen *Pfadoperationen* als Methoden zur Verf√ºgung, die alten werden entfernt und alle anderen √Ñnderungen werden im generierten Code reflektiert. ü§ì

Das bedeutet auch, dass, wenn sich etwas √§ndert, dies automatisch im Client-Code **reflektiert** wird. Und wenn Sie den Client **erstellen**, kommt es zu einer Fehlermeldung, wenn die verwendeten Daten **nicht √ºbereinstimmen**.

Sie w√ºrden also sehr fr√ºh im Entwicklungszyklus **viele Fehler erkennen**, anstatt darauf warten zu m√ºssen, dass die Fehler Ihren Endbenutzern in der Produktion angezeigt werden, und dann zu versuchen, zu debuggen, wo das Problem liegt. ‚ú®


================================================
File: /docs/de/docs/advanced/index.md
================================================
# Handbuch f√ºr fortgeschrittene Benutzer

## Zusatzfunktionen

Das Haupt-[Tutorial ‚Äì Benutzerhandbuch](../tutorial/index.md){.internal-link target=_blank} sollte ausreichen, um Ihnen einen √úberblick √ºber alle Hauptfunktionen von **FastAPI** zu geben.

In den n√§chsten Abschnitten sehen Sie weitere Optionen, Konfigurationen und zus√§tzliche Funktionen.

/// tip | Tipp

Die n√§chsten Abschnitte sind **nicht unbedingt ‚Äûfortgeschritten‚Äú**.

Und es ist m√∂glich, dass f√ºr Ihren Anwendungsfall die L√∂sung in einem davon liegt.

///

## Lesen Sie zuerst das Tutorial

Sie k√∂nnen immer noch die meisten Funktionen in **FastAPI** mit den Kenntnissen aus dem Haupt-[Tutorial ‚Äì Benutzerhandbuch](../tutorial/index.md){.internal-link target=_blank} nutzen.

Und in den n√§chsten Abschnitten wird davon ausgegangen, dass Sie es bereits gelesen haben und dass Sie diese Haupt-Ideen kennen.

## Externe Kurse

Obwohl das [Tutorial ‚Äì Benutzerhandbuch](../tutorial/index.md){.internal-link target=_blank} und dieses **Handbuch f√ºr fortgeschrittene Benutzer** als gef√ºhrtes Tutorial (wie ein Buch) geschrieben sind und f√ºr Sie ausreichen sollten, um **FastAPI zu lernen**, m√∂chten Sie sie vielleicht durch zus√§tzliche Kurse erg√§nzen.

Oder Sie belegen einfach lieber andere Kurse, weil diese besser zu Ihrem Lernstil passen.

Einige Kursanbieter ‚ú® [**sponsern FastAPI**](../help-fastapi.md#den-autor-sponsern){.internal-link target=_blank} ‚ú®, dies gew√§hrleistet die kontinuierliche und gesunde **Entwicklung** von FastAPI und seinem **√ñkosystem**.

Und es zeigt deren wahres Engagement f√ºr FastAPI und seine **Gemeinschaft** (Sie), da diese Ihnen nicht nur eine **gute Lernerfahrung** bieten m√∂chten, sondern auch sicherstellen m√∂chten, dass Sie √ºber ein **gutes und gesundes Framework verf√ºgen **, FastAPI. üôá

Vielleicht m√∂chten Sie ihre Kurse ausprobieren:

* <a href="https://training.talkpython.fm/fastapi-courses" class="external-link" target="_blank">Talk Python Training</a>
* <a href="https://testdriven.io/courses/tdd-fastapi/" class="external-link" target="_blank">Test-Driven Development</a>


================================================
File: /docs/de/docs/advanced/middleware.md
================================================
# Fortgeschrittene Middleware

Im Haupttutorial haben Sie gelesen, wie Sie Ihrer Anwendung [benutzerdefinierte Middleware](../tutorial/middleware.md){.internal-link target=_blank} hinzuf√ºgen k√∂nnen.

Und dann auch, wie man [CORS mittels der `CORSMiddleware`](../tutorial/cors.md){.internal-link target=_blank} handhabt.

In diesem Abschnitt werden wir sehen, wie man andere Middlewares verwendet.

## ASGI-Middleware hinzuf√ºgen

Da **FastAPI** auf Starlette basiert und die <abbr title="Asynchronous Server Gateway Interface">ASGI</abbr>-Spezifikation implementiert, k√∂nnen Sie jede ASGI-Middleware verwenden.

Eine Middleware muss nicht speziell f√ºr FastAPI oder Starlette gemacht sein, um zu funktionieren, solange sie der ASGI-Spezifikation gen√ºgt.

Im Allgemeinen handelt es sich bei ASGI-Middleware um Klassen, die als erstes Argument eine ASGI-Anwendung erwarten.

In der Dokumentation f√ºr ASGI-Middlewares von Drittanbietern wird Ihnen wahrscheinlich gesagt, etwa Folgendes zu tun:

```Python
from unicorn import UnicornMiddleware

app = SomeASGIApp()

new_app = UnicornMiddleware(app, some_config="rainbow")
```

Aber FastAPI (eigentlich Starlette) bietet eine einfachere M√∂glichkeit, welche sicherstellt, dass die internen Middlewares zur Behandlung von Serverfehlern und benutzerdefinierten Exceptionhandlern ordnungsgem√§√ü funktionieren.

Dazu verwenden Sie `app.add_middleware()` (wie schon im Beispiel f√ºr CORS gesehen).

```Python
from fastapi import FastAPI
from unicorn import UnicornMiddleware

app = FastAPI()

app.add_middleware(UnicornMiddleware, some_config="rainbow")
```

`app.add_middleware()` empf√§ngt eine Middleware-Klasse als erstes Argument und dann alle weiteren Argumente, die an die Middleware √ºbergeben werden sollen.

## Integrierte Middleware

**FastAPI** enth√§lt mehrere Middlewares f√ºr g√§ngige Anwendungsf√§lle. Wir werden als N√§chstes sehen, wie man sie verwendet.

/// note | Technische Details

F√ºr die n√§chsten Beispiele k√∂nnten Sie auch `from starlette.middleware.something import SomethingMiddleware` verwenden.

**FastAPI** bietet mehrere Middlewares via `fastapi.middleware` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Die meisten verf√ºgbaren Middlewares kommen aber direkt von Starlette.

///

## `HTTPSRedirectMiddleware`

Erzwingt, dass alle eingehenden Requests entweder `https` oder `wss` sein m√ºssen.

Alle eingehenden Requests an `http` oder `ws` werden stattdessen an das sichere Schema umgeleitet.

{* ../../docs_src/advanced_middleware/tutorial001.py hl[2,6] *}

## `TrustedHostMiddleware`

Erzwingt, dass alle eingehenden Requests einen korrekt gesetzten `Host`-Header haben, um sich vor HTTP-Host-Header-Angriffen zu sch√ºtzen.

{* ../../docs_src/advanced_middleware/tutorial002.py hl[2,6:8] *}

Die folgenden Argumente werden unterst√ºtzt:

* `allowed_hosts` ‚Äì Eine Liste von Domain-Namen, die als Hostnamen zul√§ssig sein sollten. Wildcard-Domains wie `*.example.com` werden unterst√ºtzt, um Subdomains zu matchen. Um jeden Hostnamen zu erlauben, verwenden Sie entweder `allowed_hosts=["*"]` oder lassen Sie diese Middleware weg.

Wenn ein eingehender Request nicht korrekt validiert wird, wird eine ‚Äû400‚Äú-Response gesendet.

## `GZipMiddleware`

Verarbeitet GZip-Responses f√ºr alle Requests, die `"gzip"` im `Accept-Encoding`-Header enthalten.

Diese Middleware verarbeitet sowohl Standard- als auch Streaming-Responses.

{* ../../docs_src/advanced_middleware/tutorial003.py hl[2,6] *}

Die folgenden Argumente werden unterst√ºtzt:

* `minimum_size` ‚Äì Antworten, die kleiner als diese Mindestgr√∂√üe in Bytes sind, nicht per GZip komprimieren. Der Defaultwert ist `500`.

## Andere Middlewares

Es gibt viele andere ASGI-Middlewares.

Zum Beispiel:

* <a href="https://github.com/encode/uvicorn/blob/master/uvicorn/middleware/proxy_headers.py" class="external-link" target="_blank">Uvicorns `ProxyHeadersMiddleware`</a>
* <a href="https://github.com/florimondmanca/msgpack-asgi" class="external-link" target="_blank">MessagePack</a>

Um mehr √ºber weitere verf√ºgbare Middlewares herauszufinden, besuchen Sie <a href="https://www.starlette.io/middleware/" class="external-link" target="_blank">Starlettes Middleware-Dokumentation</a> und die <a href="https://github.com/florimondmanca/awesome-asgi" class="external-link" target="_blank">ASGI Awesome List</a>.


================================================
File: /docs/de/docs/advanced/openapi-callbacks.md
================================================
# OpenAPI-Callbacks

Sie k√∂nnten eine API mit einer *Pfadoperation* erstellen, die einen Request an eine *externe API* ausl√∂sen k√∂nnte, welche von jemand anderem erstellt wurde (wahrscheinlich derselbe Entwickler, der Ihre API *verwenden* w√ºrde).

Der Vorgang, der stattfindet, wenn Ihre API-Anwendung die *externe API* aufruft, wird als ‚ÄûCallback‚Äú (‚ÄûR√ºckruf‚Äú) bezeichnet. Denn die Software, die der externe Entwickler geschrieben hat, sendet einen Request an Ihre API und dann *ruft Ihre API zur√ºck* (*calls back*) und sendet einen Request an eine *externe API* (die wahrscheinlich vom selben Entwickler erstellt wurde).

In diesem Fall m√∂chten Sie m√∂glicherweise dokumentieren, wie diese externe API aussehen *sollte*. Welche *Pfadoperation* sie haben sollte, welchen Body sie erwarten sollte, welche Response sie zur√ºckgeben sollte, usw.

## Eine Anwendung mit Callbacks

Sehen wir uns das alles anhand eines Beispiels an.

Stellen Sie sich vor, Sie entwickeln eine Anwendung, mit der Sie Rechnungen erstellen k√∂nnen.

Diese Rechnungen haben eine `id`, einen optionalen `title`, einen `customer` (Kunde) und ein `total` (Gesamtsumme).

Der Benutzer Ihrer API (ein externer Entwickler) erstellt mit einem POST-Request eine Rechnung in Ihrer API.

Dann wird Ihre API (beispielsweise):

* die Rechnung an einen Kunden des externen Entwicklers senden.
* das Geld einsammeln.
* eine Benachrichtigung an den API-Benutzer (den externen Entwickler) zur√ºcksenden.
    * Dies erfolgt durch Senden eines POST-Requests (von *Ihrer API*) an eine *externe API*, die von diesem externen Entwickler bereitgestellt wird (das ist der ‚ÄûCallback‚Äú).

## Die normale **FastAPI**-Anwendung

Sehen wir uns zun√§chst an, wie die normale API-Anwendung aussehen w√ºrde, bevor wir den Callback hinzuf√ºgen.

Sie verf√ºgt √ºber eine *Pfadoperation*, die einen `Invoice`-Body empf√§ngt, und einen Query-Parameter `callback_url`, der die URL f√ºr den Callback enth√§lt.

Dieser Teil ist ziemlich normal, der gr√∂√üte Teil des Codes ist Ihnen wahrscheinlich bereits bekannt:

{* ../../docs_src/openapi_callbacks/tutorial001.py hl[9:13,36:53] *}

/// tip | Tipp

Der Query-Parameter `callback_url` verwendet einen Pydantic-<a href="https://docs.pydantic.dev/latest/api/networks/" class="external-link" target="_blank">Url</a>-Typ.

///

Das einzig Neue ist `callbacks=invoices_callback_router.routes` als Argument f√ºr den *Pfadoperation-Dekorator*. Wir werden als N√§chstes sehen, was das ist.

## Dokumentation des Callbacks

Der tats√§chliche Callback-Code h√§ngt stark von Ihrer eigenen API-Anwendung ab.

Und er wird wahrscheinlich von Anwendung zu Anwendung sehr unterschiedlich sein.

Es k√∂nnten nur eine oder zwei Codezeilen sein, wie zum Beispiel:

```Python
callback_url = "https://example.com/api/v1/invoices/events/"
httpx.post(callback_url, json={"description": "Invoice paid", "paid": True})
```

Der m√∂glicherweise wichtigste Teil des Callbacks besteht jedoch darin, sicherzustellen, dass Ihr API-Benutzer (der externe Entwickler) die *externe API* gem√§√ü den Daten, die *Ihre API* im Requestbody des Callbacks senden wird, korrekt implementiert, usw.

Als N√§chstes f√ºgen wir den Code hinzu, um zu dokumentieren, wie diese *externe API* aussehen sollte, um den Callback von *Ihrer API* zu empfangen.

Diese Dokumentation wird in der Swagger-Oberfl√§che unter `/docs` in Ihrer API angezeigt und zeigt externen Entwicklern, wie diese die *externe API* erstellen sollten.

In diesem Beispiel wird nicht der Callback selbst implementiert (das k√∂nnte nur eine Codezeile sein), sondern nur der Dokumentationsteil.

/// tip | Tipp

Der eigentliche Callback ist nur ein HTTP-Request.

Wenn Sie den Callback selbst implementieren, k√∂nnen Sie beispielsweise <a href="https://www.python-httpx.org" class="external-link" target="_blank">HTTPX</a> oder <a href="https://requests.readthedocs.io/" class="external-link" target="_blank">Requests</a> verwenden.

///

## Schreiben des Codes, der den Callback dokumentiert

Dieser Code wird nicht in Ihrer Anwendung ausgef√ºhrt, wir ben√∂tigen ihn nur, um zu *dokumentieren*, wie diese *externe API* aussehen soll.

Sie wissen jedoch bereits, wie Sie mit **FastAPI** ganz einfach eine automatische Dokumentation f√ºr eine API erstellen.

Daher werden wir dasselbe Wissen nutzen, um zu dokumentieren, wie die *externe API* aussehen sollte ... indem wir die *Pfadoperation(en)* erstellen, welche die externe API implementieren soll (die, welche Ihre API aufruft).

/// tip | Tipp

Wenn Sie den Code zum Dokumentieren eines Callbacks schreiben, kann es hilfreich sein, sich vorzustellen, dass Sie dieser *externe Entwickler* sind. Und dass Sie derzeit die *externe API* implementieren, nicht *Ihre API*.

Wenn Sie diese Sichtweise (des *externen Entwicklers*) vor√ºbergehend √ºbernehmen, wird es offensichtlicher, wo die Parameter, das Pydantic-Modell f√ºr den Body, die Response, usw. f√ºr diese *externe API* hingeh√∂ren.

///

### Einen Callback-`APIRouter` erstellen

Erstellen Sie zun√§chst einen neuen `APIRouter`, der einen oder mehrere Callbacks enth√§lt.

{* ../../docs_src/openapi_callbacks/tutorial001.py hl[3,25] *}

### Die Callback-*Pfadoperation* erstellen

Um die Callback-*Pfadoperation* zu erstellen, verwenden Sie denselben `APIRouter`, den Sie oben erstellt haben.

Sie sollte wie eine normale FastAPI-*Pfadoperation* aussehen:

* Sie sollte wahrscheinlich eine Deklaration des Bodys enthalten, die sie erhalten soll, z. B. `body: InvoiceEvent`.
* Und sie k√∂nnte auch eine Deklaration der Response enthalten, die zur√ºckgegeben werden soll, z. B. `response_model=InvoiceEventReceived`.

{* ../../docs_src/openapi_callbacks/tutorial001.py hl[16:18,21:22,28:32] *}

Es gibt zwei Hauptunterschiede zu einer normalen *Pfadoperation*:

* Es muss kein tats√§chlicher Code vorhanden sein, da Ihre Anwendung diesen Code niemals aufruft. Sie wird nur zur Dokumentation der *externen API* verwendet. Die Funktion k√∂nnte also einfach `pass` enthalten.
* Der *Pfad* kann einen <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.1.0.md#key-expression" class="external-link" target="_blank">OpenAPI-3-Ausdruck</a> enthalten (mehr dazu weiter unten), wo er Variablen mit Parametern und Teilen des urspr√ºnglichen Requests verwenden kann, der an *Ihre API* gesendet wurde.

### Der Callback-Pfadausdruck

Der Callback-*Pfad* kann einen <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.1.0.md#key-expression" class="external-link" target="_blank">OpenAPI-3-Ausdruck</a> enthalten, welcher Teile des urspr√ºnglichen Requests enthalten kann, der an *Ihre API* gesendet wurde.

In diesem Fall ist es der `str`:

```Python
"{$callback_url}/invoices/{$request.body.id}"
```

Wenn Ihr API-Benutzer (der externe Entwickler) also einen Request an *Ihre API* sendet, via:

```
https://yourapi.com/invoices/?callback_url=https://www.external.org/events
```

mit einem JSON-K√∂rper:

```JSON
{
    "id": "2expen51ve",
    "customer": "Mr. Richie Rich",
    "total": "9999"
}
```

dann verarbeitet *Ihre API* die Rechnung und sendet irgendwann sp√§ter einen Callback-Request an die `callback_url` (die *externe API*):

```
https://www.external.org/events/invoices/2expen51ve
```

mit einem JSON-Body, der etwa Folgendes enth√§lt:

```JSON
{
    "description": "Payment celebration",
    "paid": true
}
```

und sie w√ºrde eine Response von dieser *externen API* mit einem JSON-Body wie dem folgenden erwarten:

```JSON
{
    "ok": true
}
```

/// tip | Tipp

Beachten Sie, dass die verwendete Callback-URL die URL enth√§lt, die als Query-Parameter in `callback_url` (`https://www.external.org/events`) empfangen wurde, und auch die Rechnungs-`id` aus dem JSON-Body (`2expen51ve`).

///

### Den Callback-Router hinzuf√ºgen

An diesem Punkt haben Sie die ben√∂tigte(n) *Callback-Pfadoperation(en)* (diejenige(n), die der *externe Entwickler* in der *externen API* implementieren sollte) im Callback-Router, den Sie oben erstellt haben.

Verwenden Sie nun den Parameter `callbacks` im *Pfadoperation-Dekorator Ihrer API*, um das Attribut `.routes` (das ist eigentlich nur eine `list`e von Routen/*Pfadoperationen*) dieses Callback-Routers zu √ºbergeben:

{* ../../docs_src/openapi_callbacks/tutorial001.py hl[35] *}

/// tip | Tipp

Beachten Sie, dass Sie nicht den Router selbst (`invoices_callback_router`) an `callback=` √ºbergeben, sondern das Attribut `.routes`, wie in `invoices_callback_router.routes`.

///

### Es in der Dokumentation ansehen

Jetzt k√∂nnen Sie Ihre Anwendung mit Uvicorn starten und auf <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> gehen.

Sie sehen Ihre Dokumentation, einschlie√ülich eines Abschnitts ‚ÄûCallbacks‚Äú f√ºr Ihre *Pfadoperation*, der zeigt, wie die *externe API* aussehen sollte:

<img src="/img/tutorial/openapi-callbacks/image01.png">


================================================
File: /docs/de/docs/advanced/openapi-webhooks.md
================================================
# OpenAPI-Webhooks

Es gibt F√§lle, in denen Sie Ihren API-Benutzern mitteilen m√∂chten, dass Ihre Anwendung mit einigen Daten *deren* Anwendung aufrufen (ein Request senden) k√∂nnte, normalerweise um √ºber ein bestimmtes **Event** zu **benachrichtigen**.

Das bedeutet, dass anstelle des normalen Prozesses, bei dem Benutzer Requests an Ihre API senden, **Ihre API** (oder Ihre Anwendung) **Requests an deren System** (an deren API, deren Anwendung) senden k√∂nnte.

Das wird normalerweise als **Webhook** bezeichnet.

## Webhooks-Schritte

Der Prozess besteht normalerweise darin, dass **Sie in Ihrem Code definieren**, welche Nachricht Sie senden m√∂chten, den **Body des Requests**.

Sie definieren auch auf irgendeine Weise, zu welchen **Momenten** Ihre Anwendung diese Requests oder Events sendet.

Und **Ihre Benutzer** definieren auf irgendeine Weise (zum Beispiel irgendwo in einem Web-Dashboard) die **URL**, an die Ihre Anwendung diese Requests senden soll.

Die gesamte **Logik** zur Registrierung der URLs f√ºr Webhooks und der Code zum tats√§chlichen Senden dieser Requests liegt bei Ihnen. Sie schreiben es so, wie Sie m√∂chten, in **Ihrem eigenen Code**.

## Webhooks mit **FastAPI** und OpenAPI dokumentieren

Mit **FastAPI** k√∂nnen Sie mithilfe von OpenAPI die Namen dieser Webhooks, die Arten von HTTP-Operationen, die Ihre Anwendung senden kann (z. B. `POST`, `PUT`, usw.) und die Request**bodys** definieren, die Ihre Anwendung senden w√ºrde.

Dies kann es Ihren Benutzern viel einfacher machen, **deren APIs zu implementieren**, um Ihre **Webhook**-Requests zu empfangen. M√∂glicherweise k√∂nnen diese sogar einen Teil des eigenem API-Codes automatisch generieren.

/// info

Webhooks sind in OpenAPI 3.1.0 und h√∂her verf√ºgbar und werden von FastAPI `0.99.0` und h√∂her unterst√ºtzt.

///

## Eine Anwendung mit Webhooks

Wenn Sie eine **FastAPI**-Anwendung erstellen, gibt es ein `webhooks`-Attribut, mit dem Sie *Webhooks* definieren k√∂nnen, genauso wie Sie *Pfadoperationen* definieren w√ºrden, zum Beispiel mit `@app.webhooks.post()`.

{* ../../docs_src/openapi_webhooks/tutorial001.py hl[9:13,36:53] *}

Die von Ihnen definierten Webhooks landen im **OpenAPI**-Schema und der automatischen **Dokumentations-Oberfl√§che**.

/// info

Das `app.webhooks`-Objekt ist eigentlich nur ein `APIRouter`, derselbe Typ, den Sie verwenden w√ºrden, wenn Sie Ihre Anwendung mit mehreren Dateien strukturieren.

///

Beachten Sie, dass Sie bei Webhooks tats√§chlich keinen *Pfad* (wie `/items/`) deklarieren, sondern dass der Text, den Sie dort √ºbergeben, lediglich eine **Kennzeichnung** des Webhooks (der Name des Events) ist. Zum Beispiel ist in `@app.webhooks.post("new-subscription")` der Webhook-Name `new-subscription`.

Das liegt daran, dass erwartet wird, dass **Ihre Benutzer** den tats√§chlichen **URL-Pfad**, an dem diese den Webhook-Request empfangen m√∂chten, auf andere Weise definieren (z. B. √ºber ein Web-Dashboard).

### Es in der Dokumentation ansehen

Jetzt k√∂nnen Sie Ihre Anwendung mit Uvicorn starten und auf <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> gehen.

Sie werden sehen, dass Ihre Dokumentation die normalen *Pfadoperationen* und jetzt auch einige **Webhooks** enth√§lt:

<img src="/img/tutorial/openapi-webhooks/image01.png">


================================================
File: /docs/de/docs/advanced/path-operation-advanced-configuration.md
================================================
# Fortgeschrittene Konfiguration der Pfadoperation

## OpenAPI operationId

/// warning | Achtung

Wenn Sie kein ‚ÄûExperte‚Äú f√ºr OpenAPI sind, brauchen Sie dies wahrscheinlich nicht.

///

Mit dem Parameter `operation_id` k√∂nnen Sie die OpenAPI `operationId` festlegen, die in Ihrer *Pfadoperation* verwendet werden soll.

Sie m√ºssten sicherstellen, dass sie f√ºr jede Operation eindeutig ist.

{* ../../docs_src/path_operation_advanced_configuration/tutorial001.py hl[6] *}

### Verwendung des Namens der *Pfadoperation-Funktion* als operationId

Wenn Sie die Funktionsnamen Ihrer API als `operationId`s verwenden m√∂chten, k√∂nnen Sie √ºber alle iterieren und die `operation_id` jeder *Pfadoperation* mit deren `APIRoute.name` √ºberschreiben.

Sie sollten dies tun, nachdem Sie alle Ihre *Pfadoperationen* hinzugef√ºgt haben.

{* ../../docs_src/path_operation_advanced_configuration/tutorial002.py hl[2,12:21,24] *}

/// tip | Tipp

Wenn Sie `app.openapi()` manuell aufrufen, sollten Sie vorher die `operationId`s aktualisiert haben.

///

/// warning | Achtung

Wenn Sie dies tun, m√ºssen Sie sicherstellen, dass jede Ihrer *Pfadoperation-Funktionen* einen eindeutigen Namen hat.

Auch wenn diese sich in unterschiedlichen Modulen (Python-Dateien) befinden.

///

## Von OpenAPI ausschlie√üen

Um eine *Pfadoperation* aus dem generierten OpenAPI-Schema (und damit aus den automatischen Dokumentationssystemen) auszuschlie√üen, verwenden Sie den Parameter `include_in_schema` und setzen Sie ihn auf `False`:

{* ../../docs_src/path_operation_advanced_configuration/tutorial003.py hl[6] *}

## Fortgeschrittene Beschreibung mittels Docstring

Sie k√∂nnen die verwendeten Zeilen aus dem Docstring einer *Pfadoperation-Funktion* einschr√§nken, die f√ºr OpenAPI verwendet werden.

Das Hinzuf√ºgen eines `\f` (ein maskiertes ‚ÄûForm Feed‚Äú-Zeichen) f√ºhrt dazu, dass **FastAPI** die f√ºr OpenAPI verwendete Ausgabe an dieser Stelle abschneidet.

Sie wird nicht in der Dokumentation angezeigt, aber andere Tools (z. B. Sphinx) k√∂nnen den Rest verwenden.

{* ../../docs_src/path_operation_advanced_configuration/tutorial004.py hl[19:29] *}

## Zus√§tzliche Responses

Sie haben wahrscheinlich gesehen, wie man das `response_model` und den `status_code` f√ºr eine *Pfadoperation* deklariert.

Das definiert die Metadaten der Haupt-Response einer *Pfadoperation*.

Sie k√∂nnen auch zus√§tzliche Responses mit deren Modellen, Statuscodes usw. deklarieren.

Es gibt hier in der Dokumentation ein ganzes Kapitel dar√ºber, Sie k√∂nnen es unter [Zus√§tzliche Responses in OpenAPI](additional-responses.md){.internal-link target=_blank} lesen.

## OpenAPI-Extra

Wenn Sie in Ihrer Anwendung eine *Pfadoperation* deklarieren, generiert **FastAPI** automatisch die relevanten Metadaten dieser *Pfadoperation*, die in das OpenAPI-Schema aufgenommen werden sollen.

/// note | Technische Details

In der OpenAPI-Spezifikation wird das <a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.3.md#operation-object" class="external-link" target="_blank">Operationsobjekt</a> genannt.

///

Es hat alle Informationen zur *Pfadoperation* und wird zur Erstellung der automatischen Dokumentation verwendet.

Es enth√§lt `tags`, `parameters`, `requestBody`, `responses`, usw.

Dieses *Pfadoperation*-spezifische OpenAPI-Schema wird normalerweise automatisch von **FastAPI** generiert, Sie k√∂nnen es aber auch erweitern.

/// tip | Tipp

Dies ist ein Low-Level Erweiterungspunkt.

Wenn Sie nur zus√§tzliche Responses deklarieren m√ºssen, k√∂nnen Sie dies bequemer mit [Zus√§tzliche Responses in OpenAPI](additional-responses.md){.internal-link target=_blank} tun.

///

Sie k√∂nnen das OpenAPI-Schema f√ºr eine *Pfadoperation* erweitern, indem Sie den Parameter `openapi_extra` verwenden.

### OpenAPI-Erweiterungen

Dieses `openapi_extra` kann beispielsweise hilfreich sein, um <a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.3.md#specificationExtensions" class="external-link" target="_blank">OpenAPI-Erweiterungen</a> zu deklarieren:

{* ../../docs_src/path_operation_advanced_configuration/tutorial005.py hl[6] *}

Wenn Sie die automatische API-Dokumentation √∂ffnen, wird Ihre Erweiterung am Ende der spezifischen *Pfadoperation* angezeigt.

<img src="/img/tutorial/path-operation-advanced-configuration/image01.png">

Und wenn Sie die resultierende OpenAPI sehen (unter `/openapi.json` in Ihrer API), sehen Sie Ihre Erweiterung auch als Teil der spezifischen *Pfadoperation*:

```JSON hl_lines="22"
{
    "openapi": "3.1.0",
    "info": {
        "title": "FastAPI",
        "version": "0.1.0"
    },
    "paths": {
        "/items/": {
            "get": {
                "summary": "Read Items",
                "operationId": "read_items_items__get",
                "responses": {
                    "200": {
                        "description": "Successful Response",
                        "content": {
                            "application/json": {
                                "schema": {}
                            }
                        }
                    }
                },
                "x-aperture-labs-portal": "blue"
            }
        }
    }
}
```

### Benutzerdefiniertes OpenAPI-*Pfadoperation*-Schema

Das Dictionary in `openapi_extra` wird mit dem automatisch generierten OpenAPI-Schema f√ºr die *Pfadoperation* zusammengef√ºhrt (mittels Deep Merge).

Sie k√∂nnen dem automatisch generierten Schema also zus√§tzliche Daten hinzuf√ºgen.

Sie k√∂nnten sich beispielsweise daf√ºr entscheiden, den Request mit Ihrem eigenen Code zu lesen und zu validieren, ohne die automatischen Funktionen von FastAPI mit Pydantic zu verwenden, aber Sie k√∂nnten den Request trotzdem im OpenAPI-Schema definieren wollen.

Das k√∂nnte man mit `openapi_extra` machen:

{* ../../docs_src/path_operation_advanced_configuration/tutorial006.py hl[20:37,39:40] *}

In diesem Beispiel haben wir kein Pydantic-Modell deklariert. Tats√§chlich wird der Requestbody nicht einmal als JSON <abbr title="von einem einfachen Format, wie Bytes, in Python-Objekte konvertieren">geparst</abbr>, sondern direkt als `bytes` gelesen und die Funktion `magic_data_reader ()` w√§re daf√ºr verantwortlich, ihn in irgendeiner Weise zu parsen.

Dennoch k√∂nnen wir das zu erwartende Schema f√ºr den Requestbody deklarieren.

### Benutzerdefinierter OpenAPI-Content-Type

Mit demselben Trick k√∂nnten Sie ein Pydantic-Modell verwenden, um das JSON-Schema zu definieren, das dann im benutzerdefinierten Abschnitt des OpenAPI-Schemas f√ºr die *Pfadoperation* enthalten ist.

Und Sie k√∂nnten dies auch tun, wenn der Datentyp in der Anfrage nicht JSON ist.

In der folgenden Anwendung verwenden wir beispielsweise weder die integrierte Funktionalit√§t von FastAPI zum Extrahieren des JSON-Schemas aus Pydantic-Modellen noch die automatische Validierung f√ºr JSON. Tats√§chlich deklarieren wir den Request-Content-Type als YAML und nicht als JSON:

//// tab | Pydantic v2

{* ../../docs_src/path_operation_advanced_configuration/tutorial007.py hl[17:22,24] *}

////

//// tab | Pydantic v1

{* ../../docs_src/path_operation_advanced_configuration/tutorial007_pv1.py hl[17:22,24] *}

////

/// info

In Pydantic Version 1 hie√ü die Methode zum Abrufen des JSON-Schemas f√ºr ein Modell `Item.schema()`, in Pydantic Version 2 hei√üt die Methode `Item.model_json_schema()`.

///

Obwohl wir nicht die standardm√§√üig integrierte Funktionalit√§t verwenden, verwenden wir dennoch ein Pydantic-Modell, um das JSON-Schema f√ºr die Daten, die wir in YAML empfangen m√∂chten, manuell zu generieren.

Dann verwenden wir den Request direkt und extrahieren den Body als `bytes`. Das bedeutet, dass FastAPI nicht einmal versucht, den Request-Payload als JSON zu parsen.

Und dann parsen wir in unserem Code diesen YAML-Inhalt direkt und verwenden dann wieder dasselbe Pydantic-Modell, um den YAML-Inhalt zu validieren:

//// tab | Pydantic v2

{* ../../docs_src/path_operation_advanced_configuration/tutorial007.py hl[26:33] *}

////

//// tab | Pydantic v1

{* ../../docs_src/path_operation_advanced_configuration/tutorial007_pv1.py hl[26:33] *}

////

/// info

In Pydantic Version 1 war die Methode zum Parsen und Validieren eines Objekts `Item.parse_obj()`, in Pydantic Version 2 hei√üt die Methode `Item.model_validate()`.

///

/// tip | Tipp

Hier verwenden wir dasselbe Pydantic-Modell wieder.

Aber genauso h√§tten wir es auch auf andere Weise validieren k√∂nnen.

///


================================================
File: /docs/de/docs/advanced/response-change-status-code.md
================================================
# Response ‚Äì Statuscode √§ndern

Sie haben wahrscheinlich schon vorher gelesen, dass Sie einen Standard-[Response-Statuscode](../tutorial/response-status-code.md){.internal-link target=_blank} festlegen k√∂nnen.

In manchen F√§llen m√ºssen Sie jedoch einen anderen als den Standard-Statuscode zur√ºckgeben.

## Anwendungsfall

Stellen Sie sich zum Beispiel vor, Sie m√∂chten standardm√§√üig den HTTP-Statuscode ‚ÄûOK‚Äú `200` zur√ºckgeben.

Wenn die Daten jedoch nicht vorhanden waren, m√∂chten Sie diese erstellen und den HTTP-Statuscode ‚ÄûCREATED‚Äú `201` zur√ºckgeben.

Sie m√∂chten aber dennoch in der Lage sein, die von Ihnen zur√ºckgegebenen Daten mit einem `response_model` zu filtern und zu konvertieren.

In diesen F√§llen k√∂nnen Sie einen `Response`-Parameter verwenden.

## Einen `Response`-Parameter verwenden

Sie k√∂nnen einen Parameter vom Typ `Response` in Ihrer *Pfadoperation-Funktion* deklarieren (wie Sie es auch f√ºr Cookies und Header tun k√∂nnen).

Anschlie√üend k√∂nnen Sie den `status_code` in diesem *vor√ºbergehenden* Response-Objekt festlegen.

{* ../../docs_src/response_change_status_code/tutorial001.py hl[1,9,12] *}

Und dann k√∂nnen Sie wie gewohnt jedes ben√∂tigte Objekt zur√ºckgeben (ein `dict`, ein Datenbankmodell usw.).

Und wenn Sie ein `response_model` deklariert haben, wird es weiterhin zum Filtern und Konvertieren des von Ihnen zur√ºckgegebenen Objekts verwendet.

**FastAPI** verwendet diese *vor√ºbergehende* Response, um den Statuscode (auch Cookies und Header) zu extrahieren und f√ºgt diese in die endg√ºltige Response ein, die den von Ihnen zur√ºckgegebenen Wert enth√§lt, gefiltert nach einem beliebigen `response_model`.

Sie k√∂nnen den Parameter `Response` auch in Abh√§ngigkeiten deklarieren und den Statuscode darin festlegen. Bedenken Sie jedoch, dass der gewinnt, welcher zuletzt gesetzt wird.


================================================
File: /docs/de/docs/advanced/response-cookies.md
================================================
# Response-Cookies

## Einen `Response`-Parameter verwenden

Sie k√∂nnen einen Parameter vom Typ `Response` in Ihrer *Pfadoperation-Funktion* deklarieren.

Und dann k√∂nnen Sie Cookies in diesem *vor√ºbergehenden* Response-Objekt setzen.

{* ../../docs_src/response_cookies/tutorial002.py hl[1,8:9] *}

Anschlie√üend k√∂nnen Sie wie gewohnt jedes gew√ºnschte Objekt zur√ºckgeben (ein `dict`, ein Datenbankmodell, usw.).

Und wenn Sie ein `response_model` deklariert haben, wird es weiterhin zum Filtern und Konvertieren des von Ihnen zur√ºckgegebenen Objekts verwendet.

**FastAPI** verwendet diese *vor√ºbergehende* Response, um die Cookies (auch Header und Statuscode) zu extrahieren und f√ºgt diese in die endg√ºltige Response ein, die den von Ihnen zur√ºckgegebenen Wert enth√§lt, gefiltert nach einem beliebigen `response_model`.

Sie k√∂nnen den `Response`-Parameter auch in Abh√§ngigkeiten deklarieren und darin Cookies (und Header) setzen.

## Eine `Response` direkt zur√ºckgeben

Sie k√∂nnen Cookies auch erstellen, wenn Sie eine `Response` direkt in Ihrem Code zur√ºckgeben.

Dazu k√∂nnen Sie eine Response erstellen, wie unter [Eine Response direkt zur√ºckgeben](response-directly.md){.internal-link target=_blank} beschrieben.

Setzen Sie dann Cookies darin und geben Sie sie dann zur√ºck:

{* ../../docs_src/response_cookies/tutorial001.py hl[10:12] *}

/// tip | Tipp

Beachten Sie, dass, wenn Sie eine Response direkt zur√ºckgeben, anstatt den `Response`-Parameter zu verwenden, FastAPI diese direkt zur√ºckgibt.

Sie m√ºssen also sicherstellen, dass Ihre Daten vom richtigen Typ sind. Z. B. sollten diese mit JSON kompatibel sein, wenn Sie eine `JSONResponse` zur√ºckgeben.

Und auch, dass Sie keine Daten senden, die durch ein `response_model` h√§tten gefiltert werden sollen.

///

### Mehr Informationen

/// note | Technische Details

Sie k√∂nnen auch `from starlette.responses import Response` oder `from starlette.responses import JSONResponse` verwenden.

**FastAPI** bietet dieselben `starlette.responses` auch via `fastapi.responses` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Die meisten verf√ºgbaren Responses kommen aber direkt von Starlette.

Und da die `Response` h√§ufig zum Setzen von Headern und Cookies verwendet wird, stellt **FastAPI** diese auch unter `fastapi.Response` bereit.

///

Um alle verf√ºgbaren Parameter und Optionen anzuzeigen, sehen Sie sich deren <a href="https://www.starlette.io/responses/#set-cookie" class="external-link" target="_blank">Dokumentation in Starlette</a> an.


================================================
File: /docs/de/docs/advanced/response-directly.md
================================================
# Eine Response direkt zur√ºckgeben

Wenn Sie eine **FastAPI** *Pfadoperation* erstellen, k√∂nnen Sie normalerweise beliebige Daten davon zur√ºckgeben: ein `dict`, eine `list`e, ein Pydantic-Modell, ein Datenbankmodell, usw.

Standardm√§√üig konvertiert **FastAPI** diesen R√ºckgabewert automatisch nach JSON, mithilfe des `jsonable_encoder`, der in [JSON-kompatibler Encoder](../tutorial/encoder.md){.internal-link target=_blank} erl√§utert wird.

Dann w√ºrde es hinter den Kulissen diese JSON-kompatiblen Daten (z. B. ein `dict`) in eine `JSONResponse` einf√ºgen, die zum Senden der Response an den Client verwendet w√ºrde.

Sie k√∂nnen jedoch direkt eine `JSONResponse` von Ihren *Pfadoperationen* zur√ºckgeben.

Das kann beispielsweise n√ºtzlich sein, um benutzerdefinierte Header oder Cookies zur√ºckzugeben.

## Eine `Response` zur√ºckgeben

Tats√§chlich k√∂nnen Sie jede `Response` oder jede Unterklasse davon zur√ºckgeben.

/// tip | Tipp

`JSONResponse` selbst ist eine Unterklasse von `Response`.

///

Und wenn Sie eine `Response` zur√ºckgeben, wird **FastAPI** diese direkt weiterleiten.

Es wird keine Datenkonvertierung mit Pydantic-Modellen durchf√ºhren, es wird den Inhalt nicht in irgendeinen Typ konvertieren, usw.

Dadurch haben Sie viel Flexibilit√§t. Sie k√∂nnen jeden Datentyp zur√ºckgeben, jede Datendeklaration oder -validierung √ºberschreiben, usw.

## Verwendung des `jsonable_encoder` in einer `Response`

Da **FastAPI** keine √Ñnderungen an einer von Ihnen zur√ºckgegebenen `Response` vornimmt, m√ºssen Sie sicherstellen, dass deren Inhalt daf√ºr bereit ist.

Sie k√∂nnen beispielsweise kein Pydantic-Modell in eine `JSONResponse` einf√ºgen, ohne es zuvor in ein `dict` zu konvertieren, bei dem alle Datentypen (wie `datetime`, `UUID`, usw.) in JSON-kompatible Typen konvertiert wurden.

In diesen F√§llen k√∂nnen Sie den `jsonable_encoder` verwenden, um Ihre Daten zu konvertieren, bevor Sie sie an eine Response √ºbergeben:

{* ../../docs_src/response_directly/tutorial001.py hl[6:7,21:22] *}

/// note | Technische Details

Sie k√∂nnen auch `from starlette.responses import JSONResponse` verwenden.

**FastAPI** bietet dieselben `starlette.responses` auch via `fastapi.responses` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Die meisten verf√ºgbaren Responses kommen aber direkt von Starlette.

///

## Eine benutzerdefinierte `Response` zur√ºckgeben

Das obige Beispiel zeigt alle Teile, die Sie ben√∂tigen, ist aber noch nicht sehr n√ºtzlich, da Sie das `item` einfach direkt h√§tten zur√ºckgeben k√∂nnen, und **FastAPI** w√ºrde es f√ºr Sie in eine `JSONResponse` einf√ºgen, es in ein `dict` konvertieren, usw. All das standardm√§√üig.

Sehen wir uns nun an, wie Sie damit eine benutzerdefinierte Response zur√ºckgeben k√∂nnen.

Nehmen wir an, Sie m√∂chten eine <a href="https://en.wikipedia.org/wiki/XML" class="external-link" target="_blank">XML</a>-Response zur√ºckgeben.

Sie k√∂nnten Ihren XML-Inhalt als String in eine `Response` einf√ºgen und sie zur√ºckgeben:

{* ../../docs_src/response_directly/tutorial002.py hl[1,18] *}

## Anmerkungen

Wenn Sie eine `Response` direkt zur√ºcksenden, werden deren Daten weder validiert, konvertiert (serialisiert), noch automatisch dokumentiert.

Sie k√∂nnen sie aber trotzdem wie unter [Zus√§tzliche Responses in OpenAPI](additional-responses.md){.internal-link target=_blank} beschrieben dokumentieren.

In sp√§teren Abschnitten erfahren Sie, wie Sie diese benutzerdefinierten `Response`s verwenden/deklarieren und gleichzeitig √ºber automatische Datenkonvertierung, Dokumentation, usw. verf√ºgen.


================================================
File: /docs/de/docs/advanced/response-headers.md
================================================
# Response-Header

## Verwenden Sie einen `Response`-Parameter

Sie k√∂nnen einen Parameter vom Typ `Response` in Ihrer *Pfadoperation-Funktion* deklarieren (wie Sie es auch f√ºr Cookies tun k√∂nnen).

Und dann k√∂nnen Sie Header in diesem *vor√ºbergehenden* Response-Objekt festlegen.

{* ../../docs_src/response_headers/tutorial002.py hl[1,7:8] *}

Anschlie√üend k√∂nnen Sie wie gewohnt jedes gew√ºnschte Objekt zur√ºckgeben (ein `dict`, ein Datenbankmodell, usw.).

Und wenn Sie ein `response_model` deklariert haben, wird es weiterhin zum Filtern und Konvertieren des von Ihnen zur√ºckgegebenen Objekts verwendet.

**FastAPI** verwendet diese *vor√ºbergehende* Response, um die Header (auch Cookies und Statuscode) zu extrahieren und f√ºgt diese in die endg√ºltige Response ein, die den von Ihnen zur√ºckgegebenen Wert enth√§lt, gefiltert nach einem beliebigen `response_model`.

Sie k√∂nnen den Parameter `Response` auch in Abh√§ngigkeiten deklarieren und darin Header (und Cookies) festlegen.

## Eine `Response` direkt zur√ºckgeben

Sie k√∂nnen auch Header hinzuf√ºgen, wenn Sie eine `Response` direkt zur√ºckgeben.

Erstellen Sie eine Response wie in [Eine Response direkt zur√ºckgeben](response-directly.md){.internal-link target=_blank} beschrieben und √ºbergeben Sie die Header als zus√§tzlichen Parameter:

{* ../../docs_src/response_headers/tutorial001.py hl[10:12] *}

/// note | Technische Details

Sie k√∂nnen auch `from starlette.responses import Response` oder `from starlette.responses import JSONResponse` verwenden.

**FastAPI** bietet dieselben `starlette.responses` auch via `fastapi.responses` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Die meisten verf√ºgbaren Responses kommen aber direkt von Starlette.

Und da die `Response` h√§ufig zum Setzen von Headern und Cookies verwendet wird, stellt **FastAPI** diese auch unter `fastapi.Response` bereit.

///

## Benutzerdefinierte Header

Beachten Sie, dass benutzerdefinierte propriet√§re Header <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" class="external-link" target="_blank">mittels des Pr√§fix 'X-'</a> hinzugef√ºgt werden k√∂nnen.

Wenn Sie jedoch benutzerdefinierte Header haben, die ein Client in einem Browser sehen k√∂nnen soll, m√ºssen Sie diese zu Ihren CORS-Konfigurationen hinzuf√ºgen (weitere Informationen finden Sie unter [CORS (Cross-Origin Resource Sharing)](../tutorial/cors.md){.internal-link target=_blank}), unter Verwendung des Parameters `expose_headers`, dokumentiert in <a href="https://www.starlette.io/middleware/#corsmiddleware" class="external-link" target="_blank">Starlettes CORS-Dokumentation</a>.


================================================
File: /docs/de/docs/advanced/settings.md
================================================
# Einstellungen und Umgebungsvariablen

In vielen F√§llen ben√∂tigt Ihre Anwendung m√∂glicherweise einige externe Einstellungen oder Konfigurationen, zum Beispiel geheime Schl√ºssel, Datenbank-Anmeldeinformationen, Anmeldeinformationen f√ºr E-Mail-Dienste, usw.

Die meisten dieser Einstellungen sind variabel (k√∂nnen sich √§ndern), wie z. B. Datenbank-URLs. Und vieles k√∂nnten sch√ºtzenswerte, geheime Daten sein.

Aus diesem Grund werden diese √ºblicherweise in Umgebungsvariablen bereitgestellt, die von der Anwendung gelesen werden.

## Umgebungsvariablen

/// tip | Tipp

Wenn Sie bereits wissen, was ‚ÄûUmgebungsvariablen‚Äú sind und wie man sie verwendet, k√∂nnen Sie gerne mit dem n√§chsten Abschnitt weiter unten fortfahren.

///

Eine <a href="https://de.wikipedia.org/wiki/Umgebungsvariable" class="external-link" target="_blank">Umgebungsvariable</a> (auch bekannt als ‚Äûenv var‚Äú) ist eine Variable, die sich au√üerhalb des Python-Codes im Betriebssystem befindet und von Ihrem Python-Code (oder auch von anderen Programmen) gelesen werden kann.

Sie k√∂nnen Umgebungsvariablen in der Shell erstellen und verwenden, ohne Python zu ben√∂tigen:

//// tab | Linux, macOS, Windows Bash

<div class="termy">

```console
// Sie k√∂nnten eine Umgebungsvariable MY_NAME erstellen mittels
$ export MY_NAME="Wade Wilson"

// Dann k√∂nnten Sie diese mit anderen Programmen verwenden, etwa
$ echo "Hello $MY_NAME"

Hello Wade Wilson
```

</div>

////

//// tab | Windows PowerShell

<div class="termy">

```console
// Erstelle eine Umgebungsvariable MY_NAME
$ $Env:MY_NAME = "Wade Wilson"

// Verwende sie mit anderen Programmen, etwa
$ echo "Hello $Env:MY_NAME"

Hello Wade Wilson
```

</div>

////

### Umgebungsvariablen mit Python auslesen

Sie k√∂nnen Umgebungsvariablen auch au√üerhalb von Python im Terminal (oder mit einer anderen Methode) erstellen und diese dann mit Python auslesen.

Sie k√∂nnten zum Beispiel eine Datei `main.py` haben mit:

```Python hl_lines="3"
import os

name = os.getenv("MY_NAME", "World")
print(f"Hello {name} from Python")
```

/// tip | Tipp

Das zweite Argument f√ºr <a href="https://docs.python.org/3.8/library/os.html#os.getenv" class="external-link" target="_blank">`os.getenv()`</a> ist der zur√ºckzugebende Defaultwert.

Wenn nicht angegeben, ist er standardm√§√üig `None`. Hier √ºbergeben wir `"World"` als Defaultwert.

///

Dann k√∂nnten Sie dieses Python-Programm aufrufen:

<div class="termy">

```console
// Hier legen wir die Umgebungsvariable noch nicht fest
$ python main.py

// Da wir die Umgebungsvariable nicht festgelegt haben, erhalten wir den Standardwert

Hello World from Python

// Aber wenn wir zuerst eine Umgebungsvariable erstellen
$ export MY_NAME="Wade Wilson"

// Und dann das Programm erneut aufrufen
$ python main.py

// Kann es jetzt die Umgebungsvariable lesen

Hello Wade Wilson from Python
```

</div>

Da Umgebungsvariablen au√üerhalb des Codes festgelegt, aber vom Code gelesen werden k√∂nnen und nicht zusammen mit den √ºbrigen Dateien gespeichert (an `git` committet) werden m√ºssen, werden sie h√§ufig f√ºr Konfigurationen oder Einstellungen verwendet.

Sie k√∂nnen eine Umgebungsvariable auch nur f√ºr einen bestimmten Programmaufruf erstellen, die nur f√ºr dieses Programm und nur f√ºr dessen Dauer verf√ºgbar ist.

Erstellen Sie diese dazu direkt vor dem Programm selbst, in derselben Zeile:

<div class="termy">

```console
// Erstelle eine Umgebungsvariable MY_NAME inline f√ºr diesen Programmaufruf
$ MY_NAME="Wade Wilson" python main.py

// main.py kann jetzt diese Umgebungsvariable lesen

Hello Wade Wilson from Python

// Die Umgebungsvariable existiert danach nicht mehr
$ python main.py

Hello World from Python
```

</div>

/// tip | Tipp

Weitere Informationen dazu finden Sie unter <a href="https://12factor.net/config" class="external-link" target="_blank">The Twelve-Factor App: Config</a>.

///

### Typen und Validierung

Diese Umgebungsvariablen k√∂nnen nur Text-Zeichenketten verarbeiten, da sie au√üerhalb von Python liegen und mit anderen Programmen und dem Rest des Systems (und sogar mit verschiedenen Betriebssystemen wie Linux, Windows, macOS) kompatibel sein m√ºssen.

Das bedeutet, dass jeder in Python aus einer Umgebungsvariablen gelesene Wert ein `str` ist und jede Konvertierung in einen anderen Typ oder jede Validierung im Code erfolgen muss.

## Pydantic `Settings`

Gl√ºcklicherweise bietet Pydantic ein gro√üartiges Werkzeug zur Verarbeitung dieser Einstellungen, die von Umgebungsvariablen stammen, mit <a href="https://docs.pydantic.dev/latest/concepts/pydantic_settings/" class="external-link" target="_blank">Pydantic: Settings Management</a>.

### `pydantic-settings` installieren

Installieren Sie zun√§chst das Package `pydantic-settings`:

<div class="termy">

```console
$ pip install pydantic-settings
---> 100%
```

</div>

Es ist bereits enthalten, wenn Sie die `all`-Extras installiert haben, mit:

<div class="termy">

```console
$ pip install "fastapi[all]"
---> 100%
```

</div>

/// info

In Pydantic v1 war das im Hauptpackage enthalten. Jetzt wird es als unabh√§ngiges Package verteilt, sodass Sie w√§hlen k√∂nnen, ob Sie es installieren m√∂chten oder nicht, falls Sie die Funktionalit√§t nicht ben√∂tigen.

///

### Das `Settings`-Objekt erstellen

Importieren Sie `BaseSettings` aus Pydantic und erstellen Sie eine Unterklasse, ganz √§hnlich wie bei einem Pydantic-Modell.

Auf die gleiche Weise wie bei Pydantic-Modellen deklarieren Sie Klassenattribute mit Typannotationen und m√∂glicherweise Defaultwerten.

Sie k√∂nnen dieselben Validierungs-Funktionen und -Tools verwenden, die Sie f√ºr Pydantic-Modelle verwenden, z. B. verschiedene Datentypen und zus√§tzliche Validierungen mit `Field()`.

//// tab | Pydantic v2

{* ../../docs_src/settings/tutorial001.py hl[2,5:8,11] *}

////

//// tab | Pydantic v1

/// info

In Pydantic v1 w√ºrden Sie `BaseSettings` direkt von `pydantic` statt von `pydantic_settings` importieren.

///

{* ../../docs_src/settings/tutorial001_pv1.py hl[2,5:8,11] *}

////

/// tip | Tipp

F√ºr ein schnelles Copy-and-paste verwenden Sie nicht dieses Beispiel, sondern das letzte unten.

///

Wenn Sie dann eine Instanz dieser `Settings`-Klasse erstellen (in diesem Fall als `settings`-Objekt), liest Pydantic die Umgebungsvariablen ohne Ber√ºcksichtigung der Gro√ü- und Kleinschreibung. Eine Variable `APP_NAME` in Gro√übuchstaben wird also als Attribut `app_name` gelesen.

Als N√§chstes werden die Daten konvertiert und validiert. Wenn Sie also dieses `settings`-Objekt verwenden, verf√ºgen Sie √ºber Daten mit den von Ihnen deklarierten Typen (z. B. ist `items_per_user` ein `int`).

### `settings` verwenden

Dann k√∂nnen Sie das neue `settings`-Objekt in Ihrer Anwendung verwenden:

{* ../../docs_src/settings/tutorial001.py hl[18:20] *}

### Den Server ausf√ºhren

Als N√§chstes w√ºrden Sie den Server ausf√ºhren und die Konfigurationen als Umgebungsvariablen √ºbergeben. Sie k√∂nnten beispielsweise `ADMIN_EMAIL` und `APP_NAME` festlegen mit:

<div class="termy">

```console
$ ADMIN_EMAIL="deadpool@example.com" APP_NAME="ChimichangApp" uvicorn main:app

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

/// tip | Tipp

Um mehrere Umgebungsvariablen f√ºr einen einzelnen Befehl festzulegen, trennen Sie diese einfach durch ein Leerzeichen und f√ºgen Sie alle vor dem Befehl ein.

///

Und dann w√ºrde die Einstellung `admin_email` auf `"deadpool@example.com"` gesetzt.

Der `app_name` w√§re `"ChimichangApp"`.

Und `items_per_user` w√ºrde seinen Standardwert von `50` behalten.

## Einstellungen in einem anderen Modul

Sie k√∂nnten diese Einstellungen in eine andere Moduldatei einf√ºgen, wie Sie in [Gr√∂√üere Anwendungen ‚Äì mehrere Dateien](../tutorial/bigger-applications.md){.internal-link target=_blank} gesehen haben.

Sie k√∂nnten beispielsweise eine Datei `config.py` haben mit:

{* ../../docs_src/settings/app01/config.py *}

Und dann verwenden Sie diese in einer Datei `main.py`:

{* ../../docs_src/settings/app01/main.py hl[3,11:13] *}

/// tip | Tipp

Sie ben√∂tigen au√üerdem eine Datei `__init__.py`, wie in [Gr√∂√üere Anwendungen ‚Äì mehrere Dateien](../tutorial/bigger-applications.md){.internal-link target=_blank} gesehen.

///

## Einstellungen in einer Abh√§ngigkeit

In manchen F√§llen kann es n√ºtzlich sein, die Einstellungen mit einer Abh√§ngigkeit bereitzustellen, anstatt ein globales Objekt `settings` zu haben, das √ºberall verwendet wird.

Dies k√∂nnte besonders beim Testen n√ºtzlich sein, da es sehr einfach ist, eine Abh√§ngigkeit mit Ihren eigenen benutzerdefinierten Einstellungen zu √ºberschreiben.

### Die Konfigurationsdatei

Ausgehend vom vorherigen Beispiel k√∂nnte Ihre Datei `config.py` so aussehen:

{* ../../docs_src/settings/app02/config.py hl[10] *}

Beachten Sie, dass wir jetzt keine Standardinstanz `settings = Settings()` erstellen.

### Die Haupt-Anwendungsdatei

Jetzt erstellen wir eine Abh√§ngigkeit, die ein neues `config.Settings()` zur√ºckgibt.

{* ../../docs_src/settings/app02_an_py39/main.py hl[6,12:13] *}

/// tip | Tipp

Wir werden das `@lru_cache` in K√ºrze besprechen.

Im Moment nehmen Sie an, dass `get_settings()` eine normale Funktion ist.

///

Und dann k√∂nnen wir das von der *Pfadoperation-Funktion* als Abh√§ngigkeit einfordern und es √ºberall dort verwenden, wo wir es brauchen.

{* ../../docs_src/settings/app02_an_py39/main.py hl[17,19:21] *}

### Einstellungen und Tests

Dann w√§re es sehr einfach, beim Testen ein anderes Einstellungsobjekt bereitzustellen, indem man eine Abh√§ngigkeits√ºberschreibung f√ºr `get_settings` erstellt:

{* ../../docs_src/settings/app02/test_main.py hl[9:10,13,21] *}

Bei der Abh√§ngigkeits√ºberschreibung legen wir einen neuen Wert f√ºr `admin_email` fest, wenn wir das neue `Settings`-Objekt erstellen, und geben dann dieses neue Objekt zur√ºck.

Dann k√∂nnen wir testen, ob das verwendet wird.

## Lesen einer `.env`-Datei

Wenn Sie viele Einstellungen haben, die sich m√∂glicherweise oft √§ndern, vielleicht in verschiedenen Umgebungen, kann es n√ºtzlich sein, diese in eine Datei zu schreiben und sie dann daraus zu lesen, als w√§ren sie Umgebungsvariablen.

Diese Praxis ist so weit verbreitet, dass sie einen Namen hat. Diese Umgebungsvariablen werden √ºblicherweise in einer Datei `.env` abgelegt und die Datei wird ‚Äûdotenv‚Äú genannt.

/// tip | Tipp

Eine Datei, die mit einem Punkt (`.`) beginnt, ist eine versteckte Datei in Unix-√§hnlichen Systemen wie Linux und macOS.

Aber eine dotenv-Datei muss nicht unbedingt genau diesen Dateinamen haben.

///

Pydantic unterst√ºtzt das Lesen dieser Dateitypen mithilfe einer externen Bibliothek. Weitere Informationen finden Sie unter <a href="https://docs.pydantic.dev/latest/concepts/pydantic_settings/#dotenv-env-support" class="external-link" target="_blank">Pydantic Settings: Dotenv (.env) support</a>.

/// tip | Tipp

Damit das funktioniert, m√ºssen Sie `pip install python-dotenv` ausf√ºhren.

///

### Die `.env`-Datei

Sie k√∂nnten eine `.env`-Datei haben, mit:

```bash
ADMIN_EMAIL="deadpool@example.com"
APP_NAME="ChimichangApp"
```

### Einstellungen aus `.env` lesen

Und dann aktualisieren Sie Ihre `config.py` mit:

//// tab | Pydantic v2

{* ../../docs_src/settings/app03_an/config.py hl[9] *}

/// tip | Tipp

Das Attribut `model_config` wird nur f√ºr die Pydantic-Konfiguration verwendet. Weitere Informationen finden Sie unter <a href="https://docs.pydantic.dev/latest/concepts/config/" class="external-link" target="_blank">Pydantic: Configuration</a>.

///

////

//// tab | Pydantic v1

{* ../../docs_src/settings/app03_an/config_pv1.py hl[9:10] *}

/// tip | Tipp

Die Klasse `Config` wird nur f√ºr die Pydantic-Konfiguration verwendet. Weitere Informationen finden Sie unter <a href="https://docs.pydantic.dev/1.10/usage/model_config/" class="external-link" target="_blank">Pydantic Model Config</a>.

///

////

/// info

In Pydantic Version 1 erfolgte die Konfiguration in einer internen Klasse `Config`, in Pydantic Version 2 erfolgt sie in einem Attribut `model_config`. Dieses Attribut akzeptiert ein `dict`. Um automatische Codevervollst√§ndigung und Inline-Fehlerberichte zu erhalten, k√∂nnen Sie `SettingsConfigDict` importieren und verwenden, um dieses `dict` zu definieren.

///

Hier definieren wir die Konfiguration `env_file` innerhalb Ihrer Pydantic-`Settings`-Klasse und setzen den Wert auf den Dateinamen mit der dotenv-Datei, die wir verwenden m√∂chten.

### Die `Settings` nur einmal laden mittels `lru_cache`

Das Lesen einer Datei von der Festplatte ist normalerweise ein kostspieliger (langsamer) Vorgang, daher m√∂chten Sie ihn wahrscheinlich nur einmal ausf√ºhren und dann dasselbe Einstellungsobjekt erneut verwenden, anstatt es f√ºr jeden Request zu lesen.

Aber jedes Mal, wenn wir ausf√ºhren:

```Python
Settings()
```

w√ºrde ein neues `Settings`-Objekt erstellt und bei der Erstellung w√ºrde die `.env`-Datei erneut ausgelesen.

Wenn die Abh√§ngigkeitsfunktion wie folgt w√§re:

```Python
def get_settings():
    return Settings()
```

w√ºrden wir dieses Objekt f√ºr jeden Request erstellen und die `.env`-Datei f√ºr jeden Request lesen. ‚ö†Ô∏è

Da wir jedoch den `@lru_cache`-Dekorator oben verwenden, wird das `Settings`-Objekt nur einmal erstellt, n√§mlich beim ersten Aufruf. ‚úîÔ∏è

{* ../../docs_src/settings/app03_an_py39/main.py hl[1,11] *}

Dann wird bei allen nachfolgenden Aufrufen von `get_settings()`, in den Abh√§ngigkeiten f√ºr darauffolgende Requests, dasselbe Objekt zur√ºckgegeben, das beim ersten Aufruf zur√ºckgegeben wurde, anstatt den Code von `get_settings()` erneut auszuf√ºhren und ein neues `Settings`-Objekt zu erstellen.

#### Technische Details zu `lru_cache`

`@lru_cache` √§ndert die Funktion, die es dekoriert, dahingehend, denselben Wert zur√ºckzugeben, der beim ersten Mal zur√ºckgegeben wurde, anstatt ihn erneut zu berechnen und den Code der Funktion jedes Mal auszuf√ºhren.

Die darunter liegende Funktion wird also f√ºr jede Argumentkombination einmal ausgef√ºhrt. Und dann werden die von jeder dieser Argumentkombinationen zur√ºckgegebenen Werte immer wieder verwendet, wenn die Funktion mit genau derselben Argumentkombination aufgerufen wird.

Wenn Sie beispielsweise eine Funktion haben:

```Python
@lru_cache
def say_hi(name: str, salutation: str = "Ms."):
    return f"Hello {salutation} {name}"
```

k√∂nnte Ihr Programm so ausgef√ºhrt werden:

```mermaid
sequenceDiagram

participant code as Code
participant function as say_hi()
participant execute as Funktion ausgef√ºhrt

    rect rgba(0, 255, 0, .1)
        code ->> function: say_hi(name="Camila")
        function ->> execute: f√ºhre Code der Funktion aus
        execute ->> code: gib das Resultat zur√ºck
    end

    rect rgba(0, 255, 255, .1)
        code ->> function: say_hi(name="Camila")
        function ->> code: gib das gespeicherte Resultat zur√ºck
    end

    rect rgba(0, 255, 0, .1)
        code ->> function: say_hi(name="Rick")
        function ->> execute: f√ºhre Code der Funktion aus
        execute ->> code: gib das Resultat zur√ºck
    end

    rect rgba(0, 255, 0, .1)
        code ->> function: say_hi(name="Rick", salutation="Mr.")
        function ->> execute: f√ºhre Code der Funktion aus
        execute ->> code: gib das Resultat zur√ºck
    end

    rect rgba(0, 255, 255, .1)
        code ->> function: say_hi(name="Rick")
        function ->> code: gib das gespeicherte Resultat zur√ºck
    end

    rect rgba(0, 255, 255, .1)
        code ->> function: say_hi(name="Camila")
        function ->> code: gib das gespeicherte Resultat zur√ºck
    end
```

Im Fall unserer Abh√§ngigkeit `get_settings()` akzeptiert die Funktion nicht einmal Argumente, sodass sie immer den gleichen Wert zur√ºckgibt.

Auf diese Weise verh√§lt es sich fast so, als w√§re es nur eine globale Variable. Da es jedoch eine Abh√§ngigkeitsfunktion verwendet, k√∂nnen wir diese zu Testzwecken problemlos √ºberschreiben.

`@lru_cache` ist Teil von `functools`, welches Teil von Pythons Standardbibliothek ist. Weitere Informationen dazu finden Sie in der <a href="https://docs.python.org/3/library/functools.html#functools.lru_cache" class="external-link" target="_blank">Python Dokumentation f√ºr `@lru_cache`</a>.

## Zusammenfassung

Mit Pydantic Settings k√∂nnen Sie die Einstellungen oder Konfigurationen f√ºr Ihre Anwendung verwalten und dabei die gesamte Leistungsf√§higkeit der Pydantic-Modelle nutzen.

* Durch die Verwendung einer Abh√§ngigkeit k√∂nnen Sie das Testen vereinfachen.
* Sie k√∂nnen `.env`-Dateien damit verwenden.
* Durch die Verwendung von `@lru_cache` k√∂nnen Sie vermeiden, die dotenv-Datei bei jedem Request erneut zu lesen, w√§hrend Sie sie w√§hrend des Testens √ºberschreiben k√∂nnen.


================================================
File: /docs/de/docs/advanced/sub-applications.md
================================================
# Unteranwendungen ‚Äì Mounts

Wenn Sie zwei unabh√§ngige FastAPI-Anwendungen mit deren eigenen unabh√§ngigen OpenAPI und deren eigenen Dokumentationsoberfl√§chen ben√∂tigen, k√∂nnen Sie eine Hauptanwendung haben und dann eine (oder mehrere) Unteranwendung(en) ‚Äûmounten‚Äú.

## Mounten einer **FastAPI**-Anwendung

‚ÄûMounten‚Äú (‚ÄûEinh√§ngen‚Äú) bedeutet das Hinzuf√ºgen einer v√∂llig ‚Äûunabh√§ngigen‚Äú Anwendung an einem bestimmten Pfad, die sich dann um die Handhabung aller unter diesem Pfad liegenden _Pfadoperationen_ k√ºmmert, welche in dieser Unteranwendung deklariert sind.

### Hauptanwendung

Erstellen Sie zun√§chst die Hauptanwendung **FastAPI** und deren *Pfadoperationen*:

{* ../../docs_src/sub_applications/tutorial001.py hl[3,6:8] *}

### Unteranwendung

Erstellen Sie dann Ihre Unteranwendung und deren *Pfadoperationen*.

Diese Unteranwendung ist nur eine weitere Standard-FastAPI-Anwendung, aber diese wird ‚Äûgemountet‚Äú:

{* ../../docs_src/sub_applications/tutorial001.py hl[11,14:16] *}

### Die Unteranwendung mounten

Mounten Sie in Ihrer Top-Level-Anwendung `app` die Unteranwendung `subapi`.

In diesem Fall wird sie im Pfad `/subapi` gemountet:

{* ../../docs_src/sub_applications/tutorial001.py hl[11,19] *}

### Es in der automatischen API-Dokumentation betrachten

F√ºhren Sie nun `uvicorn` mit der Hauptanwendung aus. Wenn Ihre Datei `main.py` lautet, w√§re das:

<div class="termy">

```console
$ uvicorn main:app --reload

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

Und √∂ffnen Sie die Dokumentation unter <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a>.

Sie sehen die automatische API-Dokumentation f√ºr die Hauptanwendung, welche nur deren eigene _Pfadoperationen_ anzeigt:

<img src="/img/tutorial/sub-applications/image01.png">

√ñffnen Sie dann die Dokumentation f√ºr die Unteranwendung unter <a href="http://127.0.0.1:8000/subapi/docs" class="external-link" target="_blank">http://127.0.0.1:8000/subapi/docs</a>.

Sie sehen die automatische API-Dokumentation f√ºr die Unteranwendung, welche nur deren eigene _Pfadoperationen_ anzeigt, alle unter dem korrekten Unterpfad-Pr√§fix `/subapi`:

<img src="/img/tutorial/sub-applications/image02.png">

Wenn Sie versuchen, mit einer der beiden Benutzeroberfl√§chen zu interagieren, funktionieren diese ordnungsgem√§√ü, da der Browser mit jeder spezifischen Anwendung oder Unteranwendung kommunizieren kann.

### Technische Details: `root_path`

Wenn Sie eine Unteranwendung wie oben beschrieben mounten, k√ºmmert sich FastAPI darum, den Mount-Pfad f√ºr die Unteranwendung zu kommunizieren, mithilfe eines Mechanismus aus der ASGI-Spezifikation namens `root_path`.

Auf diese Weise wei√ü die Unteranwendung, dass sie dieses Pfadpr√§fix f√ºr die Benutzeroberfl√§che der Dokumentation verwenden soll.

Und die Unteranwendung k√∂nnte auch ihre eigenen gemounteten Unteranwendungen haben und alles w√ºrde korrekt funktionieren, da FastAPI sich um alle diese `root_path`s automatisch k√ºmmert.

Mehr √ºber den `root_path` und dessen explizite Verwendung erfahren Sie im Abschnitt [Hinter einem Proxy](behind-a-proxy.md){.internal-link target=_blank}.


================================================
File: /docs/de/docs/advanced/templates.md
================================================
# Templates

Sie k√∂nnen jede gew√ºnschte Template-Engine mit **FastAPI** verwenden.

Eine h√§ufige Wahl ist Jinja2, dasselbe, was auch von Flask und anderen Tools verwendet wird.

Es gibt Werkzeuge zur einfachen Konfiguration, die Sie direkt in Ihrer **FastAPI**-Anwendung verwenden k√∂nnen (bereitgestellt von Starlette).

## Abh√§ngigkeiten installieren

Installieren Sie `jinja2`:

<div class="termy">

```console
$ pip install jinja2

---> 100%
```

</div>

## Verwendung von `Jinja2Templates`

* Importieren Sie `Jinja2Templates`.
* Erstellen Sie ein `templates`-Objekt, das Sie sp√§ter wiederverwenden k√∂nnen.
* Deklarieren Sie einen `Request`-Parameter in der *Pfadoperation*, welcher ein Template zur√ºckgibt.
* Verwenden Sie die von Ihnen erstellten `templates`, um eine `TemplateResponse` zu rendern und zur√ºckzugeben, √ºbergeben Sie den Namen des Templates, das Requestobjekt und ein ‚ÄûKontext‚Äú-Dictionary mit Schl√ºssel-Wert-Paaren, die innerhalb des Jinja2-Templates verwendet werden sollen.

{* ../../docs_src/templates/tutorial001.py hl[4,11,15:18] *}

/// note | Hinweis

Vor FastAPI 0.108.0 und Starlette 0.29.0 war `name` der erste Parameter.

Au√üerdem wurde in fr√ºheren Versionen das `request`-Objekt als Teil der Schl√ºssel-Wert-Paare im Kontext f√ºr Jinja2 √ºbergeben.

///

/// tip | Tipp

Durch die Deklaration von `response_class=HTMLResponse` kann die Dokumentationsoberfl√§che erkennen, dass die Response HTML sein wird.

///

/// note | Technische Details

Sie k√∂nnen auch `from starlette.templating import Jinja2Templates` verwenden.

**FastAPI** bietet dasselbe `starlette.templating` auch via `fastapi.templating` an, als Annehmlichkeit f√ºr Sie, den Entwickler. Es kommt aber direkt von Starlette. Das Gleiche gilt f√ºr `Request` und `StaticFiles`.

///

## Templates erstellen

Dann k√∂nnen Sie unter `templates/item.html` ein Template erstellen, mit z. B. folgendem Inhalt:

```jinja hl_lines="7"
{!../../docs_src/templates/templates/item.html!}
```

### Template-Kontextwerte

Im HTML, welches enth√§lt:

{% raw %}

```jinja
Item ID: {{ id }}
```

{% endraw %}

... wird die `id` angezeigt, welche dem ‚ÄûKontext‚Äú-`dict` entnommen wird, welches Sie √ºbergeben haben:

```Python
{"id": id}
```

Mit beispielsweise einer ID `42` w√ºrde das wie folgt gerendert werden:

```html
Item ID: 42
```

### Template-`url_for`-Argumente

Sie k√∂nnen `url_for()` auch innerhalb des Templates verwenden, es nimmt als Argumente dieselben Argumente, die von Ihrer *Pfadoperation-Funktion* verwendet werden.

Der Abschnitt mit:

{% raw %}

```jinja
<a href="{{ url_for('read_item', id=id) }}">
```

{% endraw %}

... generiert also einen Link zu derselben URL, welche von der *Pfadoperation-Funktion* `read_item(id=id)` gehandhabt werden w√ºrde.

Mit beispielsweise der ID `42` w√ºrde dies Folgendes ergeben:

```html
<a href="/items/42">
```

## Templates und statische Dateien

Sie k√∂nnen `url_for()` innerhalb des Templates auch beispielsweise mit den `StaticFiles` verwenden, die Sie mit `name="static"` gemountet haben.

```jinja hl_lines="4"
{!../../docs_src/templates/templates/item.html!}
```

In diesem Beispiel w√ºrde das zu einer CSS-Datei unter `static/styles.css` verlinken, mit folgendem Inhalt:

```CSS hl_lines="4"
{!../../docs_src/templates/static/styles.css!}
```

Und da Sie `StaticFiles` verwenden, wird diese CSS-Datei automatisch von Ihrer **FastAPI**-Anwendung unter der URL `/static/styles.css` bereitgestellt.

## Mehr Details

Weitere Informationen, einschlie√ülich, wie man Templates testet, finden Sie in der <a href="https://www.starlette.io/templates/" class="external-link" target="_blank">Starlette Dokumentation zu Templates</a>.


================================================
File: /docs/de/docs/advanced/testing-dependencies.md
================================================
# Testen mit Ersatz f√ºr Abh√§ngigkeiten

## Abh√§ngigkeiten beim Testen √ºberschreiben

Es gibt einige Szenarien, in denen Sie beim Testen m√∂glicherweise eine Abh√§ngigkeit √ºberschreiben m√∂chten.

Sie m√∂chten nicht, dass die urspr√ºngliche Abh√§ngigkeit ausgef√ºhrt wird (und auch keine der m√∂glicherweise vorhandenen Unterabh√§ngigkeiten).

Stattdessen m√∂chten Sie eine andere Abh√§ngigkeit bereitstellen, die nur w√§hrend Tests (m√∂glicherweise nur bei einigen bestimmten Tests) verwendet wird und einen Wert bereitstellt, der dort verwendet werden kann, wo der Wert der urspr√ºnglichen Abh√§ngigkeit verwendet wurde.

### Anwendungsf√§lle: Externer Service

Ein Beispiel k√∂nnte sein, dass Sie einen externen Authentifizierungsanbieter haben, mit dem Sie sich verbinden m√ºssen.

Sie senden ihm ein Token und er gibt einen authentifizierten Benutzer zur√ºck.

Dieser Anbieter berechnet Ihnen m√∂glicherweise Geb√ºhren pro Anfrage, und der Aufruf k√∂nnte etwas l√§nger dauern, als wenn Sie einen vordefinierten Scheinbenutzer f√ºr Tests h√§tten.

Sie m√∂chten den externen Anbieter wahrscheinlich einmal testen, ihn aber nicht unbedingt bei jedem weiteren ausgef√ºhrten Test aufrufen.

In diesem Fall k√∂nnen Sie die Abh√§ngigkeit, die diesen Anbieter aufruft, √ºberschreiben und eine benutzerdefinierte Abh√§ngigkeit verwenden, die einen Scheinbenutzer zur√ºckgibt, nur f√ºr Ihre Tests.

### Verwenden Sie das Attribut `app.dependency_overrides`.

F√ºr diese F√§lle verf√ºgt Ihre **FastAPI**-Anwendung √ºber das Attribut `app.dependency_overrides`, bei diesem handelt sich um ein einfaches `dict`.

Um eine Abh√§ngigkeit f√ºr das Testen zu √ºberschreiben, geben Sie als Schl√ºssel die urspr√ºngliche Abh√§ngigkeit (eine Funktion) und als Wert Ihre √úberschreibung der Abh√§ngigkeit (eine andere Funktion) ein.

Und dann ruft **FastAPI** diese √úberschreibung anstelle der urspr√ºnglichen Abh√§ngigkeit auf.

{* ../../docs_src/dependency_testing/tutorial001_an_py310.py hl[26:27,30] *}

/// tip | Tipp

Sie k√∂nnen eine √úberschreibung f√ºr eine Abh√§ngigkeit festlegen, die an einer beliebigen Stelle in Ihrer **FastAPI**-Anwendung verwendet wird.

Die urspr√ºngliche Abh√§ngigkeit k√∂nnte in einer *Pfadoperation-Funktion*, einem *Pfadoperation-Dekorator* (wenn Sie den R√ºckgabewert nicht verwenden), einem `.include_router()`-Aufruf, usw. verwendet werden.

FastAPI kann sie in jedem Fall √ºberschreiben.

///

Anschlie√üend k√∂nnen Sie Ihre √úberschreibungen zur√ºcksetzen (entfernen), indem Sie `app.dependency_overrides` auf ein leeres `dict` setzen:

```Python
app.dependency_overrides = {}
```

/// tip | Tipp

Wenn Sie eine Abh√§ngigkeit nur w√§hrend einiger Tests √ºberschreiben m√∂chten, k√∂nnen Sie die √úberschreibung zu Beginn des Tests (innerhalb der Testfunktion) festlegen und am Ende (am Ende der Testfunktion) zur√ºcksetzen.

///


================================================
File: /docs/de/docs/advanced/testing-events.md
================================================
# Events testen: Hochfahren ‚Äì Herunterfahren

Wenn Sie in Ihren Tests Ihre Event-Handler (`startup` und `shutdown`) ausf√ºhren wollen, k√∂nnen Sie den `TestClient` mit einer `with`-Anweisung verwenden:

{* ../../docs_src/app_testing/tutorial003.py hl[9:12,20:24] *}


================================================
File: /docs/de/docs/advanced/testing-websockets.md
================================================
# WebSockets testen

Sie k√∂nnen den schon bekannten `TestClient` zum Testen von WebSockets verwenden.

Dazu verwenden Sie den `TestClient` in einer `with`-Anweisung, eine Verbindung zum WebSocket herstellend:

{* ../../docs_src/app_testing/tutorial002.py hl[27:31] *}

/// note | Hinweis

Weitere Informationen finden Sie in der Starlette-Dokumentation zum <a href="https://www.starlette.io/testclient/#testing-websocket-sessions" class="external-link" target="_blank">Testen von WebSockets</a>.

///


================================================
File: /docs/de/docs/advanced/using-request-directly.md
================================================
# Den Request direkt verwenden

Bisher haben Sie die Teile des Requests, die Sie ben√∂tigen, mithilfe von deren Typen deklariert.

Daten nehmend von:

* Dem Pfad als Parameter.
* Headern.
* Cookies.
* usw.

Und indem Sie das tun, validiert **FastAPI** diese Daten, konvertiert sie und generiert automatisch Dokumentation f√ºr Ihre API.

Es gibt jedoch Situationen, in denen Sie m√∂glicherweise direkt auf das `Request`-Objekt zugreifen m√ºssen.

## Details zum `Request`-Objekt

Da **FastAPI** unter der Haube eigentlich **Starlette** ist, mit einer Ebene von mehreren Tools dar√ºber, k√∂nnen Sie Starlette's <a href="https://www.starlette.io/requests/" class="external-link" target="_blank">`Request`</a>-Objekt direkt verwenden, wenn Sie es ben√∂tigen.

Das bedeutet allerdings auch, dass, wenn Sie Daten direkt vom `Request`-Objekt nehmen (z. B. dessen Body lesen), diese von FastAPI nicht validiert, konvertiert oder dokumentiert werden (mit OpenAPI, f√ºr die automatische API-Benutzeroberfl√§che).

Obwohl jeder andere normal deklarierte Parameter (z. B. der Body, mit einem Pydantic-Modell) dennoch validiert, konvertiert, annotiert, usw. werden w√ºrde.

Es gibt jedoch bestimmte F√§lle, in denen es n√ºtzlich ist, auf das `Request`-Objekt zuzugreifen.

## Das `Request`-Objekt direkt verwenden

Angenommen, Sie m√∂chten auf die IP-Adresse/den Host des Clients in Ihrer *Pfadoperation-Funktion* zugreifen.

Dazu m√ºssen Sie direkt auf den Request zugreifen.

{* ../../docs_src/using_request_directly/tutorial001.py hl[1,7:8] *}

Durch die Deklaration eines *Pfadoperation-Funktionsparameters*, dessen Typ der `Request` ist, wei√ü **FastAPI**, dass es den `Request` diesem Parameter √ºbergeben soll.

/// tip | Tipp

Beachten Sie, dass wir in diesem Fall einen Pfad-Parameter zus√§tzlich zum Request-Parameter deklarieren.

Der Pfad-Parameter wird also extrahiert, validiert, in den spezifizierten Typ konvertiert und mit OpenAPI annotiert.

Auf die gleiche Weise k√∂nnen Sie wie gewohnt jeden anderen Parameter deklarieren und zus√§tzlich auch den `Request` erhalten.

///

## `Request`-Dokumentation

Weitere Details zum <a href="https://www.starlette.io/requests/" class="external-link" target="_blank">`Request`-Objekt finden Sie in der offiziellen Starlette-Dokumentation</a>.

/// note | Technische Details

Sie k√∂nnen auch `from starlette.requests import Request` verwenden.

**FastAPI** stellt es direkt zur Verf√ºgung, als Komfort f√ºr Sie, den Entwickler. Es kommt aber direkt von Starlette.

///


================================================
File: /docs/de/docs/advanced/websockets.md
================================================
# WebSockets

Sie k√∂nnen <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API" class="external-link" target="_blank">WebSockets</a> mit **FastAPI** verwenden.

## `WebSockets` installieren

Zuerst m√ºssen Sie `WebSockets` installieren:

<div class="termy">

```console
$ pip install websockets

---> 100%
```

</div>

## WebSockets-Client

### In Produktion

In Ihrem Produktionssystem haben Sie wahrscheinlich ein Frontend, das mit einem modernen Framework wie React, Vue.js oder Angular erstellt wurde.

Und um √ºber WebSockets mit Ihrem Backend zu kommunizieren, w√ºrden Sie wahrscheinlich die Werkzeuge Ihres Frontends verwenden.

Oder Sie verf√ºgen m√∂glicherweise √ºber eine native Mobile-Anwendung, die direkt in nativem Code mit Ihrem WebSocket-Backend kommuniziert.

Oder Sie haben andere M√∂glichkeiten, mit dem WebSocket-Endpunkt zu kommunizieren.

---

F√ºr dieses Beispiel verwenden wir jedoch ein sehr einfaches HTML-Dokument mit etwas JavaScript, alles in einem langen String.

Das ist nat√ºrlich nicht optimal und man w√ºrde das nicht in der Produktion machen.

In der Produktion h√§tten Sie eine der oben genannten Optionen.

Aber es ist die einfachste M√∂glichkeit, sich auf die Serverseite von WebSockets zu konzentrieren und ein funktionierendes Beispiel zu haben:

{* ../../docs_src/websockets/tutorial001.py hl[2,6:38,41:43] *}

## Einen `websocket` erstellen

Erstellen Sie in Ihrer **FastAPI**-Anwendung einen `websocket`:

{* ../../docs_src/websockets/tutorial001.py hl[1,46:47] *}

/// note | Technische Details

Sie k√∂nnen auch `from starlette.websockets import WebSocket` verwenden.

**FastAPI** stellt den gleichen `WebSocket` direkt zur Verf√ºgung, als Annehmlichkeit f√ºr Sie, den Entwickler. Er kommt aber direkt von Starlette.

///

## Nachrichten erwarten und Nachrichten senden

In Ihrer WebSocket-Route k√∂nnen Sie Nachrichten `await`en und Nachrichten senden.

{* ../../docs_src/websockets/tutorial001.py hl[48:52] *}

Sie k√∂nnen Bin√§r-, Text- und JSON-Daten empfangen und senden.

## Es ausprobieren

Wenn Ihre Datei `main.py` hei√üt, f√ºhren Sie Ihre Anwendung so aus:

<div class="termy">

```console
$ uvicorn main:app --reload

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

√ñffnen Sie Ihren Browser unter <a href="http://127.0.0.1:8000" class="external-link" target="_blank">http://127.0.0.1:8000</a>.

Sie sehen eine einfache Seite wie:

<img src="/img/tutorial/websockets/image01.png">

Sie k√∂nnen Nachrichten in das Eingabefeld tippen und absenden:

<img src="/img/tutorial/websockets/image02.png">

Und Ihre **FastAPI**-Anwendung mit WebSockets antwortet:

<img src="/img/tutorial/websockets/image03.png">

Sie k√∂nnen viele Nachrichten senden (und empfangen):

<img src="/img/tutorial/websockets/image04.png">

Und alle verwenden dieselbe WebSocket-Verbindung.

## Verwendung von `Depends` und anderen

In WebSocket-Endpunkten k√∂nnen Sie Folgendes aus `fastapi` importieren und verwenden:

* `Depends`
* `Security`
* `Cookie`
* `Header`
* `Path`
* `Query`

Diese funktionieren auf die gleiche Weise wie f√ºr andere FastAPI-Endpunkte/*Pfadoperationen*:

{* ../../docs_src/websockets/tutorial002_an_py310.py hl[68:69,82] *}

/// info

Da es sich um einen WebSocket handelt, macht es keinen Sinn, eine `HTTPException` auszul√∂sen, stattdessen l√∂sen wir eine `WebSocketException` aus.

Sie k√∂nnen einen ‚ÄûClosing‚Äú-Code verwenden, aus den <a href="https://tools.ietf.org/html/rfc6455#section-7.4.1" class="external-link" target="_blank">g√ºltigen Codes, die in der Spezifikation definiert sind</a>.

///

### WebSockets mit Abh√§ngigkeiten ausprobieren

Wenn Ihre Datei `main.py` hei√üt, f√ºhren Sie Ihre Anwendung mit Folgendem aus:

<div class="termy">

```console
$ uvicorn main:app --reload

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

√ñffnen Sie Ihren Browser unter <a href="http://127.0.0.1:8000" class="external-link" target="_blank">http://127.0.0.1:8000</a>.

Dort k√∂nnen Sie einstellen:

* Die ‚ÄûItem ID‚Äú, die im Pfad verwendet wird.
* Das ‚ÄûToken‚Äú, das als Query-Parameter verwendet wird.

/// tip | Tipp

Beachten Sie, dass der Query-‚ÄûToken‚Äú von einer Abh√§ngigkeit verarbeitet wird.

///

Damit k√∂nnen Sie den WebSocket verbinden und dann Nachrichten senden und empfangen:

<img src="/img/tutorial/websockets/image05.png">

## Verbindungsabbr√ºche und mehreren Clients handhaben

Wenn eine WebSocket-Verbindung geschlossen wird, l√∂st `await websocket.receive_text()` eine `WebSocketDisconnect`-Exception aus, die Sie dann wie in folgendem Beispiel abfangen und behandeln k√∂nnen.

{* ../../docs_src/websockets/tutorial003_py39.py hl[79:81] *}

Zum Ausprobieren:

* √ñffnen Sie die Anwendung mit mehreren Browser-Tabs.
* Schreiben Sie Nachrichten in den Tabs.
* Schlie√üen Sie dann einen der Tabs.

Das wird die Ausnahme `WebSocketDisconnect` ausl√∂sen und alle anderen Clients erhalten eine Nachricht wie:

```
Client #1596980209979 left the chat
```

/// tip | Tipp

Die obige Anwendung ist ein minimales und einfaches Beispiel, das zeigt, wie Nachrichten verarbeitet und an mehrere WebSocket-Verbindungen gesendet werden.

Beachten Sie jedoch, dass, da alles nur im Speicher in einer einzigen Liste verwaltet wird, es nur funktioniert, w√§hrend der Prozess ausgef√ºhrt wird, und nur mit einem einzelnen Prozess.

Wenn Sie etwas ben√∂tigen, das sich leicht in FastAPI integrieren l√§sst, aber robuster ist und von Redis, PostgreSQL und anderen unterst√ºtzt wird, sehen Sie sich <a href="https://github.com/encode/broadcaster" class="external-link" target="_blank">encode/broadcaster</a> an.

///

## Mehr Informationen

Weitere Informationen zu Optionen finden Sie in der Dokumentation von Starlette:

* <a href="https://www.starlette.io/websockets/" class="external-link" target="_blank">Die `WebSocket`-Klasse</a>.
* <a href="https://www.starlette.io/endpoints/#websocketendpoint" class="external-link" target="_blank">Klassen-basierte Handhabung von WebSockets</a>.


================================================
File: /docs/de/docs/advanced/wsgi.md
================================================
# WSGI inkludieren ‚Äì Flask, Django und andere

Sie k√∂nnen WSGI-Anwendungen mounten, wie Sie es in [Unteranwendungen ‚Äì Mounts](sub-applications.md){.internal-link target=_blank}, [Hinter einem Proxy](behind-a-proxy.md){.internal-link target=_blank} gesehen haben.

Dazu k√∂nnen Sie die `WSGIMiddleware` verwenden und damit Ihre WSGI-Anwendung wrappen, zum Beispiel Flask, Django usw.

## `WSGIMiddleware` verwenden

Sie m√ºssen `WSGIMiddleware` importieren.

Wrappen Sie dann die WSGI-Anwendung (z. B. Flask) mit der Middleware.

Und dann mounten Sie das auf einem Pfad.

{* ../../docs_src/wsgi/tutorial001.py hl[2:3,23] *}

## Es ansehen

Jetzt wird jede Anfrage unter dem Pfad `/v1/` von der Flask-Anwendung verarbeitet.

Und der Rest wird von **FastAPI** gehandhabt.

Wenn Sie das mit Uvicorn ausf√ºhren und auf <a href="http://localhost:8000/v1/" class="external-link" target="_blank">http://localhost:8000/v1/</a> gehen, sehen Sie die Response von Flask:

```txt
Hello, World from Flask!
```

Und wenn Sie auf <a href="http://localhost:8000/v2" class="external-link" target="_blank">http://localhost:8000/v2</a> gehen, sehen Sie die Response von FastAPI:

```JSON
{
    "message": "Hello World"
}
```


================================================
File: /docs/de/docs/advanced/security/http-basic-auth.md
================================================
# HTTP Basic Auth

F√ºr die einfachsten F√§lle k√∂nnen Sie <abbr title="HTTP-Basisauthentifizierung">HTTP Basic Auth</abbr> verwenden.

Bei HTTP Basic Auth erwartet die Anwendung einen Header, der einen Benutzernamen und ein Passwort enth√§lt.

Wenn sie diesen nicht empf√§ngt, gibt sie den HTTP-Error 401 ‚ÄûUnauthorized‚Äú zur√ºck.

Und gibt einen Header `WWW-Authenticate` mit dem Wert `Basic` und einem optionalen `realm`-Parameter (‚ÄûBereich‚Äú) zur√ºck.

Dadurch wird der Browser angewiesen, die integrierte Eingabeaufforderung f√ºr einen Benutzernamen und ein Passwort anzuzeigen.

Wenn Sie dann den Benutzernamen und das Passwort eingeben, sendet der Browser diese automatisch im Header.

## Einfaches HTTP Basic Auth

* Importieren Sie `HTTPBasic` und `HTTPBasicCredentials`.
* Erstellen Sie mit `HTTPBasic` ein ‚Äû`security`-Schema‚Äú.
* Verwenden Sie dieses `security` mit einer Abh√§ngigkeit in Ihrer *Pfadoperation*.
* Diese gibt ein Objekt vom Typ `HTTPBasicCredentials` zur√ºck:
    * Es enth√§lt den gesendeten `username` und das gesendete `password`.

{* ../../docs_src/security/tutorial006_an_py39.py hl[4,8,12] *}
Wenn Sie versuchen, die URL zum ersten Mal zu √∂ffnen (oder in der Dokumentation auf den Button ‚ÄûExecute‚Äú zu klicken), wird der Browser Sie nach Ihrem Benutzernamen und Passwort fragen:

<img src="/img/tutorial/security/image12.png">

## Den Benutzernamen √ºberpr√ºfen

Hier ist ein vollst√§ndigeres Beispiel.

Verwenden Sie eine Abh√§ngigkeit, um zu √ºberpr√ºfen, ob Benutzername und Passwort korrekt sind.

Verwenden Sie dazu das Python-Standardmodul <a href="https://docs.python.org/3/library/secrets.html" class="external-link" target="_blank">`secrets`</a>, um den Benutzernamen und das Passwort zu √ºberpr√ºfen.

`secrets.compare_digest()` ben√∂tigt `bytes` oder einen `str`, welcher nur ASCII-Zeichen (solche der englischen Sprache) enthalten darf, das bedeutet, dass es nicht mit Zeichen wie `√°`, wie in `Sebasti√°n`, funktionieren w√ºrde.

Um dies zu l√∂sen, konvertieren wir zun√§chst den `username` und das `password` in UTF-8-codierte `bytes`.

Dann k√∂nnen wir `secrets.compare_digest()` verwenden, um sicherzustellen, dass `credentials.username` `"stanleyjobson"` und `credentials.password` `"swordfish"` ist.

{* ../../docs_src/security/tutorial007_an_py39.py hl[1,12:24] *}

Dies w√§re das gleiche wie:

```Python
if not (credentials.username == "stanleyjobson") or not (credentials.password == "swordfish"):
    # Einen Error zur√ºckgeben
    ...
```

Aber durch die Verwendung von `secrets.compare_digest()` ist dieser Code sicher vor einer Art von Angriffen, die ‚ÄûTiming-Angriffe‚Äú genannt werden.

### Timing-Angriffe

Aber was ist ein ‚ÄûTiming-Angriff‚Äú?

Stellen wir uns vor, dass einige Angreifer versuchen, den Benutzernamen und das Passwort zu erraten.

Und sie senden eine Anfrage mit dem Benutzernamen `johndoe` und dem Passwort `love123`.

Dann w√ºrde der Python-Code in Ihrer Anwendung etwa so aussehen:

```Python
if "johndoe" == "stanleyjobson" and "love123" == "swordfish":
    ...
```

Aber genau in dem Moment, in dem Python das erste `j` in `johndoe` mit dem ersten `s` in `stanleyjobson` vergleicht, gibt es `False` zur√ºck, da es bereits wei√ü, dass diese beiden Strings nicht identisch sind, und denkt, ‚ÄûEs besteht keine Notwendigkeit, weitere Berechnungen mit dem Vergleich der restlichen Buchstaben zu verschwenden‚Äú. Und Ihre Anwendung wird zur√ºckgeben ‚ÄûIncorrect username or password‚Äú.

Doch dann versuchen es die Angreifer mit dem Benutzernamen `stanleyjobsox` und dem Passwort `love123`.

Und Ihr Anwendungscode macht etwa Folgendes:

```Python
if "stanleyjobsox" == "stanleyjobson" and "love123" == "swordfish":
    ...
```

Python muss das gesamte `stanleyjobso` in `stanleyjobsox` und `stanleyjobson` vergleichen, bevor es erkennt, dass beide Zeichenfolgen nicht gleich sind. Daher wird es einige zus√§tzliche Mikrosekunden dauern, bis die Antwort ‚ÄûIncorrect username or password‚Äú erfolgt.

#### Die Zeit zum Antworten hilft den Angreifern

Wenn die Angreifer zu diesem Zeitpunkt feststellen, dass der Server einige Mikrosekunden l√§nger braucht, um die Antwort ‚ÄûIncorrect username or password‚Äú zu senden, wissen sie, dass sie _etwas_ richtig gemacht haben, einige der Anfangsbuchstaben waren richtig.

Und dann k√∂nnen sie es noch einmal versuchen, wohl wissend, dass es wahrscheinlich eher etwas mit `stanleyjobsox` als mit `johndoe` zu tun hat.

#### Ein ‚Äûprofessioneller‚Äú Angriff

Nat√ºrlich w√ºrden die Angreifer das alles nicht von Hand versuchen, sondern ein Programm daf√ºr schreiben, m√∂glicherweise mit Tausenden oder Millionen Tests pro Sekunde. Und w√ºrden jeweils nur einen zus√§tzlichen richtigen Buchstaben erhalten.

Aber so h√§tten die Angreifer in wenigen Minuten oder Stunden mit der ‚ÄûHilfe‚Äú unserer Anwendung den richtigen Benutzernamen und das richtige Passwort erraten, indem sie die Zeitspanne zur Hilfe nehmen, die diese zur Beantwortung ben√∂tigt.

#### Das Problem beheben mittels `secrets.compare_digest()`

Aber in unserem Code verwenden wir tats√§chlich `secrets.compare_digest()`.

Damit wird, kurz gesagt, der Vergleich von `stanleyjobsox` mit `stanleyjobson` genauso lange dauern wie der Vergleich von `johndoe` mit `stanleyjobson`. Und das Gleiche gilt f√ºr das Passwort.

So ist Ihr Anwendungscode, dank der Verwendung von `secrets.compare_digest()`, vor dieser ganzen Klasse von Sicherheitsangriffen gesch√ºtzt.

### Den Error zur√ºckgeben

Nachdem Sie festgestellt haben, dass die Anmeldeinformationen falsch sind, geben Sie eine `HTTPException` mit dem Statuscode 401 zur√ºck (derselbe, der auch zur√ºckgegeben wird, wenn keine Anmeldeinformationen angegeben werden) und f√ºgen den Header `WWW-Authenticate` hinzu, damit der Browser die Anmeldeaufforderung erneut anzeigt:

{* ../../docs_src/security/tutorial007_an_py39.py hl[26:30] *}


================================================
File: /docs/de/docs/advanced/security/index.md
================================================
# Fortgeschrittene Sicherheit

## Zusatzfunktionen

Neben den in [Tutorial ‚Äì Benutzerhandbuch: Sicherheit](../../tutorial/security/index.md){.internal-link target=_blank} behandelten Funktionen gibt es noch einige zus√§tzliche Funktionen zur Handhabung der Sicherheit.

/// tip | Tipp

Die n√§chsten Abschnitte sind **nicht unbedingt ‚Äûfortgeschritten‚Äú**.

Und es ist m√∂glich, dass f√ºr Ihren Anwendungsfall die L√∂sung in einem davon liegt.

///

## Lesen Sie zuerst das Tutorial

In den n√§chsten Abschnitten wird davon ausgegangen, dass Sie das Haupt-[Tutorial ‚Äì Benutzerhandbuch: Sicherheit](../../tutorial/security/index.md){.internal-link target=_blank} bereits gelesen haben.

Sie basieren alle auf den gleichen Konzepten, erm√∂glichen jedoch einige zus√§tzliche Funktionalit√§ten.


================================================
File: /docs/de/docs/advanced/security/oauth2-scopes.md
================================================
# OAuth2-Scopes

Sie k√∂nnen OAuth2-<abbr title="Geltungsbereiche">Scopes</abbr> direkt in **FastAPI** verwenden, sie sind nahtlos integriert.

Das erm√∂glicht es Ihnen, ein feingranuliertes Berechtigungssystem nach dem OAuth2-Standard in Ihre OpenAPI-Anwendung (und deren API-Dokumentation) zu integrieren.

OAuth2 mit Scopes ist der Mechanismus, der von vielen gro√üen Authentifizierungsanbietern wie Facebook, Google, GitHub, Microsoft, Twitter usw. verwendet wird. Sie verwenden ihn, um Benutzern und Anwendungen spezifische Berechtigungen zu erteilen.

Jedes Mal, wenn Sie sich mit Facebook, Google, GitHub, Microsoft oder Twitter anmelden (‚Äûlog in with‚Äú), verwendet die entsprechende Anwendung OAuth2 mit Scopes.

In diesem Abschnitt erfahren Sie, wie Sie Authentifizierung und Autorisierung mit demselben OAuth2, mit Scopes in Ihrer **FastAPI**-Anwendung verwalten.

/// warning | Achtung

Dies ist ein mehr oder weniger fortgeschrittener Abschnitt. Wenn Sie gerade erst anfangen, k√∂nnen Sie ihn √ºberspringen.

Sie ben√∂tigen nicht unbedingt OAuth2-Scopes, und Sie k√∂nnen die Authentifizierung und Autorisierung handhaben wie Sie m√∂chten.

Aber OAuth2 mit Scopes kann bequem in Ihre API (mit OpenAPI) und deren API-Dokumentation integriert werden.

Dennoch, verwenden Sie solche Scopes oder andere Sicherheits-/Autorisierungsanforderungen in Ihrem Code so wie Sie es m√∂chten.

In vielen F√§llen kann OAuth2 mit Scopes ein Overkill sein.

Aber wenn Sie wissen, dass Sie es brauchen oder neugierig sind, lesen Sie weiter.

///

## OAuth2-Scopes und OpenAPI

Die OAuth2-Spezifikation definiert ‚ÄûScopes‚Äú als eine Liste von durch Leerzeichen getrennten Strings.

Der Inhalt jedes dieser Strings kann ein beliebiges Format haben, sollte jedoch keine Leerzeichen enthalten.

Diese Scopes stellen ‚ÄûBerechtigungen‚Äú dar.

In OpenAPI (z. B. der API-Dokumentation) k√∂nnen Sie ‚ÄûSicherheitsschemas‚Äú definieren.

Wenn eines dieser Sicherheitsschemas OAuth2 verwendet, k√∂nnen Sie auch Scopes deklarieren und verwenden.

Jeder ‚ÄûScope‚Äú ist nur ein String (ohne Leerzeichen).

Er wird normalerweise verwendet, um bestimmte Sicherheitsberechtigungen zu deklarieren, zum Beispiel:

* `users:read` oder `users:write` sind g√§ngige Beispiele.
* `instagram_basic` wird von Facebook / Instagram verwendet.
* `https://www.googleapis.com/auth/drive` wird von Google verwendet.

/// info

In OAuth2 ist ein ‚ÄûScope‚Äú nur ein String, der eine bestimmte erforderliche Berechtigung deklariert.

Es spielt keine Rolle, ob er andere Zeichen wie `:` enth√§lt oder ob es eine URL ist.

Diese Details sind implementierungsspezifisch.

F√ºr OAuth2 sind es einfach nur Strings.

///

## Gesamt√ºbersicht

Sehen wir uns zun√§chst kurz die Teile an, die sich gegen√ºber den Beispielen im Haupt-**Tutorial ‚Äì Benutzerhandbuch** f√ºr [OAuth2 mit Password (und Hashing), Bearer mit JWT-Tokens](../../tutorial/security/oauth2-jwt.md){.internal-link target=_blank} √§ndern. Diesmal verwenden wir OAuth2-Scopes:

{* ../../docs_src/security/tutorial005_an_py310.py hl[4,8,12,46,64,105,107:115,121:124,128:134,139,155] *}

Sehen wir uns diese √Ñnderungen nun Schritt f√ºr Schritt an.

## OAuth2-Sicherheitsschema

Die erste √Ñnderung ist, dass wir jetzt das OAuth2-Sicherheitsschema mit zwei verf√ºgbaren Scopes deklarieren: `me` und `items`.

Der `scopes`-Parameter erh√§lt ein `dict` mit jedem Scope als Schl√ºssel und dessen Beschreibung als Wert:

{* ../../docs_src/security/tutorial005_an_py310.py hl[62:65] *}

Da wir diese Scopes jetzt deklarieren, werden sie in der API-Dokumentation angezeigt, wenn Sie sich einloggen/autorisieren.

Und Sie k√∂nnen ausw√§hlen, auf welche Scopes Sie Zugriff haben m√∂chten: `me` und `items`.

Das ist derselbe Mechanismus, der verwendet wird, wenn Sie beim Anmelden mit Facebook, Google, GitHub, usw. Berechtigungen erteilen:

<img src="/img/tutorial/security/image11.png">

## JWT-Token mit Scopes

√Ñndern Sie nun die Token-*Pfadoperation*, um die angeforderten Scopes zur√ºckzugeben.

Wir verwenden immer noch dasselbe `OAuth2PasswordRequestForm`. Es enth√§lt eine Eigenschaft `scopes` mit einer `list`e von `str`s f√ºr jeden Scope, den es im Request erhalten hat.

Und wir geben die Scopes als Teil des JWT-Tokens zur√ºck.

/// danger | Gefahr

Der Einfachheit halber f√ºgen wir hier die empfangenen Scopes direkt zum Token hinzu.

Aus Sicherheitsgr√ºnden sollten Sie jedoch sicherstellen, dass Sie in Ihrer Anwendung nur die Scopes hinzuf√ºgen, die der Benutzer tats√§chlich haben kann, oder die Sie vordefiniert haben.

///

{* ../../docs_src/security/tutorial005_an_py310.py hl[155] *}

## Scopes in *Pfadoperationen* und Abh√§ngigkeiten deklarieren

Jetzt deklarieren wir, dass die *Pfadoperation* f√ºr `/users/me/items/` den Scope `items` erfordert.

Dazu importieren und verwenden wir `Security` von `fastapi`.

Sie k√∂nnen `Security` verwenden, um Abh√§ngigkeiten zu deklarieren (genau wie `Depends`), aber `Security` erh√§lt auch einen Parameter `scopes` mit einer Liste von Scopes (Strings).

In diesem Fall √ºbergeben wir eine Abh√§ngigkeitsfunktion `get_current_active_user` an `Security` (genauso wie wir es mit `Depends` tun w√ºrden).

Wir √ºbergeben aber auch eine `list`e von Scopes, in diesem Fall mit nur einem Scope: `items` (es k√∂nnten mehrere sein).

Und die Abh√§ngigkeitsfunktion `get_current_active_user` kann auch Unterabh√§ngigkeiten deklarieren, nicht nur mit `Depends`, sondern auch mit `Security`. Ihre eigene Unterabh√§ngigkeitsfunktion (`get_current_user`) und weitere Scope-Anforderungen deklarierend.

In diesem Fall erfordert sie den Scope `me` (sie k√∂nnte mehr als einen Scope erfordern).

/// note | Hinweis

Sie m√ºssen nicht unbedingt an verschiedenen Stellen verschiedene Scopes hinzuf√ºgen.

Wir tun dies hier, um zu demonstrieren, wie **FastAPI** auf verschiedenen Ebenen deklarierte Scopes verarbeitet.

///

{* ../../docs_src/security/tutorial005_an_py310.py hl[4,139,170] *}

/// info | Technische Details

`Security` ist tats√§chlich eine Unterklasse von `Depends` und hat nur noch einen zus√§tzlichen Parameter, den wir sp√§ter kennenlernen werden.

Durch die Verwendung von `Security` anstelle von `Depends` wei√ü **FastAPI** jedoch, dass es Sicherheits-Scopes deklarieren, intern verwenden und die API mit OpenAPI dokumentieren kann.

Wenn Sie jedoch `Query`, `Path`, `Depends`, `Security` und andere von `fastapi` importieren, handelt es sich tats√§chlich um Funktionen, die spezielle Klassen zur√ºckgeben.

///

## `SecurityScopes` verwenden

Aktualisieren Sie nun die Abh√§ngigkeit `get_current_user`.

Das ist diejenige, die von den oben genannten Abh√§ngigkeiten verwendet wird.

Hier verwenden wir dasselbe OAuth2-Schema, das wir zuvor erstellt haben, und deklarieren es als Abh√§ngigkeit: `oauth2_scheme`.

Da diese Abh√§ngigkeitsfunktion selbst keine Scope-Anforderungen hat, k√∂nnen wir `Depends` mit `oauth2_scheme` verwenden. Wir m√ºssen `Security` nicht verwenden, wenn wir keine Sicherheits-Scopes angeben m√ºssen.

Wir deklarieren auch einen speziellen Parameter vom Typ `SecurityScopes`, der aus `fastapi.security` importiert wird.

Diese `SecurityScopes`-Klasse √§hnelt `Request` (`Request` wurde verwendet, um das Request-Objekt direkt zu erhalten).

{* ../../docs_src/security/tutorial005_an_py310.py hl[8,105] *}

## Die `scopes` verwenden

Der Parameter `security_scopes` wird vom Typ `SecurityScopes` sein.

Dieses verf√ºgt √ºber ein Attribut `scopes` mit einer Liste, die alle von ihm selbst ben√∂tigten Scopes enth√§lt und ferner alle Abh√§ngigkeiten, die dieses als Unterabh√§ngigkeit verwenden. Sprich, alle ‚ÄûDependanten‚Äú ... das mag verwirrend klingen, wird aber sp√§ter noch einmal erkl√§rt.

Das `security_scopes`-Objekt (der Klasse `SecurityScopes`) stellt au√üerdem ein `scope_str`-Attribut mit einem einzelnen String bereit, der die durch Leerzeichen getrennten Scopes enth√§lt (den werden wir verwenden).

Wir erstellen eine `HTTPException`, die wir sp√§ter an mehreren Stellen wiederverwenden (`raise`n) k√∂nnen.

In diese Exception f√ºgen wir (falls vorhanden) die erforderlichen Scopes als durch Leerzeichen getrennten String ein (unter Verwendung von `scope_str`). Wir f√ºgen diesen String mit den Scopes in den Header `WWW-Authenticate` ein (das ist Teil der Spezifikation).

{* ../../docs_src/security/tutorial005_an_py310.py hl[105,107:115] *}

## Den `username` und das Format der Daten √ºberpr√ºfen

Wir verifizieren, dass wir einen `username` erhalten, und extrahieren die Scopes.

Und dann validieren wir diese Daten mit dem Pydantic-Modell (wobei wir die `ValidationError`-Exception abfangen), und wenn wir beim Lesen des JWT-Tokens oder beim Validieren der Daten mit Pydantic einen Fehler erhalten, l√∂sen wir die zuvor erstellte `HTTPException` aus.

Dazu aktualisieren wir das Pydantic-Modell `TokenData` mit einem neuen Attribut `scopes`.

Durch die Validierung der Daten mit Pydantic k√∂nnen wir sicherstellen, dass wir beispielsweise pr√§zise eine `list`e von `str`s mit den Scopes und einen `str` mit dem `username` haben.

Anstelle beispielsweise eines `dict`s oder etwas anderem, was sp√§ter in der Anwendung zu Fehlern f√ºhren k√∂nnte und darum ein Sicherheitsrisiko darstellt.

Wir verifizieren auch, dass wir einen Benutzer mit diesem Benutzernamen haben, und wenn nicht, l√∂sen wir dieselbe Exception aus, die wir zuvor erstellt haben.

{* ../../docs_src/security/tutorial005_an_py310.py hl[46,116:127] *}

## Die `scopes` verifizieren

Wir √ºberpr√ºfen nun, ob das empfangenen Token alle Scopes enth√§lt, die von dieser Abh√§ngigkeit und deren Verwendern (einschlie√ülich *Pfadoperationen*) gefordert werden. Andernfalls l√∂sen wir eine `HTTPException` aus.

Hierzu verwenden wir `security_scopes.scopes`, das eine `list`e mit allen diesen Scopes als `str` enth√§lt.

{* ../../docs_src/security/tutorial005_an_py310.py hl[128:134] *}

## Abh√§ngigkeitsbaum und Scopes

Sehen wir uns diesen Abh√§ngigkeitsbaum und die Scopes noch einmal an.

Da die Abh√§ngigkeit `get_current_active_user` von `get_current_user` abh√§ngt, wird der bei `get_current_active_user` deklarierte Scope `"me"` in die Liste der erforderlichen Scopes in `security_scopes.scopes` aufgenommen, das an `get_current_user` √ºbergeben wird.

Die *Pfadoperation* selbst deklariert auch einen Scope, `"items"`, sodass dieser auch in der Liste der `security_scopes.scopes` enthalten ist, die an `get_current_user` √ºbergeben wird.

So sieht die Hierarchie der Abh√§ngigkeiten und Scopes aus:

* Die *Pfadoperation* `read_own_items` hat:
    * Erforderliche Scopes `["items"]` mit der Abh√§ngigkeit:
    * `get_current_active_user`:
        * Die Abh√§ngigkeitsfunktion `get_current_active_user` hat:
            * Erforderliche Scopes `["me"]` mit der Abh√§ngigkeit:
            * `get_current_user`:
                * Die Abh√§ngigkeitsfunktion `get_current_user` hat:
                    * Selbst keine erforderlichen Scopes.
                    * Eine Abh√§ngigkeit, die `oauth2_scheme` verwendet.
                    * Einen `security_scopes`-Parameter vom Typ `SecurityScopes`:
                        * Dieser `security_scopes`-Parameter hat ein Attribut `scopes` mit einer `list`e, die alle oben deklarierten Scopes enth√§lt, sprich:
                            * `security_scopes.scopes` enth√§lt `["me", "items"]` f√ºr die *Pfadoperation* `read_own_items`.
                            * `security_scopes.scopes` enth√§lt `["me"]` f√ºr die *Pfadoperation* `read_users_me`, da das in der Abh√§ngigkeit `get_current_active_user` deklariert ist.
                            * `security_scopes.scopes` wird `[]` (nichts) f√ºr die *Pfadoperation* `read_system_status` enthalten, da diese keine `Security` mit `scopes` deklariert hat, und deren Abh√§ngigkeit `get_current_user` ebenfalls keinerlei `scopes` deklariert.

/// tip | Tipp

Das Wichtige und ‚ÄûMagische‚Äú hier ist, dass `get_current_user` f√ºr jede *Pfadoperation* eine andere Liste von `scopes` hat, die √ºberpr√ºft werden.

Alles h√§ngt von den ‚ÄûScopes‚Äú ab, die in jeder *Pfadoperation* und jeder Abh√§ngigkeit im Abh√§ngigkeitsbaum f√ºr diese bestimmte *Pfadoperation* deklariert wurden.

///

## Weitere Details zu `SecurityScopes`.

Sie k√∂nnen `SecurityScopes` an jeder Stelle und an mehreren Stellen verwenden, es muss sich nicht in der ‚ÄûWurzel‚Äú-Abh√§ngigkeit befinden.

Es wird immer die Sicherheits-Scopes enthalten, die in den aktuellen `Security`-Abh√§ngigkeiten deklariert sind und in allen Abh√§ngigkeiten f√ºr **diese spezifische** *Pfadoperation* und **diesen spezifischen** Abh√§ngigkeitsbaum.

Da die `SecurityScopes` alle von den Verwendern der Abh√§ngigkeiten deklarierten Scopes enthalten, k√∂nnen Sie damit √ºberpr√ºfen, ob ein Token in einer zentralen Abh√§ngigkeitsfunktion √ºber die erforderlichen Scopes verf√ºgt, und dann unterschiedliche Scope-Anforderungen in unterschiedlichen *Pfadoperationen* deklarieren.

Diese werden f√ºr jede *Pfadoperation* unabh√§ngig √ºberpr√ºft.

## Testen Sie es

Wenn Sie die API-Dokumentation √∂ffnen, k√∂nnen Sie sich authentisieren und angeben, welche Scopes Sie autorisieren m√∂chten.

<img src="/img/tutorial/security/image11.png">

Wenn Sie keinen Scope ausw√§hlen, werden Sie ‚Äûauthentifiziert‚Äú, aber wenn Sie versuchen, auf `/users/me/` oder `/users/me/items/` zuzugreifen, wird eine Fehlermeldung angezeigt, die sagt, dass Sie nicht √ºber gen√ºgend Berechtigungen verf√ºgen. Sie k√∂nnen aber auf `/status/` zugreifen.

Und wenn Sie den Scope `me`, aber nicht den Scope `items` ausw√§hlen, k√∂nnen Sie auf `/users/me/` zugreifen, aber nicht auf `/users/me/items/`.

Das w√ºrde einer Drittanbieteranwendung passieren, die versucht, auf eine dieser *Pfadoperationen* mit einem Token zuzugreifen, das von einem Benutzer bereitgestellt wurde, abh√§ngig davon, wie viele Berechtigungen der Benutzer dieser Anwendung erteilt hat.

## √úber Integrationen von Drittanbietern

In diesem Beispiel verwenden wir den OAuth2-Flow ‚ÄûPassword‚Äú.

Das ist angemessen, wenn wir uns bei unserer eigenen Anwendung anmelden, wahrscheinlich mit unserem eigenen Frontend.

Weil wir darauf vertrauen k√∂nnen, dass es den `username` und das `password` erh√§lt, welche wir kontrollieren.

Wenn Sie jedoch eine OAuth2-Anwendung erstellen, mit der andere eine Verbindung herstellen w√ºrden (d.h. wenn Sie einen Authentifizierungsanbieter erstellen, der Facebook, Google, GitHub usw. entspricht), sollten Sie einen der anderen Flows verwenden.

Am h√§ufigsten ist der ‚ÄûImplicit‚Äú-Flow.

Am sichersten ist der ‚ÄûCode‚Äú-Flow, die Implementierung ist jedoch komplexer, da mehr Schritte erforderlich sind. Da er komplexer ist, schlagen viele Anbieter letztendlich den ‚ÄûImplicit‚Äú-Flow vor.

/// note | Hinweis

Es ist √ºblich, dass jeder Authentifizierungsanbieter seine Flows anders benennt, um sie zu einem Teil seiner Marke zu machen.

Aber am Ende implementieren sie denselben OAuth2-Standard.

///

**FastAPI** enth√§lt Werkzeuge f√ºr alle diese OAuth2-Authentifizierungs-Flows in `fastapi.security.oauth2`.

## `Security` in Dekorator-`dependencies`

Auf die gleiche Weise k√∂nnen Sie eine `list`e von `Depends` im Parameter `dependencies` des Dekorators definieren (wie in [Abh√§ngigkeiten in Pfadoperation-Dekoratoren](../../tutorial/dependencies/dependencies-in-path-operation-decorators.md){.internal-link target=_blank} erl√§utert), Sie k√∂nnten auch dort `Security` mit `scopes` verwenden.


================================================
File: /docs/de/docs/deployment/cloud.md
================================================
# FastAPI-Deployment bei Cloud-Anbietern

Sie k√∂nnen praktisch **jeden Cloud-Anbieter** f√ºr das <abbr title="Bereitstellen der fertigen Anwendung f√ºr die Endbenutzer">Deployment</abbr> Ihrer FastAPI-Anwendung verwenden.

In den meisten F√§llen verf√ºgen die Haupt-Cloud-Anbieter √ºber Anleitungen zum Deployment von FastAPI.

## Cloud-Anbieter ‚Äì Sponsoren

Einige Cloud-Anbieter ‚ú® [**sponsern FastAPI**](../help-fastapi.md#den-autor-sponsern){.internal-link target=_blank} ‚ú®, dies gew√§hrleistet die kontinuierliche und gesunde **Entwicklung** von FastAPI und seinem **√ñkosystem**.

Und es zeigt deren wahres Engagement f√ºr FastAPI und seine **Community** (Sie), da diese Ihnen nicht nur einen **guten Service** bieten m√∂chten, sondern auch sicherstellen m√∂chten, dass Sie √ºber ein **gutes und gesundes Framework** verf√ºgen, FastAPI. üôá

Vielleicht m√∂chten Sie deren Dienste ausprobieren und deren Anleitungen folgen:

* <a href="https://docs.platform.sh/languages/python.html?utm_source=fastapi-signup&utm_medium=banner&utm_campaign=FastAPI-signup-June-2023" class="external-link" target="_blank">Platform.sh</a>
* <a href="https://docs.porter.run/language-specific-guides/fastapi" class="external-link" target="_blank">Porter</a>
* <a href="https://docs.withcoherence.com/docs/configuration/frameworks?utm_medium=advertising&utm_source=fastapi&utm_campaign=banner%20january%2024#fast-api-example" class="external-link" target="_blank">Coherence</a>


================================================
File: /docs/de/docs/deployment/concepts.md
================================================
# Deployment-Konzepte

Bei dem Deployment ‚Äì der Bereitstellung ‚Äì einer **FastAPI**-Anwendung, oder eigentlich jeder Art von Web-API, gibt es mehrere Konzepte, die Sie wahrscheinlich interessieren, und mithilfe der Sie die **am besten geeignete** Methode zur **Bereitstellung Ihrer Anwendung** finden k√∂nnen.

Einige wichtige Konzepte sind:

* Sicherheit ‚Äì HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* Replikation (die Anzahl der laufenden Prozesse)
* Arbeitsspeicher
* Schritte vor dem Start

Wir werden sehen, wie diese sich auf das **Deployment** auswirken.

Letztendlich besteht das ultimative Ziel darin, **Ihre API-Clients** auf **sichere** Weise zu bedienen, um **Unterbrechungen** zu vermeiden und die **Rechenressourcen** (z. B. entfernte Server/virtuelle Maschinen) so effizient wie m√∂glich zu nutzen. üöÄ

Ich erz√§hle Ihnen hier etwas mehr √ºber diese **Konzepte**, was Ihnen hoffentlich die **Intuition** gibt, die Sie ben√∂tigen, um zu entscheiden, wie Sie Ihre API in sehr unterschiedlichen Umgebungen bereitstellen, m√∂glicherweise sogar in **zuk√ºnftigen**, die jetzt noch nicht existieren.

Durch die Ber√ºcksichtigung dieser Konzepte k√∂nnen Sie die beste Variante der Bereitstellung **Ihrer eigenen APIs** **evaluieren und konzipieren**.

In den n√§chsten Kapiteln werde ich Ihnen mehr **konkrete Rezepte** f√ºr die Bereitstellung von FastAPI-Anwendungen geben.

Aber schauen wir uns zun√§chst einmal diese grundlegenden **konzeptionellen Ideen** an. Diese Konzepte gelten auch f√ºr jede andere Art von Web-API. üí°

## Sicherheit ‚Äì HTTPS

Im [vorherigen Kapitel √ºber HTTPS](https.md){.internal-link target=_blank} haben wir erfahren, wie HTTPS Verschl√ºsselung f√ºr Ihre API bereitstellt.

Wir haben auch gesehen, dass HTTPS normalerweise von einer Komponente **au√üerhalb** Ihres Anwendungsservers bereitgestellt wird, einem **TLS-Terminierungsproxy**.

Und es muss etwas geben, das f√ºr die **Erneuerung der HTTPS-Zertifikate** zust√§ndig ist, es k√∂nnte sich um dieselbe Komponente handeln oder um etwas anderes.

### Beispieltools f√ºr HTTPS

Einige der Tools, die Sie als TLS-Terminierungsproxy verwenden k√∂nnen, sind:

* Traefik
    * Handhabt automatisch Zertifikat-Erneuerungen ‚ú®
* Caddy
    * Handhabt automatisch Zertifikat-Erneuerungen ‚ú®
* Nginx
    * Mit einer externen Komponente wie Certbot f√ºr Zertifikat-Erneuerungen
* HAProxy
    * Mit einer externen Komponente wie Certbot f√ºr Zertifikat-Erneuerungen
* Kubernetes mit einem Ingress Controller wie Nginx
    * Mit einer externen Komponente wie cert-manager f√ºr Zertifikat-Erneuerungen
* Es wird intern von einem Cloud-Anbieter als Teil seiner Dienste verwaltet (siehe unten üëá)

Eine andere M√∂glichkeit besteht darin, dass Sie einen **Cloud-Dienst** verwenden, der den gr√∂√üten Teil der Arbeit √ºbernimmt, einschlie√ülich der Einrichtung von HTTPS. Er k√∂nnte einige Einschr√§nkungen haben oder Ihnen mehr in Rechnung stellen, usw. In diesem Fall m√ºssten Sie jedoch nicht selbst einen TLS-Terminierungsproxy einrichten.

In den n√§chsten Kapiteln zeige ich Ihnen einige konkrete Beispiele.

---

Die n√§chsten zu ber√ºcksichtigenden Konzepte drehen sich dann um das Programm, das Ihre eigentliche API ausf√ºhrt (z. B. Uvicorn).

## Programm und Prozess

Wir werden viel √ºber den laufenden ‚Äû**Prozess**‚Äú sprechen, daher ist es n√ºtzlich, Klarheit dar√ºber zu haben, was das bedeutet und was der Unterschied zum Wort ‚Äû**Programm**‚Äú ist.

### Was ist ein Programm?

Das Wort **Programm** wird h√§ufig zur Beschreibung vieler Dinge verwendet:

* Der **Code**, den Sie schreiben, die **Python-Dateien**.
* Die **Datei**, die vom Betriebssystem **ausgef√ºhrt** werden kann, zum Beispiel: `python`, `python.exe` oder `uvicorn`.
* Ein bestimmtes Programm, w√§hrend es auf dem Betriebssystem **l√§uft**, die CPU nutzt und Dinge im Arbeitsspeicher ablegt. Dies wird auch als **Prozess** bezeichnet.

### Was ist ein Prozess?

Das Wort **Prozess** wird normalerweise spezifischer verwendet und bezieht sich nur auf das, was im Betriebssystem ausgef√ºhrt wird (wie im letzten Punkt oben):

* Ein bestimmtes Programm, w√§hrend es auf dem Betriebssystem **ausgef√ºhrt** wird.
    * Dies bezieht sich weder auf die Datei noch auf den Code, sondern **speziell** auf das, was vom Betriebssystem **ausgef√ºhrt** und verwaltet wird.
* Jedes Programm, jeder Code **kann nur dann Dinge tun**, wenn er **ausgef√ºhrt** wird, wenn also ein **Prozess l√§uft**.
* Der Prozess kann von Ihnen oder vom Betriebssystem **terminiert** (‚Äûbeendet‚Äú, ‚Äûgekillt‚Äú) werden. An diesem Punkt h√∂rt es auf zu laufen/ausgef√ºhrt zu werden und kann **keine Dinge mehr tun**.
* Hinter jeder Anwendung, die Sie auf Ihrem Computer ausf√ºhren, steckt ein Prozess, jedes laufende Programm, jedes Fenster usw. Und normalerweise laufen viele Prozesse **gleichzeitig**, w√§hrend ein Computer eingeschaltet ist.
* Es k√∂nnen **mehrere Prozesse** desselben **Programms** gleichzeitig ausgef√ºhrt werden.

Wenn Sie sich den ‚ÄûTask-Manager‚Äú oder ‚ÄûSystemmonitor‚Äú (oder √§hnliche Tools) in Ihrem Betriebssystem ansehen, k√∂nnen Sie viele dieser laufenden Prozesse sehen.

Und Sie werden beispielsweise wahrscheinlich feststellen, dass mehrere Prozesse dasselbe Browserprogramm ausf√ºhren (Firefox, Chrome, Edge, usw.). Normalerweise f√ºhren diese einen Prozess pro Browsertab sowie einige andere zus√§tzliche Prozesse aus.

<img class="shadow" src="/img/deployment/concepts/image01.png">

---

Nachdem wir nun den Unterschied zwischen den Begriffen **Prozess** und **Programm** kennen, sprechen wir weiter √ºber das Deployment.

## Beim Hochfahren ausf√ºhren

Wenn Sie eine Web-API erstellen, m√∂chten Sie in den meisten F√§llen, dass diese **immer l√§uft**, ununterbrochen, damit Ihre Clients immer darauf zugreifen k√∂nnen. Es sei denn nat√ºrlich, Sie haben einen bestimmten Grund, warum Sie m√∂chten, dass diese nur in bestimmten Situationen ausgef√ºhrt wird. Meistens m√∂chten Sie jedoch, dass sie st√§ndig ausgef√ºhrt wird und **verf√ºgbar** ist.

### Auf einem entfernten Server

Wenn Sie einen entfernten Server (einen Cloud-Server, eine virtuelle Maschine, usw.) einrichten, k√∂nnen Sie am einfachsten Uvicorn (oder √§hnliches) manuell ausf√ºhren, genau wie bei der lokalen Entwicklung.

Und es wird funktionieren und **w√§hrend der Entwicklung** n√ºtzlich sein.

Wenn Ihre Verbindung zum Server jedoch unterbrochen wird, wird der **laufende Prozess** wahrscheinlich abst√ºrzen.

Und wenn der Server neu gestartet wird (z. B. nach Updates oder Migrationen vom Cloud-Anbieter), werden Sie das wahrscheinlich **nicht bemerken**. Und deshalb wissen Sie nicht einmal, dass Sie den Prozess manuell neu starten m√ºssen. Ihre API bleibt also einfach tot. üò±

### Beim Hochfahren automatisch ausf√ºhren

Im Allgemeinen m√∂chten Sie wahrscheinlich, dass das Serverprogramm (z. B. Uvicorn) beim Hochfahren des Servers automatisch gestartet wird und kein **menschliches Eingreifen** erforderlich ist, sodass immer ein Prozess mit Ihrer API ausgef√ºhrt wird (z. B. Uvicorn, welches Ihre FastAPI-Anwendung ausf√ºhrt).

### Separates Programm

Um dies zu erreichen, haben Sie normalerweise ein **separates Programm**, welches sicherstellt, dass Ihre Anwendung beim Hochfahren ausgef√ºhrt wird. Und in vielen F√§llen w√ºrde es auch sicherstellen, dass auch andere Komponenten oder Anwendungen ausgef√ºhrt werden, beispielsweise eine Datenbank.

### Beispieltools zur Ausf√ºhrung beim Hochfahren

Einige Beispiele f√ºr Tools, die diese Aufgabe √ºbernehmen k√∂nnen, sind:

* Docker
* Kubernetes
* Docker Compose
* Docker im Schwarm-Modus
* Systemd
* Supervisor
* Es wird intern von einem Cloud-Anbieter im Rahmen seiner Dienste verwaltet
* Andere ...

In den n√§chsten Kapiteln werde ich Ihnen konkretere Beispiele geben.

## Neustart

√Ñhnlich wie Sie sicherstellen m√∂chten, dass Ihre Anwendung beim Hochfahren ausgef√ºhrt wird, m√∂chten Sie wahrscheinlich auch sicherstellen, dass diese nach Fehlern **neu gestartet** wird.

### Wir machen Fehler

Wir, als Menschen, machen st√§ndig **Fehler**. Software hat fast *immer* **Bugs**, die an verschiedenen Stellen versteckt sind. üêõ

Und wir als Entwickler verbessern den Code st√§ndig, wenn wir diese Bugs finden und neue Funktionen implementieren (und m√∂glicherweise auch neue Bugs hinzuf√ºgen üòÖ).

### Kleine Fehler automatisch handhaben

Wenn beim Erstellen von Web-APIs mit FastAPI ein Fehler in unserem Code auftritt, wird FastAPI ihn normalerweise dem einzelnen Request zur√ºckgeben, der den Fehler ausgel√∂st hat. üõ°

Der Client erh√§lt f√ºr diesen Request einen **500 Internal Server Error**, aber die Anwendung arbeitet bei den n√§chsten Requests weiter, anstatt einfach komplett abzust√ºrzen.

### Gr√∂√üere Fehler ‚Äì Abst√ºrze

Dennoch kann es vorkommen, dass wir Code schreiben, der **die gesamte Anwendung zum Absturz bringt** und so zum Absturz von Uvicorn und Python f√ºhrt. üí•

Und dennoch m√∂chten Sie wahrscheinlich nicht, dass die Anwendung tot bleibt, weil an einer Stelle ein Fehler aufgetreten ist. Sie m√∂chten wahrscheinlich, dass sie zumindest f√ºr die *Pfadoperationen*, die nicht fehlerhaft sind, **weiterl√§uft**.

### Neustart nach Absturz

Aber in den F√§llen mit wirklich schwerwiegenden Fehlern, die den laufenden **Prozess** zum Absturz bringen, ben√∂tigen Sie eine externe Komponente, die den Prozess **neu startet**, zumindest ein paar Mal ...

/// tip | Tipp

... Obwohl es wahrscheinlich keinen Sinn macht, sie immer wieder neu zu starten, wenn die gesamte Anwendung einfach **sofort abst√ºrzt**. Aber in diesen F√§llen werden Sie es wahrscheinlich w√§hrend der Entwicklung oder zumindest direkt nach dem Deployment bemerken.

Konzentrieren wir uns also auf die Hauptf√§lle, in denen die Anwendung in bestimmten F√§llen **in der Zukunft** v√∂llig abst√ºrzen k√∂nnte und es dann dennoch sinnvoll ist, sie neu zu starten.

///

Sie m√∂chten wahrscheinlich, dass eine **externe Komponente** f√ºr den Neustart Ihrer Anwendung verantwortlich ist, da zu diesem Zeitpunkt dieselbe Anwendung mit Uvicorn und Python bereits abgest√ºrzt ist und es daher nichts im selben Code derselben Anwendung gibt, was etwas dagegen tun kann.

### Beispieltools zum automatischen Neustart

In den meisten F√§llen wird dasselbe Tool, das zum **Ausf√ºhren des Programms beim Hochfahren** verwendet wird, auch f√ºr automatische **Neustarts** verwendet.

Dies k√∂nnte zum Beispiel erledigt werden durch:

* Docker
* Kubernetes
* Docker Compose
* Docker im Schwarm-Modus
* Systemd
* Supervisor
* Intern von einem Cloud-Anbieter im Rahmen seiner Dienste
* Andere ...

## Replikation ‚Äì Prozesse und Arbeitsspeicher

Wenn Sie eine FastAPI-Anwendung verwenden und ein Serverprogramm wie Uvicorn verwenden, kann **ein einzelner Prozess** mehrere Clients gleichzeitig bedienen.

In vielen F√§llen m√∂chten Sie jedoch mehrere Prozesse gleichzeitig ausf√ºhren.

### Mehrere Prozesse ‚Äì Worker

Wenn Sie mehr Clients haben, als ein einzelner Prozess verarbeiten kann (z. B. wenn die virtuelle Maschine nicht sehr gro√ü ist) und die CPU des Servers **mehrere Kerne** hat, dann k√∂nnten **mehrere Prozesse** gleichzeitig mit derselben Anwendung laufen und alle Requests unter sich verteilen.

Wenn Sie mit **mehreren Prozessen** dasselbe API-Programm ausf√ºhren, werden diese √ºblicherweise als **<abbr title="Arbeiter">Worker</abbr>** bezeichnet.

### Workerprozesse und Ports

Erinnern Sie sich aus der Dokumentation [√úber HTTPS](https.md){.internal-link target=_blank}, dass nur ein Prozess auf einer Kombination aus Port und IP-Adresse auf einem Server lauschen kann?

Das ist immer noch wahr.

Um also **mehrere Prozesse** gleichzeitig zu haben, muss es einen **einzelnen Prozess geben, der einen Port √ºberwacht**, welcher dann die Kommunikation auf irgendeine Weise an jeden Workerprozess √ºbertr√§gt.

### Arbeitsspeicher pro Prozess

Wenn das Programm nun Dinge in den Arbeitsspeicher l√§dt, zum Beispiel ein Modell f√ºr maschinelles Lernen in einer Variablen oder den Inhalt einer gro√üen Datei in einer Variablen, verbraucht das alles **einen Teil des Arbeitsspeichers (RAM ‚Äì Random Access Memory)** des Servers.

Und mehrere Prozesse teilen sich normalerweise keinen Speicher. Das bedeutet, dass jeder laufende Prozess seine eigenen Dinge, eigenen Variablen und eigenen Speicher hat. Und wenn Sie in Ihrem Code viel Speicher verbrauchen, verbraucht **jeder Prozess** die gleiche Menge Speicher.

### Serverspeicher

Wenn Ihr Code beispielsweise ein Machine-Learning-Modell mit **1 GB Gr√∂√üe** l√§dt und Sie einen Prozess mit Ihrer API ausf√ºhren, verbraucht dieser mindestens 1 GB RAM. Und wenn Sie **4 Prozesse** (4 Worker) starten, verbraucht jeder 1 GB RAM. Insgesamt verbraucht Ihre API also **4 GB RAM**.

Und wenn Ihr entfernter Server oder Ihre virtuelle Maschine nur √ºber 3 GB RAM verf√ºgt, f√ºhrt der Versuch, mehr als 4 GB RAM zu laden, zu Problemen. üö®

### Mehrere Prozesse ‚Äì Ein Beispiel

Im folgenden Beispiel gibt es einen **Manager-Prozess**, welcher zwei **Workerprozesse** startet und steuert.

Dieser Manager-Prozess w√§re wahrscheinlich derjenige, welcher der IP am **Port** lauscht. Und er w√ºrde die gesamte Kommunikation an die Workerprozesse weiterleiten.

Diese Workerprozesse w√ºrden Ihre Anwendung ausf√ºhren, sie w√ºrden die Hauptberechnungen durchf√ºhren, um einen **Request** entgegenzunehmen und eine **Response** zur√ºckzugeben, und sie w√ºrden alles, was Sie in Variablen einf√ºgen, in den RAM laden.

<img src="/img/deployment/concepts/process-ram.svg">

Und nat√ºrlich w√ºrden auf derselben Maschine neben Ihrer Anwendung wahrscheinlich auch **andere Prozesse** laufen.

Ein interessantes Detail ist dabei, dass der Prozentsatz der von jedem Prozess verwendeten **CPU** im Laufe der Zeit stark **variieren** kann, der **Arbeitsspeicher (RAM)** jedoch normalerweise mehr oder weniger **stabil** bleibt.

Wenn Sie eine API haben, die jedes Mal eine vergleichbare Menge an Berechnungen durchf√ºhrt, und Sie viele Clients haben, dann wird die **CPU-Auslastung** wahrscheinlich *ebenfalls stabil sein* (anstatt st√§ndig schnell zu steigen und zu fallen).

### Beispiele f√ºr Replikation-Tools und -Strategien

Es gibt mehrere Ans√§tze, um dies zu erreichen, und ich werde Ihnen in den n√§chsten Kapiteln mehr √ºber bestimmte Strategien erz√§hlen, beispielsweise wenn es um Docker und Container geht.

Die wichtigste zu ber√ºcksichtigende Einschr√§nkung besteht darin, dass es eine **einzelne** Komponente geben muss, welche die **√∂ffentliche IP** auf dem **Port** verwaltet. Und dann muss diese irgendwie die Kommunikation **weiterleiten**, an die replizierten **Prozesse/Worker**.

Hier sind einige m√∂gliche Kombinationen und Strategien:

* **Gunicorn**, welches **Uvicorn-Worker** managt
    * Gunicorn w√§re der **Prozessmanager**, der die **IP** und den **Port** √ºberwacht, die Replikation w√ºrde durch **mehrere Uvicorn-Workerprozesse** erfolgen
* **Uvicorn**, welches **Uvicorn-Worker** managt
    * Ein Uvicorn-**Prozessmanager** w√ºrde der **IP** am **Port** lauschen, und er w√ºrde **mehrere Uvicorn-Workerprozesse** starten.
* **Kubernetes** und andere verteilte **Containersysteme**
    * Etwas in der **Kubernetes**-Ebene w√ºrde die **IP** und den **Port** abh√∂ren. Die Replikation h√§tte **mehrere Container**, in jedem wird jeweils **ein Uvicorn-Prozess** ausgef√ºhrt.
* **Cloud-Dienste**, welche das f√ºr Sie erledigen
    * Der Cloud-Dienst wird wahrscheinlich **die Replikation f√ºr Sie √ºbernehmen**. Er w√ºrde Sie m√∂glicherweise **einen auszuf√ºhrenden Prozess** oder ein **zu verwendendes Container-Image** definieren lassen, in jedem Fall w√§re es h√∂chstwahrscheinlich **ein einzelner Uvicorn-Prozess**, und der Cloud-Dienst w√§re auch verantwortlich f√ºr die Replikation.

/// tip | Tipp

Machen Sie sich keine Sorgen, wenn einige dieser Punkte zu **Containern**, Docker oder Kubernetes noch nicht viel Sinn ergeben.

Ich werde Ihnen in einem zuk√ºnftigen Kapitel mehr √ºber Container-Images, Docker, Kubernetes, usw. erz√§hlen: [FastAPI in Containern ‚Äì Docker](docker.md){.internal-link target=_blank}.

///

## Schritte vor dem Start

Es gibt viele F√§lle, in denen Sie, **bevor Sie Ihre Anwendung starten**, einige Schritte ausf√ºhren m√∂chten.

Beispielsweise m√∂chten Sie m√∂glicherweise **Datenbankmigrationen** ausf√ºhren.

In den meisten F√§llen m√∂chten Sie diese Schritte jedoch nur **einmal** ausf√ºhren.

Sie m√∂chten also einen **einzelnen Prozess** haben, um diese **Vorab-Schritte** auszuf√ºhren, bevor Sie die Anwendung starten.

Und Sie m√ºssen sicherstellen, dass es sich um einen einzelnen Prozess handelt, der die Vorab-Schritte ausf√ºhrt, *auch* wenn Sie anschlie√üend **mehrere Prozesse** (mehrere Worker) f√ºr die Anwendung selbst starten. Wenn diese Schritte von **mehreren Prozessen** ausgef√ºhrt w√ºrden, w√ºrden diese die Arbeit **verdoppeln**, indem sie sie **parallel** ausf√ºhren, und wenn es sich bei den Schritten um etwas Delikates wie eine Datenbankmigration handelt, k√∂nnte das miteinander Konflikte verursachen.

Nat√ºrlich gibt es F√§lle, in denen es kein Problem darstellt, die Vorab-Schritte mehrmals auszuf√ºhren. In diesem Fall ist die Handhabung viel einfacher.

/// tip | Tipp

Bedenken Sie au√üerdem, dass Sie, abh√§ngig von Ihrer Einrichtung, in manchen F√§llen **gar keine Vorab-Schritte** ben√∂tigen, bevor Sie die Anwendung starten.

In diesem Fall m√ºssen Sie sich dar√ºber keine Sorgen machen. ü§∑

///

### Beispiele f√ºr Strategien f√ºr Vorab-Schritte

Es h√§ngt **stark** davon ab, wie Sie **Ihr System bereitstellen**, und h√§ngt wahrscheinlich mit der Art und Weise zusammen, wie Sie Programme starten, Neustarts durchf√ºhren, usw.

Hier sind einige m√∂gliche Ideen:

* Ein ‚ÄûInit-Container‚Äú in Kubernetes, der vor Ihrem Anwendungs-Container ausgef√ºhrt wird
* Ein Bash-Skript, das die Vorab-Schritte ausf√ºhrt und dann Ihre Anwendung startet
    * Sie ben√∂tigen immer noch eine M√∂glichkeit, *dieses* Bash-Skript zu starten/neu zu starten, Fehler zu erkennen, usw.

/// tip | Tipp

Konkretere Beispiele hierf√ºr mit Containern gebe ich Ihnen in einem sp√§teren Kapitel: [FastAPI in Containern ‚Äì Docker](docker.md){.internal-link target=_blank}.

///

## Ressourcennutzung

Ihr(e) Server ist (sind) eine **Ressource**, welche Sie mit Ihren Programmen, der Rechenzeit auf den CPUs und dem verf√ºgbaren RAM-Speicher verbrauchen oder **nutzen** k√∂nnen.

Wie viele Systemressourcen m√∂chten Sie verbrauchen/nutzen? Sie m√∂gen ‚Äûnicht viel‚Äú denken, aber in Wirklichkeit m√∂chten Sie tats√§chlich **so viel wie m√∂glich ohne Absturz** verwenden.

Wenn Sie f√ºr drei Server bezahlen, aber nur wenig von deren RAM und CPU nutzen, **verschwenden Sie wahrscheinlich Geld** üí∏ und wahrscheinlich **Strom f√ºr den Server** üåé, usw.

In diesem Fall k√∂nnte es besser sein, nur zwei Server zu haben und einen h√∂heren Prozentsatz von deren Ressourcen zu nutzen (CPU, Arbeitsspeicher, Festplatte, Netzwerkbandbreite, usw.).

Wenn Sie andererseits √ºber zwei Server verf√ºgen und **100 % ihrer CPU und ihres RAM** nutzen, wird irgendwann ein Prozess nach mehr Speicher fragen und der Server muss die Festplatte als ‚ÄûSpeicher‚Äú verwenden (was tausendmal langsamer sein kann) oder er k√∂nnte sogar **abst√ºrzen**. Oder ein Prozess muss m√∂glicherweise einige Berechnungen durchf√ºhren und m√ºsste warten, bis die CPU wieder frei ist.

In diesem Fall w√§re es besser, **einen zus√§tzlichen Server** zu besorgen und einige Prozesse darauf auszuf√ºhren, damit alle √ºber **genug RAM und CPU-Zeit** verf√ºgen.

Es besteht auch die M√∂glichkeit, dass es aus irgendeinem Grund zu **Spitzen** in der Nutzung Ihrer API kommt. Vielleicht ist diese viral gegangen, oder vielleicht haben andere Dienste oder Bots damit begonnen, sie zu nutzen. Und vielleicht m√∂chten Sie in solchen F√§llen √ºber zus√§tzliche Ressourcen verf√ºgen, um auf der sicheren Seite zu sein.

Sie k√∂nnen eine **beliebige Zahl** festlegen, um beispielsweise eine Ressourcenauslastung zwischen **50¬†% und 90¬†%** anzustreben. Der Punkt ist, dass dies wahrscheinlich die wichtigen Dinge sind, die Sie messen und verwenden sollten, um Ihre Deployments zu optimieren.

Sie k√∂nnen einfache Tools wie `htop` verwenden, um die in Ihrem Server verwendete CPU und den RAM oder die von jedem Prozess verwendete Menge anzuzeigen. Oder Sie k√∂nnen komplexere √úberwachungstools verwenden, die m√∂glicherweise auf mehrere Server usw. verteilt sind.

## Zusammenfassung

Sie haben hier einige der wichtigsten Konzepte gelesen, die Sie wahrscheinlich ber√ºcksichtigen m√ºssen, wenn Sie entscheiden, wie Sie Ihre Anwendung bereitstellen:

* Sicherheit ‚Äì HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* Replikation (die Anzahl der laufenden Prozesse)
* Arbeitsspeicher
* Schritte vor dem Start

Das Verst√§ndnis dieser Ideen und deren Anwendung sollte Ihnen die n√∂tige Intuition vermitteln, um bei der Konfiguration und Optimierung Ihrer Deployments Entscheidungen zu treffen. ü§ì

In den n√§chsten Abschnitten gebe ich Ihnen konkretere Beispiele f√ºr m√∂gliche Strategien, die Sie verfolgen k√∂nnen. üöÄ


================================================
File: /docs/de/docs/deployment/docker.md
================================================
# FastAPI in Containern ‚Äì Docker

Beim Deployment von FastAPI-Anwendungen besteht ein g√§ngiger Ansatz darin, ein **Linux-Containerimage** zu erstellen. Normalerweise erfolgt dies mit <a href="https://www.docker.com/" class="external-link" target="_blank">**Docker**</a>. Sie k√∂nnen dieses Containerimage dann auf eine von mehreren m√∂glichen Arten bereitstellen.

Die Verwendung von Linux-Containern bietet mehrere Vorteile, darunter **Sicherheit**, **Replizierbarkeit**, **Einfachheit** und andere.

/// tip | Tipp

Sie haben es eilig und kennen sich bereits aus? Springen Sie zum [`Dockerfile` unten üëá](#ein-docker-image-fur-fastapi-erstellen).

///

<Details>
<summary>Dockerfile-Vorschau üëÄ</summary>

```Dockerfile
FROM python:3.9

WORKDIR /code

COPY ./requirements.txt /code/requirements.txt

RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt

COPY ./app /code/app

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "80"]

# Wenn Sie hinter einem Proxy wie Nginx oder Traefik sind, f√ºgen Sie --proxy-headers hinzu
# CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "80", "--proxy-headers"]
```

</details>

## Was ist ein Container?

Container (haupts√§chlich Linux-Container) sind eine sehr **leichtgewichtige** M√∂glichkeit, Anwendungen einschlie√ülich aller ihrer Abh√§ngigkeiten und erforderlichen Dateien zu verpacken und sie gleichzeitig von anderen Containern (anderen Anwendungen oder Komponenten) im selben System isoliert zu halten.

Linux-Container werden mit demselben Linux-Kernel des Hosts (Maschine, virtuellen Maschine, Cloud-Servers, usw.) ausgef√ºhrt. Das bedeutet einfach, dass sie sehr leichtgewichtig sind (im Vergleich zu vollst√§ndigen virtuellen Maschinen, die ein gesamtes Betriebssystem emulieren).

Auf diese Weise verbrauchen Container **wenig Ressourcen**, eine Menge vergleichbar mit der direkten Ausf√ºhrung der Prozesse (eine virtuelle Maschine w√ºrde viel mehr verbrauchen).

Container verf√ºgen au√üerdem √ºber ihre eigenen **isoliert** laufenden Prozesse (√ºblicherweise nur einen Prozess), √ºber ihr eigenes Dateisystem und ihr eigenes Netzwerk, was die Bereitstellung, Sicherheit, Entwicklung usw. vereinfacht.

## Was ist ein Containerimage?

Ein **Container** wird von einem **Containerimage** ausgef√ºhrt.

Ein Containerimage ist eine **statische** Version aller Dateien, Umgebungsvariablen und des Standardbefehls/-programms, welche in einem Container vorhanden sein sollten. **Statisch** bedeutet hier, dass das Container-**Image** nicht l√§uft, nicht ausgef√ºhrt wird, sondern nur die gepackten Dateien und Metadaten enth√§lt.

Im Gegensatz zu einem ‚Äû**Containerimage**‚Äú, bei dem es sich um den gespeicherten statischen Inhalt handelt, bezieht sich ein ‚Äû**Container**‚Äú normalerweise auf die laufende Instanz, das Ding, das **ausgef√ºhrt** wird.

Wenn der **Container** gestartet und ausgef√ºhrt wird (gestartet von einem **Containerimage**), kann er Dateien, Umgebungsvariablen usw. erstellen oder √§ndern. Diese √Ñnderungen sind nur in diesem Container vorhanden, nicht im zugrunde liegenden bestehen Containerimage (werden nicht auf der Festplatte gespeichert).

Ein Containerimage ist vergleichbar mit der **Programmdatei** und ihrem Inhalt, z. B. `python` und eine Datei `main.py`.

Und der **Container** selbst (im Gegensatz zum **Containerimage**) ist die tats√§chlich laufende Instanz des Images, vergleichbar mit einem **Prozess**. Tats√§chlich l√§uft ein Container nur, wenn er einen **laufenden Prozess** hat (und normalerweise ist es nur ein einzelner Prozess). Der Container stoppt, wenn kein Prozess darin ausgef√ºhrt wird.

## Containerimages

Docker ist eines der wichtigsten Tools zum Erstellen und Verwalten von **Containerimages** und **Containern**.

Und es gibt einen √∂ffentlichen <a href="https://hub.docker.com/" class="external-link" target="_blank">Docker <abbr title="Umschlagsplatz">Hub</abbr></a> mit vorgefertigten **offiziellen Containerimages** f√ºr viele Tools, Umgebungen, Datenbanken und Anwendungen.

Beispielsweise gibt es ein offizielles <a href="https://hub.docker.com/_/python" class="external-link" target="_blank">Python-Image</a>.

Und es gibt viele andere Images f√ºr verschiedene Dinge wie Datenbanken, zum Beispiel f√ºr:

* <a href="https://hub.docker.com/_/postgres" class="external-link" target="_blank">PostgreSQL</a>
* <a href="https://hub.docker.com/_/mysql" class="external-link" target="_blank">MySQL</a>
* <a href="https://hub.docker.com/_/mongo" class="external-link" target="_blank">MongoDB</a>
* <a href="https://hub.docker.com/_/redis" class="external-link" target="_blank">Redis</a>, usw.

Durch die Verwendung eines vorgefertigten Containerimages ist es sehr einfach, verschiedene Tools zu **kombinieren** und zu verwenden. Zum Beispiel, um eine neue Datenbank auszuprobieren. In den meisten F√§llen k√∂nnen Sie die **offiziellen Images** verwenden und diese einfach mit Umgebungsvariablen konfigurieren.

Auf diese Weise k√∂nnen Sie in vielen F√§llen etwas √ºber Container und Docker lernen und dieses Wissen mit vielen verschiedenen Tools und Komponenten wiederverwenden.

Sie w√ºrden also **mehrere Container** mit unterschiedlichen Dingen ausf√ºhren, wie einer Datenbank, einer Python-Anwendung, einem Webserver mit einer React-Frontend-Anwendung, und diese √ºber ihr internes Netzwerk miteinander verbinden.

In alle Containerverwaltungssysteme (wie Docker oder Kubernetes) sind diese Netzwerkfunktionen integriert.

## Container und Prozesse

Ein **Containerimage** enth√§lt normalerweise in seinen Metadaten das Standardprogramm oder den Standardbefehl, der ausgef√ºhrt werden soll, wenn der **Container** gestartet wird, sowie die Parameter, die an dieses Programm √ºbergeben werden sollen. Sehr √§hnlich zu dem, was w√§re, wenn es √ºber die Befehlszeile gestartet werden w√ºrde.

Wenn ein **Container** gestartet wird, f√ºhrt er diesen Befehl/dieses Programm aus (Sie k√∂nnen ihn jedoch √ºberschreiben und einen anderen Befehl/ein anderes Programm ausf√ºhren lassen).

Ein Container l√§uft, solange der **Hauptprozess** (Befehl oder Programm) l√§uft.

Ein Container hat normalerweise einen **einzelnen Prozess**, aber es ist auch m√∂glich, Unterprozesse vom Hauptprozess aus zu starten, und auf diese Weise haben Sie **mehrere Prozesse** im selben Container.

Es ist jedoch nicht m√∂glich, einen laufenden Container, ohne **mindestens einen laufenden Prozess** zu haben. Wenn der Hauptprozess stoppt, stoppt der Container.

## Ein Docker-Image f√ºr FastAPI erstellen

Okay, wollen wir jetzt etwas bauen! üöÄ

Ich zeige Ihnen, wie Sie ein **Docker-Image** f√ºr FastAPI **von Grund auf** erstellen, basierend auf dem **offiziellen Python**-Image.

Das ist, was Sie in **den meisten F√§llen** tun m√∂chten, zum Beispiel:

* Bei Verwendung von **Kubernetes** oder √§hnlichen Tools
* Beim Betrieb auf einem **Raspberry Pi**
* Bei Verwendung eines Cloud-Dienstes, der ein Containerimage f√ºr Sie ausf√ºhrt, usw.

### Paketanforderungen

Normalerweise befinden sich die **Paketanforderungen** f√ºr Ihre Anwendung in einer Datei.

Dies h√§ngt haupts√§chlich von dem Tool ab, mit dem Sie diese Anforderungen **installieren**.

Die gebr√§uchlichste Methode besteht darin, eine Datei `requirements.txt` mit den Namen der Packages und deren Versionen zu erstellen, eine pro Zeile.

Sie w√ºrden nat√ºrlich die gleichen Ideen verwenden, die Sie in [√úber FastAPI-Versionen](versions.md){.internal-link target=_blank} gelesen haben, um die Versionsbereiche festzulegen.

Ihre `requirements.txt` k√∂nnte beispielsweise so aussehen:

```
fastapi>=0.68.0,<0.69.0
pydantic>=1.8.0,<2.0.0
uvicorn>=0.15.0,<0.16.0
```

Und normalerweise w√ºrden Sie diese Paketabh√§ngigkeiten mit `pip` installieren, zum Beispiel:

<div class="termy">

```console
$ pip install -r requirements.txt
---> 100%
Successfully installed fastapi pydantic uvicorn
```

</div>

/// info

Es gibt andere Formate und Tools zum Definieren und Installieren von Paketabh√§ngigkeiten.

Ich zeige Ihnen sp√§ter in einem Abschnitt unten ein Beispiel unter Verwendung von Poetry. üëá

///

### Den **FastAPI**-Code erstellen

* Erstellen Sie ein `app`-Verzeichnis und betreten Sie es.
* Erstellen Sie eine leere Datei `__init__.py`.
* Erstellen Sie eine `main.py`-Datei mit:

```Python
from typing import Union

from fastapi import FastAPI

app = FastAPI()


@app.get("/")
def read_root():
    return {"Hello": "World"}


@app.get("/items/{item_id}")
def read_item(item_id: int, q: Union[str, None] = None):
    return {"item_id": item_id, "q": q}
```

### Dockerfile

Erstellen Sie nun im selben Projektverzeichnis eine Datei `Dockerfile` mit:

```{ .dockerfile .annotate }
# (1)
FROM python:3.9

# (2)
WORKDIR /code

# (3)
COPY ./requirements.txt /code/requirements.txt

# (4)
RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt

# (5)
COPY ./app /code/app

# (6)
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "80"]
```

1. Beginne mit dem offiziellen Python-Basisimage.

2. Setze das aktuelle Arbeitsverzeichnis auf `/code`.

    Hier plazieren wir die Datei `requirements.txt` und das Verzeichnis `app`.

3. Kopiere die Datei mit den Paketanforderungen in das Verzeichnis `/code`.

    Kopieren Sie zuerst **nur** die Datei mit den Anforderungen, nicht den Rest des Codes.

    Da sich diese Datei **nicht oft √§ndert**, erkennt Docker das und verwendet den **Cache** f√ºr diesen Schritt, wodurch der Cache auch f√ºr den n√§chsten Schritt aktiviert wird.

4. Installiere die Paketabh√§ngigkeiten aus der Anforderungsdatei.

    Die Option `--no-cache-dir` weist `pip` an, die heruntergeladenen Pakete nicht lokal zu speichern, da dies nur ben√∂tigt wird, sollte `pip` erneut ausgef√ºhrt werden, um dieselben Pakete zu installieren, aber das ist beim Arbeiten mit Containern nicht der Fall.

    /// note | Hinweis

    Das `--no-cache-dir` bezieht sich nur auf `pip`, es hat nichts mit Docker oder Containern zu tun.

    ///

    Die Option `--upgrade` weist `pip` an, die Packages zu aktualisieren, wenn sie bereits installiert sind.

    Da der vorherige Schritt des Kopierens der Datei vom **Docker-Cache** erkannt werden konnte, wird dieser Schritt auch **den Docker-Cache verwenden**, sofern verf√ºgbar.

    Durch die Verwendung des Caches in diesem Schritt **sparen** Sie viel **Zeit**, wenn Sie das Image w√§hrend der Entwicklung immer wieder erstellen, anstatt **jedes Mal** alle Abh√§ngigkeiten **herunterzuladen und zu installieren**.

5. Kopiere das Verzeichnis `./app` in das Verzeichnis `/code`.

    Da hier der gesamte Code enthalten ist, der sich **am h√§ufigsten √§ndert**, wird der Docker-**Cache** nicht ohne weiteres f√ºr diesen oder andere **folgende Schritte** verwendet.

    Daher ist es wichtig, dies **nahe dem Ende** des `Dockerfile`s zu platzieren, um die Erstellungszeiten des Containerimages zu optimieren.

6. Lege den **Befehl** fest, um den `uvicorn`-Server zu starten.

    `CMD` nimmt eine Liste von Zeichenfolgen entgegen. Jede dieser Zeichenfolgen entspricht dem, was Sie durch Leerzeichen getrennt in die Befehlszeile eingeben w√ºrden.

    Dieser Befehl wird aus dem **aktuellen Arbeitsverzeichnis** ausgef√ºhrt, dem gleichen `/code`-Verzeichnis, das Sie oben mit `WORKDIR /code` festgelegt haben.

    Da das Programm unter `/code` gestartet wird und sich darin das Verzeichnis `./app` mit Ihrem Code befindet, kann **Uvicorn** `app` sehen und aus `app.main` **importieren**.

/// tip | Tipp

Lernen Sie, was jede Zeile bewirkt, indem Sie auf die Zahlenblasen im Code klicken. üëÜ

///

Sie sollten jetzt eine Verzeichnisstruktur wie diese haben:

```
.
‚îú‚îÄ‚îÄ app
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ requirements.txt
```

#### Hinter einem TLS-Terminierungsproxy

Wenn Sie Ihren Container hinter einem TLS-Terminierungsproxy (Load Balancer) wie Nginx oder Traefik ausf√ºhren, f√ºgen Sie die Option `--proxy-headers` hinzu. Das sagt Uvicorn, den von diesem Proxy gesendeten Headern zu vertrauen und dass die Anwendung hinter HTTPS ausgef√ºhrt wird, usw.

```Dockerfile
CMD ["uvicorn", "app.main:app", "--proxy-headers", "--host", "0.0.0.0", "--port", "80"]
```

#### Docker-Cache

In diesem `Dockerfile` gibt es einen wichtigen Trick: Wir kopieren zuerst die **Datei nur mit den Abh√§ngigkeiten**, nicht den Rest des Codes. Lassen Sie mich Ihnen erkl√§ren, warum.

```Dockerfile
COPY ./requirements.txt /code/requirements.txt
```

Docker und andere Tools **erstellen** diese Containerimages **inkrementell**, f√ºgen **eine Ebene √ºber der anderen** hinzu, beginnend am Anfang des `Dockerfile`s und f√ºgen alle durch die einzelnen Anweisungen des `Dockerfile`s erstellten Dateien hinzu.

Docker und √§hnliche Tools verwenden beim Erstellen des Images auch einen **internen Cache**. Wenn sich eine Datei seit der letzten Erstellung des Containerimages nicht ge√§ndert hat, wird **dieselbe Ebene wiederverwendet**, die beim letzten Mal erstellt wurde, anstatt die Datei erneut zu kopieren und eine neue Ebene von Grund auf zu erstellen.

Das blo√üe Vermeiden des Kopierens von Dateien f√ºhrt nicht unbedingt zu einer gro√üen Verbesserung, aber da der Cache f√ºr diesen Schritt verwendet wurde, kann **der Cache f√ºr den n√§chsten Schritt verwendet werden**. Beispielsweise k√∂nnte der Cache verwendet werden f√ºr die Anweisung, welche die Abh√§ngigkeiten installiert mit:

```Dockerfile
RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt
```

Die Datei mit den Paketanforderungen wird sich **nicht h√§ufig √§ndern**. Wenn Docker also nur diese Datei kopiert, kann es f√ºr diesen Schritt **den Cache verwenden**.

Und dann kann Docker **den Cache f√ºr den n√§chsten Schritt verwenden**, der diese Abh√§ngigkeiten herunterl√§dt und installiert. Und hier **sparen wir viel Zeit**. ‚ú® ... und vermeiden die Langeweile beim Warten. üò™üòÜ

Das Herunterladen und Installieren der Paketabh√§ngigkeiten **k√∂nnte Minuten dauern**, aber die Verwendung des **Cache** w√ºrde h√∂chstens **Sekunden** dauern.

Und da Sie das Containerimage w√§hrend der Entwicklung immer wieder erstellen w√ºrden, um zu √ºberpr√ºfen, ob Ihre Code√§nderungen funktionieren, w√ºrde dies viel Zeit sparen.

Dann, gegen Ende des `Dockerfile`s, kopieren wir den gesamten Code. Da sich der **am h√§ufigsten √§ndert**, platzieren wir das am Ende, da fast immer alles nach diesem Schritt nicht mehr in der Lage sein wird, den Cache zu verwenden.

```Dockerfile
COPY ./app /code/app
```

### Das Docker-Image erstellen

Nachdem nun alle Dateien vorhanden sind, erstellen wir das Containerimage.

* Gehen Sie zum Projektverzeichnis (dort, wo sich Ihr `Dockerfile` und Ihr `app`-Verzeichnis befindet).
* Erstellen Sie Ihr FastAPI-Image:

<div class="termy">

```console
$ docker build -t myimage .

---> 100%
```

</div>

/// tip | Tipp

Beachten Sie das `.` am Ende, es entspricht `./` und teilt Docker mit, welches Verzeichnis zum Erstellen des Containerimages verwendet werden soll.

In diesem Fall handelt es sich um dasselbe aktuelle Verzeichnis (`.`).

///

### Den Docker-Container starten

* F√ºhren Sie einen Container basierend auf Ihrem Image aus:

<div class="termy">

```console
$ docker run -d --name mycontainer -p 80:80 myimage
```

</div>

## Es √ºberpr√ºfen

Sie sollten es in der URL Ihres Docker-Containers √ºberpr√ºfen k√∂nnen, zum Beispiel: <a href="http://192.168.99.100/items/5?q=somequery" class="external-link" target="_blank">http://192.168.99.100/items/5?q=somequery</a> oder <a href="http://127.0.0.1/items/5?q=somequery" class="external-link" target="_blank">http://127.0.0.1/items/5?q=somequery</a> (oder gleichwertig, unter Verwendung Ihres Docker-Hosts).

Sie werden etwas sehen wie:

```JSON
{"item_id": 5, "q": "somequery"}
```

## Interaktive API-Dokumentation

Jetzt k√∂nnen Sie auf <a href="http://192.168.99.100/docs" class="external-link" target="_blank">http://192.168.99.100/docs</a> oder <a href="http://127.0.0.1/docs" class="external-link" target="_blank">http://127.0.0.1/docs</a> gehen (oder √§hnlich, unter Verwendung Ihres Docker-Hosts).

Sie sehen die automatische interaktive API-Dokumentation (bereitgestellt von <a href="https://github.com/swagger-api/swagger-ui" class="external-link" target="_blank">Swagger UI</a>):

![Swagger-Oberfl√§che](https://fastapi.tiangolo.com/img/index/index-01-swagger-ui-simple.png)

## Alternative API-Dokumentation

Sie k√∂nnen auch auf <a href="http://192.168.99.100/redoc" class="external-link" target="_blank">http://192.168.99.100/redoc</a> oder <a href="http://127.0.0.1/redoc" class="external-link" target="_blank">http://127.0.0.1/redoc</a> gehen (oder √§hnlich, unter Verwendung Ihres Docker-Hosts).

Sie sehen die alternative automatische Dokumentation (bereitgestellt von <a href="https://github.com/Rebilly/ReDoc" class="external-link" target="_blank">ReDoc</a>):

![ReDoc](https://fastapi.tiangolo.com/img/index/index-02-redoc-simple.png)

## Ein Docker-Image mit einem Single-File-FastAPI erstellen

Wenn Ihr FastAPI eine einzelne Datei ist, zum Beispiel `main.py` ohne ein `./app`-Verzeichnis, k√∂nnte Ihre Dateistruktur wie folgt aussehen:

```
.
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ main.py
‚îî‚îÄ‚îÄ requirements.txt
```

Dann m√ºssten Sie nur noch die entsprechenden Pfade √§ndern, um die Datei im `Dockerfile` zu kopieren:

```{ .dockerfile .annotate hl_lines="10  13" }
FROM python:3.9

WORKDIR /code

COPY ./requirements.txt /code/requirements.txt

RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt

# (1)
COPY ./main.py /code/

# (2)
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "80"]
```

1. Kopiere die Datei `main.py` direkt in das Verzeichnis `/code` (ohne ein Verzeichnis `./app`).

2. F√ºhre Uvicorn aus und weisen es an, das `app`-Objekt von `main` zu importieren (anstatt von `app.main` zu importieren).

Passen Sie dann den Uvicorn-Befehl an, um das neue Modul `main` anstelle von `app.main` zu verwenden, um das FastAPI-Objekt `app` zu importieren.

## Deployment-Konzepte

Lassen Sie uns noch einmal √ºber einige der gleichen [Deployment-Konzepte](concepts.md){.internal-link target=_blank} in Bezug auf Container sprechen.

Container sind haupts√§chlich ein Werkzeug, um den Prozess des **Erstellens und Deployments** einer Anwendung zu vereinfachen, sie erzwingen jedoch keinen bestimmten Ansatz f√ºr die Handhabung dieser **Deployment-Konzepte**, und es gibt mehrere m√∂gliche Strategien.

Die **gute Nachricht** ist, dass es mit jeder unterschiedlichen Strategie eine M√∂glichkeit gibt, alle Deployment-Konzepte abzudecken. üéâ

Sehen wir uns diese **Deployment-Konzepte** im Hinblick auf Container noch einmal an:

* Sicherheit ‚Äì HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* Replikation (die Anzahl der laufenden Prozesse)
* Arbeitsspeicher
* Schritte vor dem Start

## HTTPS

Wenn wir uns nur auf das **Containerimage** f√ºr eine FastAPI-Anwendung (und sp√§ter auf den laufenden **Container**) konzentrieren, w√ºrde HTTPS normalerweise **extern** von einem anderen Tool verarbeitet.

Es k√∂nnte sich um einen anderen Container handeln, zum Beispiel mit <a href="https://traefik.io/" class="external-link" target="_blank">Traefik</a>, welcher **HTTPS** und **automatischen** Erwerb von **Zertifikaten** handhabt.

/// tip | Tipp

Traefik verf√ºgt √ºber Integrationen mit Docker, Kubernetes und anderen, sodass Sie damit ganz einfach HTTPS f√ºr Ihre Container einrichten und konfigurieren k√∂nnen.

///

Alternativ k√∂nnte HTTPS von einem Cloud-Anbieter als einer seiner Dienste gehandhabt werden (w√§hrend die Anwendung weiterhin in einem Container ausgef√ºhrt wird).

## Beim Hochfahren ausf√ºhren und Neustarts

Normalerweise gibt es ein anderes Tool, das f√ºr das **Starten und Ausf√ºhren** Ihres Containers zust√§ndig ist.

Es k√∂nnte sich um **Docker** direkt, **Docker Compose**, **Kubernetes**, einen **Cloud-Dienst**, usw. handeln.

In den meisten (oder allen) F√§llen gibt es eine einfache Option, um die Ausf√ºhrung des Containers beim Hochfahren und Neustarts bei Fehlern zu erm√∂glichen. In Docker ist es beispielsweise die Befehlszeilenoption `--restart`.

Ohne die Verwendung von Containern kann es umst√§ndlich und schwierig sein, Anwendungen beim Hochfahren auszuf√ºhren und neu zu starten. Bei der **Arbeit mit Containern** ist diese Funktionalit√§t jedoch in den meisten F√§llen standardm√§√üig enthalten. ‚ú®

## Replikation ‚Äì Anzahl der Prozesse

Wenn Sie einen <abbr title="Eine Gruppe von Maschinen, die so konfiguriert sind, dass sie verbunden sind und auf irgendeine Weise zusammenarbeiten.">Cluster</abbr> von Maschinen mit **Kubernetes**, Docker Swarm Mode, Nomad verwenden, oder einem anderen, √§hnlich komplexen System zur Verwaltung verteilter Container auf mehreren Maschinen, m√∂chten Sie wahrscheinlich die **Replikation auf Cluster-Ebene abwickeln**, anstatt in jedem Container einen **Prozessmanager** (wie Gunicorn mit Workern) zu verwenden.

Diese verteilten Containerverwaltungssysteme wie Kubernetes verf√ºgen normalerweise √ºber eine integrierte M√∂glichkeit, die **Replikation von Containern** zu handhaben und gleichzeitig **Load Balancing** f√ºr die eingehenden Requests zu unterst√ºtzen. Alles auf **Cluster-Ebene**.

In diesen F√§llen m√∂chten Sie wahrscheinlich ein **Docker-Image von Grund auf** erstellen, wie [oben erkl√§rt](#dockerfile), Ihre Abh√§ngigkeiten installieren und **einen einzelnen Uvicorn-Prozess** ausf√ºhren, anstatt etwas wie Gunicorn mit Uvicorn-Workern auszuf√ºhren.

### Load Balancer

Bei der Verwendung von Containern ist normalerweise eine Komponente vorhanden, **die am Hauptport lauscht**. Es k√∂nnte sich um einen anderen Container handeln, der auch ein **TLS-Terminierungsproxy** ist, um **HTTPS** zu verarbeiten, oder ein √§hnliches Tool.

Da diese Komponente die **Last** an Requests aufnehmen und diese (hoffentlich) **ausgewogen** auf die Worker verteilen w√ºrde, wird sie √ºblicherweise auch **Load Balancer** ‚Äì Lastverteiler ‚Äì genannt.

/// tip | Tipp

Die gleiche **TLS-Terminierungsproxy**-Komponente, die f√ºr HTTPS verwendet wird, w√§re wahrscheinlich auch ein **Load Balancer**.

///

Und wenn Sie mit Containern arbeiten, verf√ºgt das gleiche System, mit dem Sie diese starten und verwalten, bereits √ºber interne Tools, um die **Netzwerkkommunikation** (z. B. HTTP-Requests) von diesem **Load Balancer** (das k√∂nnte auch ein **TLS-Terminierungsproxy** sein) zu den Containern mit Ihrer Anwendung weiterzuleiten.

### Ein Load Balancer ‚Äì mehrere Workercontainer

Bei der Arbeit mit **Kubernetes** oder √§hnlichen verteilten Containerverwaltungssystemen w√ºrde die Verwendung ihrer internen Netzwerkmechanismen es dem einzelnen **Load Balancer**, der den Haupt-**Port** √ºberwacht, erm√∂glichen, Kommunikation (Requests) an m√∂glicherweise **mehrere Container** weiterzuleiten, in denen Ihre Anwendung ausgef√ºhrt wird.

Jeder dieser Container, in denen Ihre Anwendung ausgef√ºhrt wird, verf√ºgt normalerweise √ºber **nur einen Prozess** (z. B. einen Uvicorn-Prozess, der Ihre FastAPI-Anwendung ausf√ºhrt). Es w√§ren alles **identische Container**, die das Gleiche ausf√ºhren, welche aber jeweils √ºber einen eigenen Prozess, Speicher, usw. verf√ºgen. Auf diese Weise w√ºrden Sie die **Parallelisierung** in **verschiedenen Kernen** der CPU nutzen. Oder sogar in **verschiedenen Maschinen**.

Und das verteilte Containersystem mit dem **Load Balancer** w√ºrde **die Requests abwechselnd** an jeden einzelnen Container mit Ihrer Anwendung verteilen. Jeder Request k√∂nnte also von einem der mehreren **replizierten Container** verarbeitet werden, in denen Ihre Anwendung ausgef√ºhrt wird.

Und normalerweise w√§re dieser **Load Balancer** in der Lage, Requests zu verarbeiten, die an *andere* Anwendungen in Ihrem Cluster gerichtet sind (z. B. eine andere Domain oder unter einem anderen URL-Pfad-Pr√§fix), und w√ºrde diese Kommunikation an die richtigen Container weiterleiten f√ºr *diese andere* Anwendung, die in Ihrem Cluster ausgef√ºhrt wird.

### Ein Prozess pro Container

In einem solchen Szenario m√∂chten Sie wahrscheinlich **einen einzelnen (Uvicorn-)Prozess pro Container** haben, da Sie die Replikation bereits auf Cluster ebene durchf√ºhren w√ºrden.

In diesem Fall m√∂chten Sie also **nicht** einen Prozessmanager wie Gunicorn mit Uvicorn-Workern oder Uvicorn mit seinen eigenen Uvicorn-Workern haben. Sie m√∂chten nur einen **einzelnen Uvicorn-Prozess** pro Container haben (wahrscheinlich aber mehrere Container).

Ein weiterer Prozessmanager im Container (wie es bei Gunicorn oder Uvicorn der Fall w√§re, welche Uvicorn-Worker verwalten) w√ºrde nur **unn√∂tige Komplexit√§t** hinzuf√ºgen, um welche Sie sich h√∂chstwahrscheinlich bereits mit Ihrem Clustersystem k√ºmmern.

### Container mit mehreren Prozessen und Sonderf√§lle

Nat√ºrlich gibt es **Sonderf√§lle**, in denen Sie **einen Container** mit einem **Gunicorn-Prozessmanager** haben m√∂chten, welcher mehrere **Uvicorn-Workerprozesse** darin startet.

In diesen F√§llen k√∂nnen Sie das **offizielle Docker-Image** verwenden, welches **Gunicorn** als Prozessmanager enth√§lt, welcher mehrere **Uvicorn-Workerprozesse** ausf√ºhrt, sowie einige Standardeinstellungen, um die Anzahl der Worker basierend auf den verf√ºgbaren CPU-Kernen automatisch anzupassen. Ich erz√§hle Ihnen weiter unten in [Offizielles Docker-Image mit Gunicorn ‚Äì Uvicorn](#offizielles-docker-image-mit-gunicorn-uvicorn) mehr dar√ºber.

Hier sind einige Beispiele, wann das sinnvoll sein k√∂nnte:

#### Eine einfache Anwendung

Sie k√∂nnten einen Prozessmanager im Container haben wollen, wenn Ihre Anwendung **einfach genug** ist, sodass Sie die Anzahl der Prozesse nicht (zumindest noch nicht) zu stark tunen m√ºssen und Sie einfach einen automatisierten Standard verwenden k√∂nnen (mit dem offiziellen Docker-Image), und Sie f√ºhren es auf einem **einzelnen Server** aus, nicht auf einem Cluster.

#### Docker Compose

Sie k√∂nnten das Deployment auf einem **einzelnen Server** (kein Cluster) mit **Docker Compose** durchf√ºhren, sodass Sie keine einfache M√∂glichkeit h√§tten, die Replikation von Containern (mit Docker Compose) zu verwalten und gleichzeitig das gemeinsame Netzwerk mit **Load Balancing** zu haben.

Dann m√∂chten Sie vielleicht **einen einzelnen Container** mit einem **Prozessmanager** haben, der darin **mehrere Workerprozesse** startet.

#### Prometheus und andere Gr√ºnde

Sie k√∂nnten auch **andere Gr√ºnde** haben, die es einfacher machen w√ºrden, einen **einzelnen Container** mit **mehreren Prozessen** zu haben, anstatt **mehrere Container** mit **einem einzelnen Prozess** in jedem von ihnen.

Beispielsweise k√∂nnten Sie (abh√§ngig von Ihrem Setup) ein Tool wie einen Prometheus-Exporter im selben Container haben, welcher Zugriff auf **jeden der eingehenden Requests** haben sollte.

Wenn Sie in hier **mehrere Container** h√§tten, w√ºrde Prometheus beim **Lesen der Metriken** standardm√§√üig jedes Mal diejenigen f√ºr **einen einzelnen Container** abrufen (f√ºr den Container, der den spezifischen Request verarbeitet hat), anstatt die **akkumulierten Metriken** f√ºr alle replizierten Container abzurufen.

In diesem Fall k√∂nnte einfacher sein, **einen Container** mit **mehreren Prozessen** und ein lokales Tool (z. B. einen Prometheus-Exporter) in demselben Container zu haben, welches Prometheus-Metriken f√ºr alle internen Prozesse sammelt und diese Metriken f√ºr diesen einzelnen Container offenlegt.

---

Der Hauptpunkt ist, dass **keine** dieser Regeln **in Stein gemei√üelt** ist, der man blind folgen muss. Sie k√∂nnen diese Ideen verwenden, um **Ihren eigenen Anwendungsfall zu evaluieren**, zu entscheiden, welcher Ansatz f√ºr Ihr System am besten geeignet ist und herauszufinden, wie Sie folgende Konzepte verwalten:

* Sicherheit ‚Äì HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* Replikation (die Anzahl der laufenden Prozesse)
* Arbeitsspeicher
* Schritte vor dem Start

## Arbeitsspeicher

Wenn Sie **einen einzelnen Prozess pro Container** ausf√ºhren, wird von jedem dieser Container (mehr als einer, wenn sie repliziert werden) eine mehr oder weniger klar definierte, stabile und begrenzte Menge an Arbeitsspeicher verbraucht.

Und dann k√∂nnen Sie dieselben Speichergrenzen und -anforderungen in Ihren Konfigurationen f√ºr Ihr Container-Management-System festlegen (z. B. in **Kubernetes**). Auf diese Weise ist es in der Lage, die Container auf den **verf√ºgbaren Maschinen** zu replizieren, wobei die von denen ben√∂tigte Speichermenge und die auf den Maschinen im Cluster verf√ºgbare Menge ber√ºcksichtigt werden.

Wenn Ihre Anwendung **einfach** ist, wird dies wahrscheinlich **kein Problem darstellen** und Sie m√ºssen m√∂glicherweise keine festen Speichergrenzen angeben. Wenn Sie jedoch **viel Speicher verbrauchen** (z. B. bei **Modellen f√ºr maschinelles Lernen**), sollten Sie √ºberpr√ºfen, wie viel Speicher Sie verbrauchen, und die **Anzahl der Container** anpassen, die in **jeder Maschine** ausgef√ºhrt werden. (und m√∂glicherweise weitere Maschinen zu Ihrem Cluster hinzuf√ºgen).

Wenn Sie **mehrere Prozesse pro Container** ausf√ºhren (zum Beispiel mit dem offiziellen Docker-Image), m√ºssen Sie sicherstellen, dass die Anzahl der gestarteten Prozesse nicht **mehr Speicher verbraucht** als verf√ºgbar ist.

## Schritte vor dem Start und Container

Wenn Sie Container (z. B. Docker, Kubernetes) verwenden, k√∂nnen Sie haupts√§chlich zwei Ans√§tze verwenden.

### Mehrere Container

Wenn Sie **mehrere Container** haben, von denen wahrscheinlich jeder einen **einzelnen Prozess** ausf√ºhrt (z. B. in einem **Kubernetes**-Cluster), dann m√∂chten Sie wahrscheinlich einen **separaten Container** haben, welcher die Arbeit der **Vorab-Schritte** in einem einzelnen Container, mit einem einzelnenen Prozess ausf√ºhrt, **bevor** die replizierten Workercontainer ausgef√ºhrt werden.

/// info

Wenn Sie Kubernetes verwenden, w√§re dies wahrscheinlich ein <a href="https://kubernetes.io/docs/concepts/workloads/pods/init-containers/" class="external-link" target="_blank">Init-Container</a>.

///

Wenn es in Ihrem Anwendungsfall kein Problem darstellt, diese vorherigen Schritte **mehrmals parallel** auszuf√ºhren (z. B. wenn Sie keine Datenbankmigrationen ausf√ºhren, sondern nur pr√ºfen, ob die Datenbank bereits bereit ist), k√∂nnen Sie sie auch einfach in jedem Container direkt vor dem Start des Hauptprozesses einf√ºgen.

### Einzelner Container

Wenn Sie ein einfaches Setup mit einem **einzelnen Container** haben, welcher dann mehrere **Workerprozesse** (oder auch nur einen Prozess) startet, k√∂nnen Sie die Vorab-Schritte im selben Container direkt vor dem Starten des Prozesses mit der Anwendung ausf√ºhren. Das offizielle Docker-Image unterst√ºtzt das intern.

## Offizielles Docker-Image mit Gunicorn ‚Äì Uvicorn

Es gibt ein offizielles Docker-Image, in dem Gunicorn mit Uvicorn-Workern ausgef√ºhrt wird, wie in einem vorherigen Kapitel beschrieben: [Serverworker ‚Äì Gunicorn mit Uvicorn](server-workers.md){.internal-link target=_blank}.

Dieses Image w√§re vor allem in den oben beschriebenen Situationen n√ºtzlich: [Container mit mehreren Prozessen und Sonderf√§lle](#container-mit-mehreren-prozessen-und-sonderfalle).

* <a href="https://github.com/tiangolo/uvicorn-gunicorn-fastapi-docker" class="external-link" target="_blank">tiangolo/uvicorn-gunicorn-fastapi</a>.

/// warning | Achtung

Es besteht eine hohe Wahrscheinlichkeit, dass Sie dieses oder ein √§hnliches Basisimage **nicht** ben√∂tigen und es besser w√§re, wenn Sie das Image von Grund auf neu erstellen w√ºrden, wie [oben beschrieben in: Ein Docker-Image f√ºr FastAPI erstellen](#ein-docker-image-fur-fastapi-erstellen).

///

Dieses Image verf√ºgt √ºber einen **Auto-Tuning**-Mechanismus, um die **Anzahl der Arbeitsprozesse** basierend auf den verf√ºgbaren CPU-Kernen festzulegen.

Es verf√ºgt √ºber **vern√ºnftige Standardeinstellungen**, aber Sie k√∂nnen trotzdem alle Konfigurationen mit **Umgebungsvariablen** oder Konfigurationsdateien √§ndern und aktualisieren.

Es unterst√ºtzt auch die Ausf√ºhrung von <a href="https://github.com/tiangolo/uvicorn-gunicorn-fastapi-docker#pre_start_path" class="external-link" target="_blank">**Vorab-Schritten vor dem Start** </a> mit einem Skript.

/// tip | Tipp

Um alle Konfigurationen und Optionen anzuzeigen, gehen Sie zur Docker-Image-Seite: <a href="https://github.com/tiangolo/uvicorn-gunicorn-fastapi-docker" class="external-link" target="_blank">tiangolo/uvicorn-gunicorn-fastapi</a>.

///

### Anzahl der Prozesse auf dem offiziellen Docker-Image

Die **Anzahl der Prozesse** auf diesem Image wird **automatisch** anhand der verf√ºgbaren CPU-**Kerne** berechnet.

Das bedeutet, dass versucht wird, so viel **Leistung** wie m√∂glich aus der CPU herauszuquetschen.

Sie k√∂nnen das auch in der Konfiguration anpassen, indem Sie **Umgebungsvariablen**, usw. verwenden.

Das bedeutet aber auch, da die Anzahl der Prozesse von der CPU abh√§ngt, welche der Container ausf√ºhrt, dass die **Menge des verbrauchten Speichers** ebenfalls davon abh√§ngt.

Wenn Ihre Anwendung also viel Speicher verbraucht (z. B. bei Modellen f√ºr maschinelles Lernen) und Ihr Server √ºber viele CPU-Kerne, **aber wenig Speicher** verf√ºgt, k√∂nnte Ihr Container am Ende versuchen, mehr Speicher als vorhanden zu verwenden, was zu erheblichen Leistungseinbu√üen (oder sogar zum Absturz) f√ºhren kann. üö®

### Ein `Dockerfile` erstellen

So w√ºrden Sie ein `Dockerfile` basierend auf diesem Image erstellen:

```Dockerfile
FROM tiangolo/uvicorn-gunicorn-fastapi:python3.9

COPY ./requirements.txt /app/requirements.txt

RUN pip install --no-cache-dir --upgrade -r /app/requirements.txt

COPY ./app /app
```

### Gr√∂√üere Anwendungen

Wenn Sie dem Abschnitt zum Erstellen von [gr√∂√üeren Anwendungen mit mehreren Dateien](../tutorial/bigger-applications.md){.internal-link target=_blank} gefolgt sind, k√∂nnte Ihr `Dockerfile` stattdessen wie folgt aussehen:

```Dockerfile hl_lines="7"
FROM tiangolo/uvicorn-gunicorn-fastapi:python3.9

COPY ./requirements.txt /app/requirements.txt

RUN pip install --no-cache-dir --upgrade -r /app/requirements.txt

COPY ./app /app/app
```

### Wann verwenden

Sie sollten dieses offizielle Basisimage (oder ein √§hnliches) wahrscheinlich **nicht** benutzen, wenn Sie **Kubernetes** (oder andere) verwenden und Sie bereits **Replikation** auf Cluster ebene mit mehreren **Containern** eingerichtet haben. In diesen F√§llen ist es besser, **ein Image von Grund auf zu erstellen**, wie oben beschrieben: [Ein Docker-Image f√ºr FastAPI erstellen](#ein-docker-image-fur-fastapi-erstellen).

Dieses Image w√§re vor allem in den oben in [Container mit mehreren Prozessen und Sonderf√§lle](#container-mit-mehreren-prozessen-und-sonderfalle) beschriebenen Sonderf√§llen n√ºtzlich. Wenn Ihre Anwendung beispielsweise **einfach genug** ist, dass das Festlegen einer Standardanzahl von Prozessen basierend auf der CPU gut funktioniert, m√∂chten Sie sich nicht mit der manuellen Konfiguration der Replikation auf Cluster ebene herumschlagen und f√ºhren nicht mehr als einen Container mit Ihrer Anwendung aus. Oder wenn Sie das Deployment mit **Docker Compose** durchf√ºhren und auf einem einzelnen Server laufen, usw.

## Deployment des Containerimages

Nachdem Sie ein Containerimage (Docker) haben, gibt es mehrere M√∂glichkeiten, es bereitzustellen.

Zum Beispiel:

* Mit **Docker Compose** auf einem einzelnen Server
* Mit einem **Kubernetes**-Cluster
* Mit einem Docker Swarm Mode-Cluster
* Mit einem anderen Tool wie Nomad
* Mit einem Cloud-Dienst, der Ihr Containerimage nimmt und es bereitstellt

## Docker-Image mit Poetry

Wenn Sie <a href="https://python-poetry.org/" class="external-link" target="_blank">Poetry</a> verwenden, um die Abh√§ngigkeiten Ihres Projekts zu verwalten, k√∂nnen Sie Dockers mehrphasige Builds verwenden:

```{ .dockerfile .annotate }
# (1)
FROM python:3.9 as requirements-stage

# (2)
WORKDIR /tmp

# (3)
RUN pip install poetry

# (4)
COPY ./pyproject.toml ./poetry.lock* /tmp/

# (5)
RUN poetry export -f requirements.txt --output requirements.txt --without-hashes

# (6)
FROM python:3.9

# (7)
WORKDIR /code

# (8)
COPY --from=requirements-stage /tmp/requirements.txt /code/requirements.txt

# (9)
RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt

# (10)
COPY ./app /code/app

# (11)
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "80"]
```

1. Dies ist die erste Phase, genannt `requirements-stage` ‚Äì ‚ÄûAnforderungsphase‚Äú.

2. Setze `/tmp` als aktuelles Arbeitsverzeichnis.

    Hier werden wir die Datei `requirements.txt` generieren.

3. Installiere Poetry in dieser Docker-Phase.

4. Kopiere die Dateien `pyproject.toml` und `poetry.lock` in das Verzeichnis `/tmp`.

    Da es `./poetry.lock*` verwendet (endet mit einem `*`), st√ºrzt es nicht ab, wenn diese Datei noch nicht verf√ºgbar ist.

5. Generiere die Datei `requirements.txt`.

6. Dies ist die letzte Phase. Alles hier bleibt im endg√ºltigen Containerimage erhalten.

7. Setze das aktuelle Arbeitsverzeichnis auf `/code`.

8. Kopiere die Datei `requirements.txt` in das Verzeichnis `/code`.

    Diese Datei existiert nur in der vorherigen Docker-Phase, deshalb verwenden wir `--from-requirements-stage`, um sie zu kopieren.

9. Installiere die Paketabh√§ngigkeiten von der generierten Datei `requirements.txt`.

10. Kopiere das Verzeichnis `app` in das Verzeichnis `/code`.

11. F√ºhre den Befehl `uvicorn` aus und weise ihn an, das aus `app.main` importierte `app`-Objekt zu verwenden.

/// tip | Tipp

Klicken Sie auf die Zahlenblasen, um zu sehen, was jede Zeile bewirkt.

///

Eine **Docker-Phase** ist ein Teil eines `Dockerfile`s, welcher als **tempor√§res Containerimage** fungiert und nur zum Generieren einiger Dateien f√ºr die sp√§tere Verwendung verwendet wird.

Die erste Phase wird nur zur **Installation von Poetry** und zur **Generierung der `requirements.txt`** mit deren Projektabh√§ngigkeiten aus der Datei `pyproject.toml` von Poetry verwendet.

Diese `requirements.txt`-Datei wird sp√§ter in der **n√§chsten Phase** mit `pip` verwendet.

Im endg√ºltigen Containerimage bleibt **nur die letzte Stufe** erhalten. Die vorherigen Stufen werden verworfen.

Bei der Verwendung von Poetry w√§re es sinnvoll, **mehrstufige Docker-Builds** zu verwenden, da Poetry und seine Abh√§ngigkeiten nicht wirklich im endg√ºltigen Containerimage installiert sein m√ºssen, sondern Sie brauchen **nur** die Datei `requirements.txt`, um Ihre Projektabh√§ngigkeiten zu installieren.

Dann w√ºrden Sie im n√§chsten (und letzten) Schritt das Image mehr oder weniger auf die gleiche Weise wie zuvor beschrieben erstellen.

### Hinter einem TLS-Terminierungsproxy ‚Äì Poetry

Auch hier gilt: Wenn Sie Ihren Container hinter einem TLS-Terminierungsproxy (Load Balancer) wie Nginx oder Traefik ausf√ºhren, f√ºgen Sie dem Befehl die Option `--proxy-headers` hinzu:

```Dockerfile
CMD ["uvicorn", "app.main:app", "--proxy-headers", "--host", "0.0.0.0", "--port", "80"]
```

## Zusammenfassung

Mithilfe von Containersystemen (z. B. mit **Docker** und **Kubernetes**) ist es ziemlich einfach, alle **Deployment-Konzepte** zu handhaben:

* HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* Replikation (die Anzahl der laufenden Prozesse)
* Arbeitsspeicher
* Schritte vor dem Start

In den meisten F√§llen m√∂chten Sie wahrscheinlich kein Basisimage verwenden und stattdessen **ein Containerimage von Grund auf erstellen**, eines basierend auf dem offiziellen Python-Docker-Image.

Indem Sie auf die **Reihenfolge** der Anweisungen im `Dockerfile` und den **Docker-Cache** achten, k√∂nnen Sie **die Build-Zeiten minimieren**, um Ihre Produktivit√§t zu erh√∂hen (und Langeweile zu vermeiden). üòé

In bestimmten Sonderf√§llen m√∂chten Sie m√∂glicherweise das offizielle Docker-Image f√ºr FastAPI verwenden. ü§ì


================================================
File: /docs/de/docs/deployment/https.md
================================================
# √úber HTTPS

Es ist leicht anzunehmen, dass HTTPS etwas ist, was einfach nur ‚Äûaktiviert‚Äú wird oder nicht.

Aber es ist viel komplexer als das.

/// tip | Tipp

Wenn Sie es eilig haben oder es Ihnen egal ist, fahren Sie mit den n√§chsten Abschnitten fort, um Schritt-f√ºr-Schritt-Anleitungen f√ºr die Einrichtung der verschiedenen Technologien zu erhalten.

///

Um **die Grundlagen von HTTPS** aus Sicht des Benutzers zu erlernen, schauen Sie sich <a href="https://howhttps.works/" class="external-link" target="_blank">https://howhttps.works/</a> an.

Aus **Sicht des Entwicklers** sollten Sie beim Nachdenken √ºber HTTPS Folgendes beachten:

* F√ºr HTTPS muss **der Server** √ºber von einem **Dritten** generierte **‚ÄûZertifikate‚Äú** verf√ºgen.
    * Diese Zertifikate werden tats√§chlich vom Dritten **erworben** und nicht ‚Äûgeneriert‚Äú.
* Zertifikate haben eine **Lebensdauer**.
    * Sie **verfallen**.
    * Und dann m√ºssen sie vom Dritten **erneuert**, **erneut erworben** werden.
* Die Verschl√ºsselung der Verbindung erfolgt auf **TCP-Ebene**.
    * Das ist eine Schicht **unter HTTP**.
    * Die Handhabung von **Zertifikaten und Verschl√ºsselung** erfolgt also **vor HTTP**.
* **TCP wei√ü nichts √ºber ‚Äû<abbr title="Dom√§ne, Bereich, Wirkungsraum">Domains</abbr>‚Äú**. Nur √ºber IP-Adressen.
    * Die Informationen √ºber die angeforderte **spezifische Domain** befinden sich in den **HTTP-Daten**.
* Die **HTTPS-Zertifikate** ‚Äûzertifizieren‚Äú eine **bestimmte Domain**, aber das Protokoll und die Verschl√ºsselung erfolgen auf TCP-Ebene, **ohne zu wissen**, um welche Domain es sich handelt.
* **Standardm√§√üig** bedeutet das, dass Sie nur **ein HTTPS-Zertifikat pro IP-Adresse** haben k√∂nnen.
    * Ganz gleich, wie gro√ü Ihr Server ist oder wie klein die einzelnen Anwendungen darauf sind.
    * Hierf√ºr gibt es jedoch eine **L√∂sung**.
* Es gibt eine **Erweiterung** zum **TLS**-Protokoll (dasjenige, das die Verschl√ºsselung auf TCP-Ebene, vor HTTP, verwaltet) namens **<a href="https://en.wikipedia.org/wiki/Server_Name_Indication" class="external-link" target="_blank"><abbr title="Server Name Indication ‚Äì Angabe des Servernamens">SNI</abbr></a>**.
    * Mit dieser SNI-Erweiterung kann ein einzelner Server (mit einer **einzelnen IP-Adresse**) √ºber **mehrere HTTPS-Zertifikate** verf√ºgen und **mehrere HTTPS-Domains/Anwendungen** bedienen.
    * Damit das funktioniert, muss eine **einzelne** Komponente (Programm), die auf dem Server ausgef√ºhrt wird und welche die **√∂ffentliche IP-Adresse** √ºberwacht, **alle HTTPS-Zertifikate** des Servers haben.
* **Nachdem** eine sichere Verbindung hergestellt wurde, ist das Kommunikationsprotokoll **immer noch HTTP**.
    * Die Inhalte sind **verschl√ºsselt**, auch wenn sie mit dem **HTTP-Protokoll** gesendet werden.

Es ist eine g√§ngige Praxis, **ein Programm/HTTP-Server** auf dem Server (der Maschine, dem Host usw.) laufen zu lassen, welches **alle HTTPS-Aspekte verwaltet**: Empfangen der **verschl√ºsselten HTTPS-Requests**, Senden der **entschl√ºsselten HTTP-Requests** an die eigentliche HTTP-Anwendung die auf demselben Server l√§uft (in diesem Fall die **FastAPI**-Anwendung), entgegennehmen der **HTTP-Response** von der Anwendung, **verschl√ºsseln derselben** mithilfe des entsprechenden **HTTPS-Zertifikats** und Zur√ºcksenden zum Client √ºber **HTTPS**. Dieser Server wird oft als **<a href="https://en.wikipedia.org/wiki/TLS_termination_proxy" class="external-link" target="_blank">TLS-Terminierungsproxy</a>** bezeichnet.

Einige der Optionen, die Sie als TLS-Terminierungsproxy verwenden k√∂nnen, sind:

* Traefik (kann auch Zertifikat-Erneuerungen durchf√ºhren)
* Caddy (kann auch Zertifikat-Erneuerungen durchf√ºhren)
* Nginx
* HAProxy

## Let's Encrypt

Vor Let's Encrypt wurden diese **HTTPS-Zertifikate** von vertrauensw√ºrdigen Dritten verkauft.

Der Prozess zum Erwerb eines dieser Zertifikate war fr√ºher umst√§ndlich, erforderte viel Papierarbeit und die Zertifikate waren ziemlich teuer.

Aber dann wurde **<a href="https://letsencrypt.org/" class="external-link" target="_blank">Let's Encrypt</a>** geschaffen.

Es ist ein Projekt der Linux Foundation. Es stellt **kostenlose HTTPS-Zertifikate** automatisiert zur Verf√ºgung. Diese Zertifikate nutzen standardm√§√üig die gesamte kryptografische Sicherheit und sind kurzlebig (circa 3 Monate), sodass die **Sicherheit tats√§chlich besser ist**, aufgrund der k√ºrzeren Lebensdauer.

Die Domains werden sicher verifiziert und die Zertifikate werden automatisch generiert. Das erm√∂glicht auch die automatische Erneuerung dieser Zertifikate.

Die Idee besteht darin, den Erwerb und die Erneuerung der Zertifikate zu automatisieren, sodass Sie **sicheres HTTPS, kostenlos und f√ºr immer** haben k√∂nnen.

## HTTPS f√ºr Entwickler

Hier ist ein Beispiel, wie eine HTTPS-API aussehen k√∂nnte, Schritt f√ºr Schritt, wobei vor allem die f√ºr Entwickler wichtigen Ideen ber√ºcksichtigt werden.

### Domainname

Alles beginnt wahrscheinlich damit, dass Sie einen **Domainnamen erwerben**. Anschlie√üend konfigurieren Sie ihn in einem DNS-Server (wahrscheinlich beim selben Cloud-Anbieter).

Sie w√ºrden wahrscheinlich einen Cloud-Server (eine virtuelle Maschine) oder etwas √Ñhnliches bekommen, und dieser h√§tte eine <abbr title="Sie √§ndert sich nicht">feste</abbr> **√∂ffentliche IP-Adresse**.

In dem oder den DNS-Server(n) w√ºrden Sie einen Eintrag (einen ‚Äû`A record`‚Äú) konfigurieren, um mit **Ihrer Domain** auf die √∂ffentliche **IP-Adresse Ihres Servers** zu verweisen.

Sie w√ºrden dies wahrscheinlich nur einmal tun, beim ersten Mal, wenn Sie alles einrichten.

/// tip | Tipp

Dieser Domainnamen-Aspekt liegt weit vor HTTPS, aber da alles von der Domain und der IP-Adresse abh√§ngt, lohnt es sich, das hier zu erw√§hnen.

///

### DNS

Konzentrieren wir uns nun auf alle tats√§chlichen HTTPS-Aspekte.

Zuerst w√ºrde der Browser mithilfe der **DNS-Server** herausfinden, welches die **IP f√ºr die Domain** ist, in diesem Fall f√ºr `someapp.example.com`.

Die DNS-Server geben dem Browser eine bestimmte **IP-Adresse** zur√ºck. Das w√§re die von Ihrem Server verwendete √∂ffentliche IP-Adresse, die Sie in den DNS-Servern konfiguriert haben.

<img src="/img/deployment/https/https01.svg">

### TLS-Handshake-Start

Der Browser kommuniziert dann mit dieser IP-Adresse √ºber **Port 443** (den HTTPS-Port).

Der erste Teil der Kommunikation besteht lediglich darin, die Verbindung zwischen dem Client und dem Server herzustellen und die zu verwendenden kryptografischen Schl√ºssel usw. zu vereinbaren.

<img src="/img/deployment/https/https02.svg">

Diese Interaktion zwischen dem Client und dem Server zum Aufbau der TLS-Verbindung wird als **<abbr title="TLS-Handschlag">TLS-Handshake</abbr>** bezeichnet.

### TLS mit SNI-Erweiterung

**Nur ein Prozess** im Server kann an einem bestimmten **Port** einer bestimmten **IP-Adresse** lauschen. M√∂glicherweise gibt es andere Prozesse, die an anderen Ports dieselbe IP-Adresse abh√∂ren, jedoch nur einen f√ºr jede Kombination aus IP-Adresse und Port.

TLS (HTTPS) verwendet standardm√§√üig den spezifischen Port `443`. Das ist also der Port, den wir brauchen.

Da an diesem Port nur ein Prozess lauschen kann, w√§re der Prozess, der dies tun w√ºrde, der **TLS-Terminierungsproxy**.

Der TLS-Terminierungsproxy h√§tte Zugriff auf ein oder mehrere **TLS-Zertifikate** (HTTPS-Zertifikate).

Mithilfe der oben beschriebenen **SNI-Erweiterung** w√ºrde der TLS-Terminierungsproxy herausfinden, welches der verf√ºgbaren TLS-Zertifikate (HTTPS) er f√ºr diese Verbindung verwenden muss, und zwar das, welches mit der vom Client erwarteten Domain √ºbereinstimmt.

In diesem Fall w√ºrde er das Zertifikat f√ºr `someapp.example.com` verwenden.

<img src="/img/deployment/https/https03.svg">

Der Client **vertraut** bereits der Entit√§t, die das TLS-Zertifikat generiert hat (in diesem Fall Let's Encrypt, aber wir werden sp√§ter mehr dar√ºber erfahren), sodass er **verifizieren** kann, dass das Zertifikat g√ºltig ist.

Mithilfe des Zertifikats entscheiden der Client und der TLS-Terminierungsproxy dann, **wie der Rest der TCP-Kommunikation verschl√ºsselt werden soll**. Damit ist der **TLS-Handshake** abgeschlossen.

Danach verf√ºgen der Client und der Server √ºber eine **verschl√ºsselte TCP-Verbindung**, via TLS. Und dann k√∂nnen sie diese Verbindung verwenden, um die eigentliche **HTTP-Kommunikation** zu beginnen.

Und genau das ist **HTTPS**, es ist einfach **HTTP** innerhalb einer **sicheren TLS-Verbindung**, statt einer puren (unverschl√ºsselten) TCP-Verbindung.

/// tip | Tipp

Beachten Sie, dass die Verschl√ºsselung der Kommunikation auf der **TCP-Ebene** und nicht auf der HTTP-Ebene erfolgt.

///

### HTTPS-Request

Da Client und Server (sprich, der Browser und der TLS-Terminierungsproxy) nun √ºber eine **verschl√ºsselte TCP-Verbindung** verf√ºgen, k√∂nnen sie die **HTTP-Kommunikation** starten.

Der Client sendet also einen **HTTPS-Request**. Das ist einfach ein HTTP-Request √ºber eine verschl√ºsselte TLS-Verbindung.

<img src="/img/deployment/https/https04.svg">

### Den Request entschl√ºsseln

Der TLS-Terminierungsproxy w√ºrde die vereinbarte Verschl√ºsselung zum **Entschl√ºsseln des Requests** verwenden und den **einfachen (entschl√ºsselten) HTTP-Request** an den Prozess weiterleiten, der die Anwendung ausf√ºhrt (z. B. einen Prozess, bei dem Uvicorn die FastAPI-Anwendung ausf√ºhrt).

<img src="/img/deployment/https/https05.svg">

### HTTP-Response

Die Anwendung w√ºrde den Request verarbeiten und eine **einfache (unverschl√ºsselte) HTTP-Response** an den TLS-Terminierungsproxy senden.

<img src="/img/deployment/https/https06.svg">

### HTTPS-Response

Der TLS-Terminierungsproxy w√ºrde dann die Response mithilfe der zuvor vereinbarten Kryptografie (als das Zertifikat f√ºr `someapp.example.com` verhandelt wurde) **verschl√ºsseln** und sie an den Browser zur√ºcksenden.

Als N√§chstes √ºberpr√ºft der Browser, ob die Response g√ºltig und mit dem richtigen kryptografischen Schl√ºssel usw. verschl√ºsselt ist. Anschlie√üend **entschl√ºsselt er die Response** und verarbeitet sie.

<img src="/img/deployment/https/https07.svg">

Der Client (Browser) wei√ü, dass die Response vom richtigen Server kommt, da dieser die Kryptografie verwendet, die zuvor mit dem **HTTPS-Zertifikat** vereinbart wurde.

### Mehrere Anwendungen

Auf demselben Server (oder denselben Servern) k√∂nnten sich **mehrere Anwendungen** befinden, beispielsweise andere API-Programme oder eine Datenbank.

Nur ein Prozess kann diese spezifische IP und den Port verarbeiten (in unserem Beispiel der TLS-Terminierungsproxy), aber die anderen Anwendungen/Prozesse k√∂nnen auch auf dem/den Server(n) ausgef√ºhrt werden, solange sie nicht versuchen, dieselbe **Kombination aus √∂ffentlicher IP und Port** zu verwenden.

<img src="/img/deployment/https/https08.svg">

Auf diese Weise k√∂nnte der TLS-Terminierungsproxy HTTPS und Zertifikate f√ºr **mehrere Domains**, f√ºr mehrere Anwendungen, verarbeiten und die Requests dann jeweils an die richtige Anwendung weiterleiten.

### Verl√§ngerung des Zertifikats

Irgendwann in der Zukunft w√ºrde jedes Zertifikat **ablaufen** (etwa 3 Monate nach dem Erwerb).

Und dann g√§be es ein anderes Programm (in manchen F√§llen ist es ein anderes Programm, in manchen F√§llen ist es derselbe TLS-Terminierungsproxy), das mit Let's Encrypt kommuniziert und das/die Zertifikat(e) erneuert.

<img src="/img/deployment/https/https.svg">

Die **TLS-Zertifikate** sind **einem Domainnamen zugeordnet**, nicht einer IP-Adresse.

Um die Zertifikate zu erneuern, muss das erneuernde Programm der Beh√∂rde (Let's Encrypt) **nachweisen**, dass es diese Domain tats√§chlich **besitzt und kontrolliert**.

Um dies zu erreichen und den unterschiedlichen Anwendungsanforderungen gerecht zu werden, gibt es mehrere M√∂glichkeiten. Einige beliebte Methoden sind:

* **Einige DNS-Eintr√§ge √§ndern**.
    * Hierf√ºr muss das erneuernde Programm die APIs des DNS-Anbieters unterst√ºtzen. Je nachdem, welchen DNS-Anbieter Sie verwenden, kann dies eine Option sein oder auch nicht.
* **Als Server ausf√ºhren** (zumindest w√§hrend des Zertifikatserwerbsvorgangs), auf der √∂ffentlichen IP-Adresse, die der Domain zugeordnet ist.
    * Wie oben erw√§hnt, kann nur ein Prozess eine bestimmte IP und einen bestimmten Port √ºberwachen.
    * Das ist einer der Gr√ºnde, warum es sehr n√ºtzlich ist, wenn derselbe TLS-Terminierungsproxy auch den Zertifikats-Erneuerungsprozess √ºbernimmt.
    * Andernfalls m√ºssen Sie m√∂glicherweise den TLS-Terminierungsproxy vor√ºbergehend stoppen, das Programm starten, welches die neuen Zertifikate beschafft, diese dann mit dem TLS-Terminierungsproxy konfigurieren und dann den TLS-Terminierungsproxy neu starten. Das ist nicht ideal, da Ihre Anwendung(en) w√§hrend der Zeit, in der der TLS-Terminierungsproxy ausgeschaltet ist, nicht erreichbar ist/sind.

Dieser ganze Erneuerungsprozess, w√§hrend die Anwendung weiterhin bereitgestellt wird, ist einer der Hauptgr√ºnde, warum Sie ein **separates System zur Verarbeitung von HTTPS** mit einem TLS-Terminierungsproxy haben m√∂chten, anstatt einfach die TLS-Zertifikate direkt mit dem Anwendungsserver zu verwenden (z. B. Uvicorn).

## Zusammenfassung

**HTTPS** zu haben ist sehr wichtig und in den meisten F√§llen eine **kritische Anforderung**. Die meiste Arbeit, die Sie als Entwickler in Bezug auf HTTPS aufwenden m√ºssen, besteht lediglich darin, **diese Konzepte zu verstehen** und wie sie funktionieren.

Sobald Sie jedoch die grundlegenden Informationen zu **HTTPS f√ºr Entwickler** kennen, k√∂nnen Sie verschiedene Tools problemlos kombinieren und konfigurieren, um alles auf einfache Weise zu verwalten.

In einigen der n√§chsten Kapitel zeige ich Ihnen einige konkrete Beispiele f√ºr die Einrichtung von **HTTPS** f√ºr **FastAPI**-Anwendungen. üîí


================================================
File: /docs/de/docs/deployment/index.md
================================================
# Deployment

Das Deployment einer **FastAPI**-Anwendung ist relativ einfach.

## Was bedeutet Deployment?

**Deployment** (Deutsch etwa: **Bereitstellen der Anwendung**) bedeutet, die notwendigen Schritte durchzuf√ºhren, um die Anwendung **f√ºr die Endbenutzer verf√ºgbar** zu machen.

Bei einer **Web-API** bedeutet das normalerweise, diese auf einem **entfernten Rechner** zu platzieren, mit einem **Serverprogramm**, welches gute Leistung, Stabilit√§t, usw. bietet, damit Ihre **Benutzer** auf die Anwendung effizient und ohne Unterbrechungen oder Probleme **zugreifen** k√∂nnen.

Das steht im Gegensatz zu den **Entwicklungsphasen**, in denen Sie st√§ndig den Code √§ndern, kaputt machen, reparieren, den Entwicklungsserver stoppen und neu starten, usw.

## Deployment-Strategien

Abh√§ngig von Ihrem spezifischen Anwendungsfall und den von Ihnen verwendeten Tools gibt es mehrere M√∂glichkeiten, das zu tun.

Sie k√∂nnten mithilfe einer Kombination von Tools selbst **einen Server bereitstellen**, Sie k√∂nnten einen **Cloud-Dienst** nutzen, der einen Teil der Arbeit f√ºr Sie erledigt, oder andere m√∂gliche Optionen.

Ich zeige Ihnen einige der wichtigsten Konzepte, die Sie beim Deployment einer **FastAPI**-Anwendung wahrscheinlich ber√ºcksichtigen sollten (obwohl das meiste davon auch f√ºr jede andere Art von Webanwendung gilt).

In den n√§chsten Abschnitten erfahren Sie mehr √ºber die zu beachtenden Details und √ºber die Techniken, das zu tun. ‚ú®


================================================
File: /docs/de/docs/deployment/manually.md
================================================
# Einen Server manuell ausf√ºhren ‚Äì Uvicorn

Das Wichtigste, was Sie zum Ausf√ºhren einer **FastAPI**-Anwendung auf einer entfernten Servermaschine ben√∂tigen, ist ein ASGI-Serverprogramm, wie **Uvicorn**.

Es gibt 3 Hauptalternativen:

* <a href="https://www.uvicorn.org/" class="external-link" target="_blank">Uvicorn</a>: ein hochperformanter ASGI-Server.
* <a href="https://hypercorn.readthedocs.io/" class="external-link" target="_blank">Hypercorn</a>: ein ASGI-Server, der unter anderem mit HTTP/2 und Trio kompatibel ist.
* <a href="https://github.com/django/daphne" class="external-link" target="_blank">Daphne</a>: Der f√ºr Django Channels entwickelte ASGI-Server.

## Servermaschine und Serverprogramm

Bei den Benennungen gibt es ein kleines Detail, das Sie beachten sollten. üí°

Das Wort ‚Äû**Server**‚Äú bezieht sich h√§ufig sowohl auf den entfernten-/Cloud-Computer (die physische oder virtuelle Maschine) als auch auf das Programm, das auf dieser Maschine ausgef√ºhrt wird (z. B. Uvicorn).

Denken Sie einfach daran, wenn Sie ‚ÄûServer‚Äú im Allgemeinen lesen, dass es sich auf eines dieser beiden Dinge beziehen kann.

Wenn man sich auf die entfernte Maschine bezieht, wird sie √ºblicherweise als **Server**, aber auch als **Maschine**, **VM** (virtuelle Maschine) oder **Knoten** bezeichnet. Diese Begriffe beziehen sich auf irgendeine Art von entfernten Rechner, normalerweise unter Linux, auf dem Sie Programme ausf√ºhren.

## Das Serverprogramm installieren

Sie k√∂nnen einen ASGI-kompatiblen Server installieren mit:

//// tab | Uvicorn

* <a href="https://www.uvicorn.org/" class="external-link" target="_blank">Uvicorn</a>, ein blitzschneller ASGI-Server, basierend auf uvloop und httptools.

<div class="termy">

```console
$ pip install "uvicorn[standard]"

---> 100%
```

</div>

/// tip | Tipp

Durch das Hinzuf√ºgen von `standard` installiert und verwendet Uvicorn einige empfohlene zus√§tzliche Abh√§ngigkeiten.

Inklusive `uvloop`, einen hochperformanten Drop-in-Ersatz f√ºr `asyncio`, welcher f√ºr einen gro√üen Leistungsschub bei der Nebenl√§ufigkeit sorgt.

///

////

//// tab | Hypercorn

* <a href="https://github.com/pgjones/hypercorn" class="external-link" target="_blank">Hypercorn</a>, ein ASGI-Server, der auch mit HTTP/2 kompatibel ist.

<div class="termy">

```console
$ pip install hypercorn

---> 100%
```

</div>

... oder jeden anderen ASGI-Server.

////

## Das Serverprogramm ausf√ºhren

Anschlie√üend k√∂nnen Sie Ihre Anwendung auf die gleiche Weise ausf√ºhren, wie Sie es in den Tutorials getan haben, jedoch ohne die Option `--reload`, z. B.:

//// tab | Uvicorn

<div class="termy">

```console
$ uvicorn main:app --host 0.0.0.0 --port 80

<span style="color: green;">INFO</span>:     Uvicorn running on http://0.0.0.0:80 (Press CTRL+C to quit)
```

</div>

////

//// tab | Hypercorn

<div class="termy">

```console
$ hypercorn main:app --bind 0.0.0.0:80

Running on 0.0.0.0:8080 over http (CTRL + C to quit)
```

</div>

////

/// warning | Achtung

Denken Sie daran, die Option `--reload` zu entfernen, wenn Sie diese verwendet haben.

Die Option `--reload` verbraucht viel mehr Ressourcen, ist instabiler, usw.

Sie hilft sehr w√§hrend der **Entwicklung**, aber Sie sollten sie **nicht** in der **Produktion** verwenden.

///

## Hypercorn mit Trio

Starlette und **FastAPI** basieren auf <a href="https://anyio.readthedocs.io/en/stable/" class="external-link" target="_blank">AnyIO</a>, welches diese sowohl mit der Python-Standardbibliothek <a href="https://docs.python.org/3/library/asyncio-task.html" class="external-link" target="_blank">asyncio</a>, als auch mit <a href="https://trio.readthedocs.io/en/stable/" class="external-link" target="_blank">Trio</a> kompatibel macht.

Dennoch ist Uvicorn derzeit nur mit asyncio kompatibel und verwendet normalerweise <a href="https://github.com/MagicStack/uvloop" class="external-link" target="_blank">`uvloop`</a>, den leistungsstarken Drop-in-Ersatz f√ºr `asyncio`.

Wenn Sie jedoch **Trio** direkt verwenden m√∂chten, k√∂nnen Sie **Hypercorn** verwenden, da dieses es unterst√ºtzt. ‚ú®

### Hypercorn mit Trio installieren

Zuerst m√ºssen Sie Hypercorn mit Trio-Unterst√ºtzung installieren:

<div class="termy">

```console
$ pip install "hypercorn[trio]"
---> 100%
```

</div>

### Mit Trio ausf√ºhren

Dann k√∂nnen Sie die Befehlszeilenoption `--worker-class` mit dem Wert `trio` √ºbergeben:

<div class="termy">

```console
$ hypercorn main:app --worker-class trio
```

</div>

Und das startet Hypercorn mit Ihrer Anwendung und verwendet Trio als Backend.

Jetzt k√∂nnen Sie Trio intern in Ihrer Anwendung verwenden. Oder noch besser: Sie k√∂nnen AnyIO verwenden, sodass Ihr Code sowohl mit Trio als auch asyncio kompatibel ist. üéâ

## Konzepte des Deployments

Obige Beispiele f√ºhren das Serverprogramm (z. B. Uvicorn) aus, starten **einen einzelnen Prozess** und √ºberwachen alle IPs (`0.0.0.0`) an einem vordefinierten Port (z. B. `80`).

Das ist die Grundidee. Aber Sie m√∂chten sich wahrscheinlich um einige zus√§tzliche Dinge k√ºmmern, wie zum Beispiel:

* Sicherheit ‚Äì HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* Replikation (die Anzahl der laufenden Prozesse)
* Arbeitsspeicher
* Schritte vor dem Start

In den n√§chsten Kapiteln erz√§hle ich Ihnen mehr √ºber jedes dieser Konzepte, wie Sie √ºber diese nachdenken, und gebe Ihnen einige konkrete Beispiele mit Strategien f√ºr den Umgang damit. üöÄ


================================================
File: /docs/de/docs/deployment/server-workers.md
================================================
# Serverworker ‚Äì Gunicorn mit Uvicorn

Schauen wir uns die Deployment-Konzepte von fr√ºher noch einmal an:

* Sicherheit ‚Äì HTTPS
* Beim Hochfahren ausf√ºhren
* Neustarts
* **Replikation (die Anzahl der laufenden Prozesse)**
* Arbeitsspeicher
* Schritte vor dem Start

Bis zu diesem Punkt, in allen Tutorials in der Dokumentation, haben Sie wahrscheinlich ein **Serverprogramm** wie Uvicorn ausgef√ºhrt, in einem **einzelnen Prozess**.

Wenn Sie Anwendungen bereitstellen, m√∂chten Sie wahrscheinlich eine gewisse **Replikation von Prozessen**, um **mehrere CPU-Kerne** zu nutzen und mehr Requests bearbeiten zu k√∂nnen.

Wie Sie im vorherigen Kapitel √ºber [Deployment-Konzepte](concepts.md){.internal-link target=_blank} gesehen haben, gibt es mehrere Strategien, die Sie anwenden k√∂nnen.

Hier zeige ich Ihnen, wie Sie <a href="https://gunicorn.org/" class="external-link" target="_blank">**Gunicorn**</a> mit **Uvicorn Workerprozessen** verwenden.

/// info

Wenn Sie Container verwenden, beispielsweise mit Docker oder Kubernetes, erz√§hle ich Ihnen mehr dar√ºber im n√§chsten Kapitel: [FastAPI in Containern ‚Äì Docker](docker.md){.internal-link target=_blank}.

Insbesondere wenn die Anwendung auf **Kubernetes** l√§uft, werden Sie Gunicorn wahrscheinlich **nicht** verwenden wollen und stattdessen **einen einzelnen Uvicorn-Prozess pro Container** ausf√ºhren wollen, aber ich werde Ihnen sp√§ter in diesem Kapitel mehr dar√ºber erz√§hlen.

///

## Gunicorn mit Uvicorn-Workern

**Gunicorn** ist haupts√§chlich ein Anwendungsserver, der den **WSGI-Standard** verwendet. Das bedeutet, dass Gunicorn Anwendungen wie Flask und Django ausliefern kann. Gunicorn selbst ist nicht mit **FastAPI** kompatibel, da FastAPI den neuesten **<a href="https://asgi.readthedocs.io/en/latest/" class="external-link" target="_blank">ASGI-Standard</a>** verwendet.

Aber Gunicorn kann als **Prozessmanager** arbeiten und Benutzer k√∂nnen ihm mitteilen, welche bestimmte **Workerprozessklasse** verwendet werden soll. Dann w√ºrde Gunicorn einen oder mehrere **Workerprozesse** starten, diese Klasse verwendend.

Und **Uvicorn** hat eine **Gunicorn-kompatible Workerklasse**.

Mit dieser Kombination w√ºrde Gunicorn als **Prozessmanager** fungieren und den **Port** und die **IP** abh√∂ren. Und er w√ºrde die Kommunikation an die Workerprozesse **weiterleiten**, welche die **Uvicorn-Klasse** ausf√ºhren.

Und dann w√§re die Gunicorn-kompatible **Uvicorn-Worker**-Klasse daf√ºr verantwortlich, die von Gunicorn gesendeten Daten in den ASGI-Standard zu konvertieren, damit FastAPI diese verwenden kann.

## Gunicorn und Uvicorn installieren

<div class="termy">

```console
$ pip install "uvicorn[standard]" gunicorn

---> 100%
```

</div>

Dadurch wird sowohl Uvicorn mit zus√§tzlichen `standard`-Packages (um eine hohe Leistung zu erzielen) als auch Gunicorn installiert.

## Gunicorn mit Uvicorn-Workern ausf√ºhren

Dann k√∂nnen Sie Gunicorn ausf√ºhren mit:

<div class="termy">

```console
$ gunicorn main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:80

[19499] [INFO] Starting gunicorn 20.1.0
[19499] [INFO] Listening at: http://0.0.0.0:80 (19499)
[19499] [INFO] Using worker: uvicorn.workers.UvicornWorker
[19511] [INFO] Booting worker with pid: 19511
[19513] [INFO] Booting worker with pid: 19513
[19514] [INFO] Booting worker with pid: 19514
[19515] [INFO] Booting worker with pid: 19515
[19511] [INFO] Started server process [19511]
[19511] [INFO] Waiting for application startup.
[19511] [INFO] Application startup complete.
[19513] [INFO] Started server process [19513]
[19513] [INFO] Waiting for application startup.
[19513] [INFO] Application startup complete.
[19514] [INFO] Started server process [19514]
[19514] [INFO] Waiting for application startup.
[19514] [INFO] Application startup complete.
[19515] [INFO] Started server process [19515]
[19515] [INFO] Waiting for application startup.
[19515] [INFO] Application startup complete.
```

</div>

Sehen wir uns an, was jede dieser Optionen bedeutet:

* `main:app`: Das ist die gleiche Syntax, die auch von Uvicorn verwendet wird. `main` bedeutet das Python-Modul mit dem Namen `main`, also eine Datei `main.py`. Und `app` ist der Name der Variable, welche die **FastAPI**-Anwendung ist.
    * Stellen Sie sich einfach vor, dass `main:app` einer Python-`import`-Anweisung wie der folgenden entspricht:

        ```Python
        from main import app
        ```

    * Der Doppelpunkt in `main:app` entspricht also dem Python-`import`-Teil in `from main import app`.

* `--workers`: Die Anzahl der zu verwendenden Workerprozesse, jeder f√ºhrt einen Uvicorn-Worker aus, in diesem Fall 4 Worker.

* `--worker-class`: Die Gunicorn-kompatible Workerklasse zur Verwendung in den Workerprozessen.
    * Hier √ºbergeben wir die Klasse, die Gunicorn etwa so importiert und verwendet:

        ```Python
        import uvicorn.workers.UvicornWorker
        ```

* `--bind`: Das teilt Gunicorn die IP und den Port mit, welche abgeh√∂rt werden sollen, wobei ein Doppelpunkt (`:`) verwendet wird, um die IP und den Port zu trennen.
    * Wenn Sie Uvicorn direkt ausf√ºhren w√ºrden, w√ºrden Sie anstelle von `--bind 0.0.0.0:80` (die Gunicorn-Option) stattdessen `--host 0.0.0.0` und `--port 80` verwenden.

In der Ausgabe k√∂nnen Sie sehen, dass die **PID** (Prozess-ID) jedes Prozesses angezeigt wird (es ist nur eine Zahl).

Sie k√∂nnen sehen, dass:

* Der Gunicorn **Prozessmanager** beginnt, mit der PID `19499` (in Ihrem Fall ist es eine andere Nummer).
* Dann beginnt er zu lauschen: `Listening at: http://0.0.0.0:80`.
* Dann erkennt er, dass er die Workerklasse `uvicorn.workers.UvicornWorker` verwenden muss.
* Und dann werden **4 Worker** gestartet, jeder mit seiner eigenen PID: `19511`, `19513`, `19514` und `19515`.

Gunicorn w√ºrde sich bei Bedarf auch um die Verwaltung **beendeter Prozesse** und den **Neustart** von Prozessen k√ºmmern, um die Anzahl der Worker aufrechtzuerhalten. Das hilft also teilweise beim **Neustarts**-Konzept aus der obigen Liste.

Dennoch m√∂chten Sie wahrscheinlich auch etwas au√üerhalb haben, um sicherzustellen, dass Gunicorn bei Bedarf **neu gestartet wird**, und er auch **beim Hochfahren ausgef√ºhrt wird**, usw.

## Uvicorn mit Workern

Uvicorn bietet ebenfalls die M√∂glichkeit, mehrere **Workerprozesse** zu starten und auszuf√ºhren.

Dennoch sind die F√§higkeiten von Uvicorn zur Abwicklung von Workerprozessen derzeit eingeschr√§nkter als die von Gunicorn. Wenn Sie also einen Prozessmanager auf dieser Ebene (auf der Python-Ebene) haben m√∂chten, ist es vermutlich besser, es mit Gunicorn als Prozessmanager zu versuchen.

Wie auch immer, Sie w√ºrden es so ausf√ºhren:

<div class="termy">

```console
$ uvicorn main:app --host 0.0.0.0 --port 8080 --workers 4
<font color="#A6E22E">INFO</font>:     Uvicorn running on <b>http://0.0.0.0:8080</b> (Press CTRL+C to quit)
<font color="#A6E22E">INFO</font>:     Started parent process [<font color="#A1EFE4"><b>27365</b></font>]
<font color="#A6E22E">INFO</font>:     Started server process [<font color="#A1EFE4">27368</font>]
<font color="#A6E22E">INFO</font>:     Waiting for application startup.
<font color="#A6E22E">INFO</font>:     Application startup complete.
<font color="#A6E22E">INFO</font>:     Started server process [<font color="#A1EFE4">27369</font>]
<font color="#A6E22E">INFO</font>:     Waiting for application startup.
<font color="#A6E22E">INFO</font>:     Application startup complete.
<font color="#A6E22E">INFO</font>:     Started server process [<font color="#A1EFE4">27370</font>]
<font color="#A6E22E">INFO</font>:     Waiting for application startup.
<font color="#A6E22E">INFO</font>:     Application startup complete.
<font color="#A6E22E">INFO</font>:     Started server process [<font color="#A1EFE4">27367</font>]
<font color="#A6E22E">INFO</font>:     Waiting for application startup.
<font color="#A6E22E">INFO</font>:     Application startup complete.
```

</div>

Die einzige neue Option hier ist `--workers`, die Uvicorn anweist, 4 Workerprozesse zu starten.

Sie k√∂nnen auch sehen, dass die **PID** jedes Prozesses angezeigt wird, `27365` f√ºr den √ºbergeordneten Prozess (dies ist der **Prozessmanager**) und eine f√ºr jeden Workerprozess: `27368`, `27369`, `27370` und `27367`.

## Deployment-Konzepte

Hier haben Sie gesehen, wie Sie mit **Gunicorn** (oder Uvicorn) **Uvicorn-Workerprozesse** verwalten, um die Ausf√ºhrung der Anwendung zu **parallelisieren**, **mehrere Kerne** der CPU zu nutzen und in der Lage zu sein, **mehr Requests** zu bedienen.

In der Liste der Deployment-Konzepte von oben w√ºrde die Verwendung von Workern haupts√§chlich beim **Replikation**-Teil und ein wenig bei **Neustarts** helfen, aber Sie m√ºssen sich trotzdem um die anderen k√ºmmern:

* **Sicherheit ‚Äì HTTPS**
* **Beim Hochfahren ausf√ºhren**
* **Neustarts**
* Replikation (die Anzahl der laufenden Prozesse)
* **Arbeitsspeicher**
* **Schritte vor dem Start**

## Container und Docker

Im n√§chsten Kapitel √ºber [FastAPI in Containern ‚Äì Docker](docker.md){.internal-link target=_blank} werde ich einige Strategien erl√§utern, die Sie f√ºr den Umgang mit den anderen **Deployment-Konzepten** verwenden k√∂nnen.

Ich zeige Ihnen auch das **offizielle Docker-Image**, welches **Gunicorn mit Uvicorn-Workern** und einige Standardkonfigurationen enth√§lt, die f√ºr einfache F√§lle n√ºtzlich sein k√∂nnen.

Dort zeige ich Ihnen auch, wie Sie **Ihr eigenes Image von Grund auf erstellen**, um einen einzelnen Uvicorn-Prozess (ohne Gunicorn) auszuf√ºhren. Es ist ein einfacher Vorgang und wahrscheinlich das, was Sie tun m√∂chten, wenn Sie ein verteiltes Containerverwaltungssystem wie **Kubernetes** verwenden.

## Zusammenfassung

Sie k√∂nnen **Gunicorn** (oder auch Uvicorn) als Prozessmanager mit Uvicorn-Workern verwenden, um **Multikern-CPUs** zu nutzen und **mehrere Prozesse parallel** auszuf√ºhren.

Sie k√∂nnen diese Tools und Ideen nutzen, wenn Sie **Ihr eigenes Deployment-System** einrichten und sich dabei selbst um die anderen Deployment-Konzepte k√ºmmern.

Schauen Sie sich das n√§chste Kapitel an, um mehr √ºber **FastAPI** mit Containern (z. B. Docker und Kubernetes) zu erfahren. Sie werden sehen, dass diese Tools auch einfache M√∂glichkeiten bieten, die anderen **Deployment-Konzepte** zu l√∂sen. ‚ú®


================================================
File: /docs/de/docs/deployment/versions.md
================================================
# √úber FastAPI-Versionen

**FastAPI** wird bereits in vielen Anwendungen und Systemen produktiv eingesetzt. Und die Testabdeckung wird bei 100 % gehalten. Aber seine Entwicklung geht immer noch schnell voran.

Es werden regelm√§√üig neue Funktionen hinzugef√ºgt, Fehler werden regelm√§√üig behoben und der Code wird weiterhin kontinuierlich verbessert.

Aus diesem Grund sind die aktuellen Versionen immer noch `0.x.x`, was darauf hindeutet, dass jede Version m√∂glicherweise nicht abw√§rtskompatible √Ñnderungen haben k√∂nnte. Dies folgt den Konventionen der <a href="https://semver.org/" class="external-link" target="_blank">semantischen Versionierung</a>.

Sie k√∂nnen jetzt Produktionsanwendungen mit **FastAPI** erstellen (und das tun Sie wahrscheinlich schon seit einiger Zeit), Sie m√ºssen nur sicherstellen, dass Sie eine Version verwenden, die korrekt mit dem Rest Ihres Codes funktioniert.

## `fastapi`-Version pinnen

Als Erstes sollten Sie die Version von **FastAPI**, die Sie verwenden, an die h√∂chste Version ‚Äûpinnen‚Äú, von der Sie wissen, dass sie f√ºr Ihre Anwendung korrekt funktioniert.

Angenommen, Sie verwenden in Ihrer Anwendung die Version `0.45.0`.

Wenn Sie eine `requirements.txt`-Datei verwenden, k√∂nnen Sie die Version wie folgt angeben:

```txt
fastapi==0.45.0
```

Das w√ºrde bedeuten, dass Sie genau die Version `0.45.0` verwenden.

Oder Sie k√∂nnen sie auch anpinnen mit:

```txt
fastapi>=0.45.0,<0.46.0
```

Das w√ºrde bedeuten, dass Sie eine Version `0.45.0` oder h√∂her verwenden w√ºrden, aber kleiner als `0.46.0`, beispielsweise w√ºrde eine Version `0.45.2` immer noch akzeptiert.

Wenn Sie zum Verwalten Ihrer Installationen andere Tools wie Poetry, Pipenv oder andere verwenden, sie verf√ºgen alle √ºber eine M√∂glichkeit, bestimmte Versionen f√ºr Ihre Packages zu definieren.

## Verf√ºgbare Versionen

Die verf√ºgbaren Versionen k√∂nnen Sie in den [Release Notes](../release-notes.md){.internal-link target=_blank} einsehen (z. B. um zu √ºberpr√ºfen, welches die neueste Version ist).

## √úber Versionen

Gem√§√ü den Konventionen zur semantischen Versionierung k√∂nnte jede Version unter `1.0.0` potenziell nicht abw√§rtskompatible √Ñnderungen hinzuf√ºgen.

FastAPI folgt auch der Konvention, dass jede ‚ÄûPATCH‚Äú-Versions√§nderung f√ºr Bugfixes und abw√§rtskompatible √Ñnderungen gedacht ist.

/// tip | Tipp

Der ‚ÄûPATCH‚Äú ist die letzte Zahl, zum Beispiel ist in `0.2.3` die PATCH-Version `3`.

///

Sie sollten also in der Lage sein, eine Version wie folgt anzupinnen:

```txt
fastapi>=0.45.0,<0.46.0
```

Nicht abw√§rtskompatible √Ñnderungen und neue Funktionen werden in ‚ÄûMINOR‚Äú-Versionen hinzugef√ºgt.

/// tip | Tipp

‚ÄûMINOR‚Äú ist die Zahl in der Mitte, zum Beispiel ist in `0.2.3` die MINOR-Version `2`.

///

## Upgrade der FastAPI-Versionen

Sie sollten Tests f√ºr Ihre Anwendung hinzuf√ºgen.

Mit **FastAPI** ist das sehr einfach (dank Starlette), schauen Sie sich die Dokumentation an: [Testen](../tutorial/testing.md){.internal-link target=_blank}

Nachdem Sie Tests erstellt haben, k√∂nnen Sie die **FastAPI**-Version auf eine neuere Version aktualisieren und sicherstellen, dass Ihr gesamter Code ordnungsgem√§√ü funktioniert, indem Sie Ihre Tests ausf√ºhren.

Wenn alles funktioniert oder nachdem Sie die erforderlichen √Ñnderungen vorgenommen haben und alle Ihre Tests bestehen, k√∂nnen Sie Ihr `fastapi` an die neue aktuelle Version pinnen.

## √úber Starlette

Sie sollten die Version von `starlette` nicht pinnen.

Verschiedene Versionen von **FastAPI** verwenden eine bestimmte neuere Version von Starlette.

Sie k√∂nnen **FastAPI** also einfach die korrekte Starlette-Version verwenden lassen.

## √úber Pydantic

Pydantic integriert die Tests f√ºr **FastAPI** in seine eigenen Tests, sodass neue Versionen von Pydantic (√ºber `1.0.0`) immer mit FastAPI kompatibel sind.

Sie k√∂nnen Pydantic an jede f√ºr Sie geeignete Version √ºber `1.0.0` und unter `2.0.0` anpinnen.

Zum Beispiel:
```txt
pydantic>=1.2.0,<2.0.0
```


================================================
File: /docs/de/docs/how-to/conditional-openapi.md
================================================
# Bedingte OpenAPI

Bei Bedarf k√∂nnen Sie OpenAPI mithilfe von Einstellungen und Umgebungsvariablen abh√§ngig von der Umgebung bedingt konfigurieren und sogar vollst√§ndig deaktivieren.

## √úber Sicherheit, APIs und Dokumentation

Das Verstecken Ihrer Dokumentationsoberfl√§chen in der Produktion *sollte nicht* die Methode sein, Ihre API zu sch√ºtzen.

Dadurch wird Ihrer API keine zus√§tzliche Sicherheit hinzugef√ºgt, die *Pfadoperationen* sind weiterhin dort verf√ºgbar, wo sie sich befinden.

Wenn Ihr Code eine Sicherheitsl√ºcke aufweist, ist diese weiterhin vorhanden.

Das Verstecken der Dokumentation macht es nur schwieriger zu verstehen, wie mit Ihrer API interagiert werden kann, und k√∂nnte es auch schwieriger machen, diese in der Produktion zu debuggen. Man k√∂nnte es einfach als eine Form von <a href="https://de.wikipedia.org/wiki/Security_through_obscurity" class="external-link" target="_blank">Security through obscurity</a> betrachten.

Wenn Sie Ihre API sichern m√∂chten, gibt es mehrere bessere Dinge, die Sie tun k√∂nnen, zum Beispiel:

* Stellen Sie sicher, dass Sie √ºber gut definierte Pydantic-Modelle f√ºr Ihre Requestbodys und Responses verf√ºgen.
* Konfigurieren Sie alle erforderlichen Berechtigungen und Rollen mithilfe von Abh√§ngigkeiten.
* Speichern Sie niemals Klartext-Passw√∂rter, sondern nur Passwort-Hashes.
* Implementieren und verwenden Sie g√§ngige kryptografische Tools wie Passlib und JWT-Tokens, usw.
* F√ºgen Sie bei Bedarf detailliertere Berechtigungskontrollen mit OAuth2-Scopes hinzu.
* ... usw.

Dennoch kann es sein, dass Sie einen ganz bestimmten Anwendungsfall haben, bei dem Sie die API-Dokumentation f√ºr eine bestimmte Umgebung (z. B. f√ºr die Produktion) oder abh√§ngig von Konfigurationen aus Umgebungsvariablen wirklich deaktivieren m√ºssen.

## Bedingte OpenAPI aus Einstellungen und Umgebungsvariablen

Sie k√∂nnen problemlos dieselben Pydantic-Einstellungen verwenden, um Ihre generierte OpenAPI und die Dokumentationsoberfl√§chen zu konfigurieren.

Zum Beispiel:

{* ../../docs_src/conditional_openapi/tutorial001.py hl[6,11] *}

Hier deklarieren wir die Einstellung `openapi_url` mit dem gleichen Defaultwert `"/openapi.json"`.

Und dann verwenden wir das beim Erstellen der `FastAPI`-App.

Dann k√∂nnten Sie OpenAPI (einschlie√ülich der Dokumentationsoberfl√§chen) deaktivieren, indem Sie die Umgebungsvariable `OPENAPI_URL` auf einen leeren String setzen, wie zum Beispiel:

<div class="termy">

```console
$ OPENAPI_URL= uvicorn main:app

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

</div>

Wenn Sie dann zu den URLs unter `/openapi.json`, `/docs` oder `/redoc` gehen, erhalten Sie lediglich einen `404 Not Found`-Fehler, wie:

```JSON
{
    "detail": "Not Found"
}
```


================================================
File: /docs/de/docs/how-to/configure-swagger-ui.md
================================================
# Swagger-Oberfl√§che konfigurieren

Sie k√∂nnen einige zus√§tzliche <a href="https://swagger.io/docs/open-source-tools/swagger-ui/usage/configuration/" class="external-link" target="_blank">Parameter der Swagger-Oberfl√§che</a> konfigurieren.

Um diese zu konfigurieren, √ºbergeben Sie das Argument `swagger_ui_parameters` beim Erstellen des `FastAPI()`-App-Objekts oder an die Funktion `get_swagger_ui_html()`.

`swagger_ui_parameters` empf√§ngt ein Dict mit den Konfigurationen, die direkt an die Swagger-Oberfl√§che √ºbergeben werden.

FastAPI konvertiert die Konfigurationen nach **JSON**, um diese mit JavaScript kompatibel zu machen, da die Swagger-Oberfl√§che das ben√∂tigt.

## Syntaxhervorhebung deaktivieren

Sie k√∂nnten beispielsweise die Syntaxhervorhebung in der Swagger-Oberfl√§che deaktivieren.

Ohne √Ñnderung der Einstellungen ist die Syntaxhervorhebung standardm√§√üig aktiviert:

<img src="/img/tutorial/extending-openapi/image02.png">

Sie k√∂nnen sie jedoch deaktivieren, indem Sie `syntaxHighlight` auf `False` setzen:

{* ../../docs_src/configure_swagger_ui/tutorial001.py hl[3] *}

... und dann zeigt die Swagger-Oberfl√§che die Syntaxhervorhebung nicht mehr an:

<img src="/img/tutorial/extending-openapi/image03.png">

## Das Theme √§ndern

Auf die gleiche Weise k√∂nnten Sie das Theme der Syntaxhervorhebung mit dem Schl√ºssel `syntaxHighlight.theme` festlegen (beachten Sie, dass er einen Punkt in der Mitte hat):

{* ../../docs_src/configure_swagger_ui/tutorial002.py hl[3] *}

Obige Konfiguration w√ºrde das Theme f√ºr die Farbe der Syntaxhervorhebung √§ndern:

<img src="/img/tutorial/extending-openapi/image04.png">

## Defaultparameter der Swagger-Oberfl√§che √§ndern

FastAPI enth√§lt einige Defaultkonfigurationsparameter, die f√ºr die meisten Anwendungsf√§lle geeignet sind.

Es umfasst die folgenden Defaultkonfigurationen:

{* ../../fastapi/openapi/docs.py ln[7:23] *}

Sie k√∂nnen jede davon √ºberschreiben, indem Sie im Argument `swagger_ui_parameters` einen anderen Wert festlegen.

Um beispielsweise `deepLinking` zu deaktivieren, k√∂nnten Sie folgende Einstellungen an `swagger_ui_parameters` √ºbergeben:

{* ../../docs_src/configure_swagger_ui/tutorial003.py hl[3] *}

## Andere Parameter der Swagger-Oberfl√§che

Um alle anderen m√∂glichen Konfigurationen zu sehen, die Sie verwenden k√∂nnen, lesen Sie die offizielle <a href="https://swagger.io/docs/open-source-tools/swagger-ui/usage/configuration/" class="external-link" target="_blank">Dokumentation f√ºr die Parameter der Swagger-Oberfl√§che</a>.

## JavaScript-basierte Einstellungen

Die Swagger-Oberfl√§che erlaubt, dass andere Konfigurationen auch **JavaScript**-Objekte sein k√∂nnen (z. B. JavaScript-Funktionen).

FastAPI umfasst auch diese Nur-JavaScript-`presets`-Einstellungen:

```JavaScript
presets: [
    SwaggerUIBundle.presets.apis,
    SwaggerUIBundle.SwaggerUIStandalonePreset
]
```

Dabei handelt es sich um **JavaScript**-Objekte, nicht um Strings, daher k√∂nnen Sie diese nicht direkt vom Python-Code aus √ºbergeben.

Wenn Sie solche JavaScript-Konfigurationen verwenden m√ºssen, k√∂nnen Sie einen der fr√ºher genannten Wege verwenden. √úberschreiben Sie alle *Pfadoperationen* der Swagger-Oberfl√§che und schreiben Sie manuell jedes ben√∂tigte JavaScript.


================================================
File: /docs/de/docs/how-to/custom-docs-ui-assets.md
================================================
# Statische Assets der Dokumentationsoberfl√§che (selbst hosten)

Die API-Dokumentation verwendet **Swagger UI** und **ReDoc**, und jede dieser Dokumentationen ben√∂tigt einige JavaScript- und CSS-Dateien.

Standardm√§√üig werden diese Dateien von einem <abbr title="Content Delivery Network ‚Äì Inhalte-Auslieferungs-Netzwerk: Ein Dienst, der normalerweise aus mehreren Servern besteht und statische Dateien wie JavaScript und CSS bereitstellt. Er wird normalerweise verwendet, um diese Dateien von einem Server bereitzustellen, der n√§her am Client liegt, wodurch die Leistung verbessert wird.">CDN</abbr> bereitgestellt.

Es ist jedoch m√∂glich, das anzupassen, ein bestimmtes CDN festzulegen oder die Dateien selbst bereitzustellen.

## Benutzerdefiniertes CDN f√ºr JavaScript und CSS

Nehmen wir an, Sie m√∂chten ein anderes <abbr title="Content Delivery Network">CDN</abbr> verwenden, zum Beispiel m√∂chten Sie `https://unpkg.com/` verwenden.

Das kann n√ºtzlich sein, wenn Sie beispielsweise in einem Land leben, in dem bestimmte URLs eingeschr√§nkt sind.

### Die automatischen Dokumentationen deaktivieren

Der erste Schritt besteht darin, die automatischen Dokumentationen zu deaktivieren, da diese standardm√§√üig das Standard-CDN verwenden.

Um diese zu deaktivieren, setzen Sie deren URLs beim Erstellen Ihrer `FastAPI`-App auf `None`:

{* ../../docs_src/custom_docs_ui/tutorial001.py hl[8] *}

### Die benutzerdefinierten Dokumentationen hinzuf√ºgen

Jetzt k√∂nnen Sie die *Pfadoperationen* f√ºr die benutzerdefinierten Dokumentationen erstellen.

Sie k√∂nnen die internen Funktionen von FastAPI wiederverwenden, um die HTML-Seiten f√ºr die Dokumentation zu erstellen und ihnen die erforderlichen Argumente zu √ºbergeben:

* `openapi_url`: die URL, unter welcher die HTML-Seite f√ºr die Dokumentation das OpenAPI-Schema f√ºr Ihre API abrufen kann. Sie k√∂nnen hier das Attribut `app.openapi_url` verwenden.
* `title`: der Titel Ihrer API.
* `oauth2_redirect_url`: Sie k√∂nnen hier `app.swagger_ui_oauth2_redirect_url` verwenden, um die Standardeinstellung zu verwenden.
* `swagger_js_url`: die URL, unter welcher der HTML-Code f√ºr Ihre Swagger-UI-Dokumentation die **JavaScript**-Datei abrufen kann. Dies ist die benutzerdefinierte CDN-URL.
* `swagger_css_url`: die URL, unter welcher der HTML-Code f√ºr Ihre Swagger-UI-Dokumentation die **CSS**-Datei abrufen kann. Dies ist die benutzerdefinierte CDN-URL.

Und genau so f√ºr ReDoc ...

{* ../../docs_src/custom_docs_ui/tutorial001.py hl[2:6,11:19,22:24,27:33] *}

/// tip | Tipp

Die *Pfadoperation* f√ºr `swagger_ui_redirect` ist ein Hilfsmittel bei der Verwendung von OAuth2.

Wenn Sie Ihre API mit einem OAuth2-Anbieter integrieren, k√∂nnen Sie sich authentifizieren und mit den erworbenen Anmeldeinformationen zur API-Dokumentation zur√ºckkehren. Und mit ihr interagieren, die echte OAuth2-Authentifizierung verwendend.

Swagger UI erledigt das hinter den Kulissen f√ºr Sie, ben√∂tigt aber diesen ‚ÄûUmleitungs‚Äú-Helfer.

///

### Eine *Pfadoperation* erstellen, um es zu testen

Um nun testen zu k√∂nnen, ob alles funktioniert, erstellen Sie eine *Pfadoperation*:

{* ../../docs_src/custom_docs_ui/tutorial001.py hl[36:38] *}

### Es ausprobieren

Jetzt sollten Sie in der Lage sein, zu Ihrer Dokumentation auf <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> zu gehen und die Seite neu zuladen, die Assets werden nun vom neuen CDN geladen.

## JavaScript und CSS f√ºr die Dokumentation selbst hosten

Das Selbst Hosten von JavaScript und CSS kann n√ºtzlich sein, wenn Sie beispielsweise m√∂chten, dass Ihre Anwendung auch offline, ohne bestehenden Internetzugang oder in einem lokalen Netzwerk weiter funktioniert.

Hier erfahren Sie, wie Sie diese Dateien selbst in derselben FastAPI-App bereitstellen und die Dokumentation f√ºr deren Verwendung konfigurieren.

### Projektdateistruktur

Nehmen wir an, die Dateistruktur Ihres Projekts sieht folgenderma√üen aus:

```
.
‚îú‚îÄ‚îÄ app
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
```

Erstellen Sie jetzt ein Verzeichnis zum Speichern dieser statischen Dateien.

Ihre neue Dateistruktur k√∂nnte so aussehen:

```
.
‚îú‚îÄ‚îÄ app
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.py
‚îî‚îÄ‚îÄ static/
```

### Die Dateien herunterladen

Laden Sie die f√ºr die Dokumentation ben√∂tigten statischen Dateien herunter und legen Sie diese im Verzeichnis `static/` ab.

Sie k√∂nnen wahrscheinlich mit der rechten Maustaste auf jeden Link klicken und eine Option wie etwa `Link speichern unter...` ausw√§hlen.

**Swagger UI** verwendet folgende Dateien:

* <a href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js" class="external-link" target="_blank">`swagger-ui-bundle.js`</a>
* <a href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css" class="external-link" target="_blank">`swagger-ui.css`</a>

Und **ReDoc** verwendet diese Datei:

* <a href="https://cdn.jsdelivr.net/npm/redoc@next/bundles/redoc.standalone.js" class="external-link" target="_blank">`redoc.standalone.js`</a>

Danach k√∂nnte Ihre Dateistruktur wie folgt aussehen:

```
.
‚îú‚îÄ‚îÄ app
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.py
‚îî‚îÄ‚îÄ static
    ‚îú‚îÄ‚îÄ redoc.standalone.js
    ‚îú‚îÄ‚îÄ swagger-ui-bundle.js
    ‚îî‚îÄ‚îÄ swagger-ui.css
```

### Die statischen Dateien bereitstellen

* Importieren Sie `StaticFiles`.
* ‚ÄûMounten‚Äú Sie eine `StaticFiles()`-Instanz in einem bestimmten Pfad.

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[7,11] *}

### Die statischen Dateien testen

Starten Sie Ihre Anwendung und gehen Sie auf <a href="http://127.0.0.1:8000/static/redoc.standalone.js" class="external-link" target="_blank">http://127.0.0.1:8000/static/redoc.standalone.js</a>.

Sie sollten eine sehr lange JavaScript-Datei f√ºr **ReDoc** sehen.

Sie k√∂nnte beginnen mit etwas wie:

```JavaScript
/*!
 * ReDoc - OpenAPI/Swagger-generated API Reference Documentation
 * -------------------------------------------------------------
 *   Version: "2.0.0-rc.18"
 *   Repo: https://github.com/Redocly/redoc
 */
!function(e,t){"object"==typeof exports&&"object"==typeof m

...
```

Das zeigt, dass Sie statische Dateien aus Ihrer Anwendung bereitstellen k√∂nnen und dass Sie die statischen Dateien f√ºr die Dokumentation an der richtigen Stelle platziert haben.

Jetzt k√∂nnen wir die Anwendung so konfigurieren, dass sie diese statischen Dateien f√ºr die Dokumentation verwendet.

### Die automatischen Dokumentationen deaktivieren, f√ºr statische Dateien

Wie bei der Verwendung eines benutzerdefinierten CDN besteht der erste Schritt darin, die automatischen Dokumentationen zu deaktivieren, da diese standardm√§√üig das CDN verwenden.

Um diese zu deaktivieren, setzen Sie deren URLs beim Erstellen Ihrer `FastAPI`-App auf `None`:

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[9] *}

### Die benutzerdefinierten Dokumentationen, mit statischen Dateien, hinzuf√ºgen

Und genau wie bei einem benutzerdefinierten CDN k√∂nnen Sie jetzt die *Pfadoperationen* f√ºr die benutzerdefinierten Dokumentationen erstellen.

Auch hier k√∂nnen Sie die internen Funktionen von FastAPI wiederverwenden, um die HTML-Seiten f√ºr die Dokumentationen zu erstellen, und diesen die erforderlichen Argumente √ºbergeben:

* `openapi_url`: die URL, unter der die HTML-Seite f√ºr die Dokumentation das OpenAPI-Schema f√ºr Ihre API abrufen kann. Sie k√∂nnen hier das Attribut `app.openapi_url` verwenden.
* `title`: der Titel Ihrer API.
* `oauth2_redirect_url`: Sie k√∂nnen hier `app.swagger_ui_oauth2_redirect_url` verwenden, um die Standardeinstellung zu verwenden.
* `swagger_js_url`: die URL, unter welcher der HTML-Code f√ºr Ihre Swagger-UI-Dokumentation die **JavaScript**-Datei abrufen kann. **Das ist die, welche jetzt von Ihrer eigenen Anwendung bereitgestellt wird**.
* `swagger_css_url`: die URL, unter welcher der HTML-Code f√ºr Ihre Swagger-UI-Dokumentation die **CSS**-Datei abrufen kann. **Das ist die, welche jetzt von Ihrer eigenen Anwendung bereitgestellt wird**.

Und genau so f√ºr ReDoc ...

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[2:6,14:22,25:27,30:36] *}

/// tip | Tipp

Die *Pfadoperation* f√ºr `swagger_ui_redirect` ist ein Hilfsmittel bei der Verwendung von OAuth2.

Wenn Sie Ihre API mit einem OAuth2-Anbieter integrieren, k√∂nnen Sie sich authentifizieren und mit den erworbenen Anmeldeinformationen zur API-Dokumentation zur√ºckkehren. Und mit ihr interagieren, die echte OAuth2-Authentifizierung verwendend.

Swagger UI erledigt das hinter den Kulissen f√ºr Sie, ben√∂tigt aber diesen ‚ÄûUmleitungs‚Äú-Helfer.

///

### Eine *Pfadoperation* erstellen, um statische Dateien zu testen

Um nun testen zu k√∂nnen, ob alles funktioniert, erstellen Sie eine *Pfadoperation*:

{* ../../docs_src/custom_docs_ui/tutorial002.py hl[39:41] *}

### Benutzeroberfl√§che, mit statischen Dateien, testen

Jetzt sollten Sie in der Lage sein, Ihr WLAN zu trennen, gehen Sie zu Ihrer Dokumentation unter <a href="http://127.0.0.1:8000/docs" class="external-link" target="_blank">http://127.0.0.1:8000/docs</a> und laden Sie die Seite neu.

Und selbst ohne Internet k√∂nnten Sie die Dokumentation f√ºr Ihre API sehen und damit interagieren.


================================================
File: /docs/de/docs/how-to/custom-request-and-route.md
================================================
# Benutzerdefinierte Request- und APIRoute-Klasse

In einigen F√§llen m√∂chten Sie m√∂glicherweise die von den Klassen `Request` und `APIRoute` verwendete Logik √ºberschreiben.

Das kann insbesondere eine gute Alternative zur Logik in einer Middleware sein.

Wenn Sie beispielsweise den Requestbody lesen oder manipulieren m√∂chten, bevor er von Ihrer Anwendung verarbeitet wird.

/// danger | Gefahr

Dies ist eine ‚Äûfortgeschrittene‚Äú Funktion.

Wenn Sie gerade erst mit **FastAPI** beginnen, m√∂chten Sie diesen Abschnitt vielleicht √ºberspringen.

///

## Anwendungsf√§lle

Einige Anwendungsf√§lle sind:

* Konvertieren von Nicht-JSON-Requestbodys nach JSON (z. B. <a href="https://msgpack.org/index.html" class="external-link" target="_blank">`msgpack`</a>).
* Dekomprimierung gzip-komprimierter Requestbodys.
* Automatisches Loggen aller Requestbodys.

## Handhaben von benutzerdefinierten Requestbody-Kodierungen

Sehen wir uns an, wie Sie eine benutzerdefinierte `Request`-Unterklasse verwenden, um gzip-Requests zu dekomprimieren.

Und eine `APIRoute`-Unterklasse zur Verwendung dieser benutzerdefinierten Requestklasse.

### Eine benutzerdefinierte `GzipRequest`-Klasse erstellen

/// tip | Tipp

Dies ist nur ein einfaches Beispiel, um zu demonstrieren, wie es funktioniert. Wenn Sie Gzip-Unterst√ºtzung ben√∂tigen, k√∂nnen Sie die bereitgestellte [`GzipMiddleware`](../advanced/middleware.md#gzipmiddleware){.internal-link target=_blank} verwenden.

///

Zuerst erstellen wir eine `GzipRequest`-Klasse, welche die Methode `Request.body()` √ºberschreibt, um den Body bei Vorhandensein eines entsprechenden Headers zu dekomprimieren.

Wenn der Header kein `gzip` enth√§lt, wird nicht versucht, den Body zu dekomprimieren.

Auf diese Weise kann dieselbe Routenklasse gzip-komprimierte oder unkomprimierte Requests verarbeiten.

{* ../../docs_src/custom_request_and_route/tutorial001.py hl[8:15] *}

### Eine benutzerdefinierte `GzipRoute`-Klasse erstellen

Als N√§chstes erstellen wir eine benutzerdefinierte Unterklasse von `fastapi.routing.APIRoute`, welche `GzipRequest` nutzt.

Dieses Mal wird die Methode `APIRoute.get_route_handler()` √ºberschrieben.

Diese Methode gibt eine Funktion zur√ºck. Und diese Funktion empf√§ngt einen Request und gibt eine Response zur√ºck.

Hier verwenden wir sie, um aus dem urspr√ºnglichen Request einen `GzipRequest` zu erstellen.

{* ../../docs_src/custom_request_and_route/tutorial001.py hl[18:26] *}

/// note | Technische Details

Ein `Request` hat ein `request.scope`-Attribut, welches einfach ein Python-`dict` ist, welches die mit dem Request verbundenen Metadaten enth√§lt.

Ein `Request` hat auch ein `request.receive`, welches eine Funktion ist, die den Hauptteil des Requests empf√§ngt.

Das `scope`-`dict` und die `receive`-Funktion sind beide Teil der ASGI-Spezifikation.

Und diese beiden Dinge, `scope` und `receive`, werden ben√∂tigt, um eine neue `Request`-Instanz zu erstellen.

Um mehr √ºber den `Request` zu erfahren, schauen Sie sich <a href="https://www.starlette.io/requests/" class="external-link" target="_blank">Starlettes Dokumentation zu Requests</a> an.

///

Das Einzige, was die von `GzipRequest.get_route_handler` zur√ºckgegebene Funktion anders macht, ist die Konvertierung von `Request` in ein `GzipRequest`.

Dabei k√ºmmert sich unser `GzipRequest` um die Dekomprimierung der Daten (falls erforderlich), bevor diese an unsere *Pfadoperationen* weitergegeben werden.

Danach ist die gesamte Verarbeitungslogik dieselbe.

Aufgrund unserer √Ñnderungen in `GzipRequest.body` wird der Requestbody jedoch bei Bedarf automatisch dekomprimiert, wenn er von **FastAPI** geladen wird.

## Zugriff auf den Requestbody in einem Exceptionhandler

/// tip | Tipp

Um dasselbe Problem zu l√∂sen, ist es wahrscheinlich viel einfacher, den `body` in einem benutzerdefinierten Handler f√ºr `RequestValidationError` zu verwenden ([Fehlerbehandlung](../tutorial/handling-errors.md#den-requestvalidationerror-body-verwenden){.internal-link target=_blank}).

Dieses Beispiel ist jedoch immer noch g√ºltig und zeigt, wie mit den internen Komponenten interagiert wird.

///

Wir k√∂nnen denselben Ansatz auch verwenden, um in einem Exceptionhandler auf den Requestbody zuzugreifen.

Alles, was wir tun m√ºssen, ist, den Request innerhalb eines `try`/`except`-Blocks zu handhaben:

{* ../../docs_src/custom_request_and_route/tutorial002.py hl[13,15] *}

Wenn eine Exception auftritt, befindet sich die `Request`-Instanz weiterhin im G√ºltigkeitsbereich, sodass wir den Requestbody lesen und bei der Fehlerbehandlung verwenden k√∂nnen:

{* ../../docs_src/custom_request_and_route/tutorial002.py hl[16:18] *}

## Benutzerdefinierte `APIRoute`-Klasse in einem Router

Sie k√∂nnen auch den Parameter `route_class` eines `APIRouter` festlegen:

{* ../../docs_src/custom_request_and_route/tutorial003.py hl[26] *}

In diesem Beispiel verwenden die *Pfadoperationen* unter dem `router` die benutzerdefinierte `TimedRoute`-Klasse und haben in der Response einen zus√§tzlichen `X-Response-Time`-Header mit der Zeit, die zum Generieren der Response ben√∂tigt wurde:

{* ../../docs_src/custom_request_and_route/tutorial003.py hl[13:20] *}


================================================
File: /docs/de/docs/how-to/extending-openapi.md
================================================
# OpenAPI erweitern

In einigen F√§llen m√ºssen Sie m√∂glicherweise das generierte OpenAPI-Schema √§ndern.

In diesem Abschnitt erfahren Sie, wie.

## Der normale Vorgang

Der normale (Standard-)Prozess ist wie folgt.

Eine `FastAPI`-Anwendung (-Instanz) verf√ºgt √ºber eine `.openapi()`-Methode, von der erwartet wird, dass sie das OpenAPI-Schema zur√ºckgibt.

Als Teil der Erstellung des Anwendungsobjekts wird eine *Pfadoperation* f√ºr `/openapi.json` (oder welcher Wert f√ºr den Parameter `openapi_url` gesetzt wurde) registriert.

Diese gibt lediglich eine JSON-Response zur√ºck, mit dem Ergebnis der Methode `.openapi()` der Anwendung.

Standardm√§√üig √ºberpr√ºft die Methode `.openapi()` die Eigenschaft `.openapi_schema`, um zu sehen, ob diese Inhalt hat, und gibt diesen zur√ºck.

Ist das nicht der Fall, wird der Inhalt mithilfe der Hilfsfunktion unter `fastapi.openapi.utils.get_openapi` generiert.

Und diese Funktion `get_openapi()` erh√§lt als Parameter:

* `title`: Der OpenAPI-Titel, der in der Dokumentation angezeigt wird.
* `version`: Die Version Ihrer API, z. B. `2.5.0`.
* `openapi_version`: Die Version der verwendeten OpenAPI-Spezifikation. Standardm√§√üig die neueste Version: `3.1.0`.
* `summary`: Eine kurze Zusammenfassung der API.
* `description`: Die Beschreibung Ihrer API. Dies kann Markdown enthalten und wird in der Dokumentation angezeigt.
* `routes`: Eine Liste von Routen, dies sind alle registrierten *Pfadoperationen*. Sie stammen von `app.routes`.

/// info

Der Parameter `summary` ist in OpenAPI 3.1.0 und h√∂her verf√ºgbar und wird von FastAPI 0.99.0 und h√∂her unterst√ºtzt.

///

## √úberschreiben der Standardeinstellungen

Mithilfe der oben genannten Informationen k√∂nnen Sie dieselbe Hilfsfunktion verwenden, um das OpenAPI-Schema zu generieren und jeden ben√∂tigten Teil zu √ºberschreiben.

F√ºgen wir beispielsweise <a href="https://github.com/Rebilly/ReDoc/blob/master/docs/redoc-vendor-extensions.md#x-logo" class="external-link" target="_blank">ReDocs OpenAPI-Erweiterung</a> zum Einbinden eines benutzerdefinierten Logos hinzu.

### Normales **FastAPI**

Schreiben Sie zun√§chst wie gewohnt Ihre ganze **FastAPI**-Anwendung:

{* ../../docs_src/extending_openapi/tutorial001.py hl[1,4,7:9] *}

### Das OpenAPI-Schema generieren

Verwenden Sie dann dieselbe Hilfsfunktion, um das OpenAPI-Schema innerhalb einer `custom_openapi()`-Funktion zu generieren:

{* ../../docs_src/extending_openapi/tutorial001.py hl[2,15:21] *}

### Das OpenAPI-Schema √§ndern

Jetzt k√∂nnen Sie die ReDoc-Erweiterung hinzuf√ºgen und dem `info`-‚ÄûObjekt‚Äú im OpenAPI-Schema ein benutzerdefiniertes `x-logo` hinzuf√ºgen:

{* ../../docs_src/extending_openapi/tutorial001.py hl[22:24] *}

### Zwischenspeichern des OpenAPI-Schemas

Sie k√∂nnen die Eigenschaft `.openapi_schema` als ‚ÄûCache‚Äú verwenden, um Ihr generiertes Schema zu speichern.

Auf diese Weise muss Ihre Anwendung das Schema nicht jedes Mal generieren, wenn ein Benutzer Ihre API-Dokumentation √∂ffnet.

Es wird nur einmal generiert und dann wird dasselbe zwischengespeicherte Schema f√ºr die n√§chsten Requests verwendet.

{* ../../docs_src/extending_openapi/tutorial001.py hl[13:14,25:26] *}

### Die Methode √ºberschreiben

Jetzt k√∂nnen Sie die Methode `.openapi()` durch Ihre neue Funktion ersetzen.

{* ../../docs_src/extending_openapi/tutorial001.py hl[29] *}

### Testen

Sobald Sie auf <a href="http://127.0.0.1:8000/redoc" class="external-link" target="_blank">http://127.0.0.1:8000/redoc</a> gehen, werden Sie sehen, dass Ihr benutzerdefiniertes Logo verwendet wird (in diesem Beispiel das Logo von **FastAPI**):

<img src="/img/tutorial/extending-openapi/image01.png">


================================================
File: /docs/de/docs/how-to/general.md
================================================
# Allgemeines ‚Äì How-To ‚Äì Rezepte

Hier finden Sie mehrere Verweise auf andere Stellen in der Dokumentation, f√ºr allgemeine oder h√§ufige Fragen.

## Daten filtern ‚Äì Sicherheit

Um sicherzustellen, dass Sie nicht mehr Daten zur√ºckgeben, als Sie sollten, lesen Sie die Dokumentation unter [Tutorial ‚Äì Responsemodell ‚Äì R√ºckgabetyp](../tutorial/response-model.md){.internal-link target=_blank}.

## Dokumentations-Tags ‚Äì OpenAPI

Um Tags zu Ihren *Pfadoperationen* hinzuzuf√ºgen und diese in der Oberfl√§che der Dokumentation zu gruppieren, lesen Sie die Dokumentation unter [Tutorial ‚Äì Pfadoperation-Konfiguration ‚Äì Tags](../tutorial/path-operation-configuration.md#tags){.internal-link target=_blank}.

## Zusammenfassung und Beschreibung in der Dokumentation ‚Äì OpenAPI

Um Ihren *Pfadoperationen* eine Zusammenfassung und Beschreibung hinzuzuf√ºgen und diese in der Oberfl√§che der Dokumentation anzuzeigen, lesen Sie die Dokumentation unter [Tutorial ‚Äì Pfadoperation-Konfiguration ‚Äì Zusammenfassung und Beschreibung](../tutorial/path-operation-configuration.md#zusammenfassung-und-beschreibung){.internal-link target=_blank}.

## Beschreibung der Response in der Dokumentation ‚Äì OpenAPI

Um die Beschreibung der Response zu definieren, welche in der Oberfl√§che der Dokumentation angezeigt wird, lesen Sie die Dokumentation unter [Tutorial ‚Äì Pfadoperation-Konfiguration ‚Äì Beschreibung der Response](../tutorial/path-operation-configuration.md#beschreibung-der-response){.internal-link target=_blank}.

## *Pfadoperation* in der Dokumentation deprecaten ‚Äì OpenAPI

Um eine *Pfadoperation* zu deprecaten ‚Äì sie als veraltet zu markieren ‚Äì und das in der Oberfl√§che der Dokumentation anzuzeigen, lesen Sie die Dokumentation unter [Tutorial ‚Äì Pfadoperation-Konfiguration ‚Äì Deprecaten](../tutorial/path-operation-configuration.md#eine-pfadoperation-deprecaten){.internal-link target=_blank}.

## Daten in etwas JSON-kompatibles konvertieren

Um Daten in etwas JSON-kompatibles zu konvertieren, lesen Sie die Dokumentation unter [Tutorial ‚Äì JSON-kompatibler Encoder](../tutorial/encoder.md){.internal-link target=_blank}.

## OpenAPI-Metadaten ‚Äì Dokumentation

Um Metadaten zu Ihrem OpenAPI-Schema hinzuzuf√ºgen, einschlie√ülich einer Lizenz, Version, Kontakt, usw., lesen Sie die Dokumentation unter [Tutorial ‚Äì Metadaten und URLs der Dokumentationen](../tutorial/metadata.md){.internal-link target=_blank}.

## Benutzerdefinierte OpenAPI-URL

Um die OpenAPI-URL anzupassen (oder zu entfernen), lesen Sie die Dokumentation unter [Tutorial ‚Äì Metadaten und URLs der Dokumentationen](../tutorial/metadata.md#openapi-url){.internal-link target=_blank}.

## URLs der OpenAPI-Dokumentationen

Um die URLs zu aktualisieren, die f√ºr die automatisch generierten Dokumentations-Oberfl√§chen verwendet werden, lesen Sie die Dokumentation unter [Tutorial ‚Äì Metadaten und URLs der Dokumentationen](../tutorial/metadata.md#urls-der-dokumentationen){.internal-link target=_blank}.


================================================
File: /docs/de/docs/how-to/graphql.md
================================================
# GraphQL

Da **FastAPI** auf dem **ASGI**-Standard basiert, ist es sehr einfach, jede **GraphQL**-Bibliothek zu integrieren, die auch mit ASGI kompatibel ist.

Sie k√∂nnen normale FastAPI-*Pfadoperationen* mit GraphQL in derselben Anwendung kombinieren.

/// tip | Tipp

**GraphQL** l√∂st einige sehr spezifische Anwendungsf√§lle.

Es hat **Vorteile** und **Nachteile** im Vergleich zu g√§ngigen **Web-APIs**.

Wiegen Sie ab, ob die **Vorteile** f√ºr Ihren Anwendungsfall die **Nachteile** ausgleichen. ü§ì

///

## GraphQL-Bibliotheken

Hier sind einige der **GraphQL**-Bibliotheken, welche **ASGI** unterst√ºtzen. Diese k√∂nnten Sie mit **FastAPI** verwenden:

* <a href="https://strawberry.rocks/" class="external-link" target="_blank">Strawberry</a> üçì
    * Mit <a href="https://strawberry.rocks/docs/integrations/fastapi" class="external-link" target="_blank">Dokumentation f√ºr FastAPI</a>
* <a href="https://ariadnegraphql.org/" class="external-link" target="_blank">Ariadne</a>
    * Mit <a href="https://ariadnegraphql.org/docs/fastapi-integration" class="external-link" target="_blank">Dokumentation f√ºr FastAPI</a>
* <a href="https://tartiflette.io/" class="external-link" target="_blank">Tartiflette</a>
    * Mit <a href="https://tartiflette.github.io/tartiflette-asgi/" class="external-link" target="_blank">Tartiflette ASGI</a>, f√ºr ASGI-Integration
* <a href="https://graphene-python.org/" class="external-link" target="_blank">Graphene</a>
    * Mit <a href="https://github.com/ciscorn/starlette-graphene3" class="external-link" target="_blank">starlette-graphene3</a>

## GraphQL mit Strawberry

Wenn Sie mit **GraphQL** arbeiten m√∂chten oder m√ºssen, ist <a href="https://strawberry.rocks/" class="external-link" target="_blank">**Strawberry**</a> die **empfohlene** Bibliothek, da deren Design dem Design von **FastAPI** am n√§chsten kommt und alles auf **Typannotationen** basiert.

Abh√§ngig von Ihrem Anwendungsfall bevorzugen Sie vielleicht eine andere Bibliothek, aber wenn Sie mich fragen w√ºrden, w√ºrde ich Ihnen wahrscheinlich empfehlen, **Strawberry** auszuprobieren.

Hier ist eine kleine Vorschau, wie Sie Strawberry mit FastAPI integrieren k√∂nnen:

{* ../../docs_src/graphql/tutorial001.py hl[3,22,25:26] *}

Weitere Informationen zu Strawberry finden Sie in der <a href="https://strawberry.rocks/" class="external-link" target="_blank">Strawberry-Dokumentation</a>.

Und auch die Dokumentation zu <a href="https://strawberry.rocks/docs/integrations/fastapi" class="external-link" target="_blank">Strawberry mit FastAPI</a>.

## √Ñltere `GraphQLApp` von Starlette

Fr√ºhere Versionen von Starlette enthielten eine `GraphQLApp`-Klasse zur Integration mit <a href="https://graphene-python.org/" class="external-link" target="_blank">Graphene</a>.

Das wurde von Starlette deprecated, aber wenn Sie Code haben, der das verwendet, k√∂nnen Sie einfach zu <a href="https://github.com/ciscorn/starlette-graphene3" class="external-link" target="_blank">starlette-graphene3</a> **migrieren**, welches denselben Anwendungsfall abdeckt und √ºber eine **fast identische Schnittstelle** verf√ºgt.

/// tip | Tipp

Wenn Sie GraphQL ben√∂tigen, w√ºrde ich Ihnen trotzdem empfehlen, sich <a href="https://strawberry.rocks/" class="external-link" target="_blank">Strawberry</a> anzuschauen, da es auf Typannotationen basiert, statt auf benutzerdefinierten Klassen und Typen.

///

## Mehr dar√ºber lernen

Weitere Informationen zu **GraphQL** finden Sie in der <a href="https://graphql.org/" class="external-link" target="_blank">offiziellen GraphQL-Dokumentation</a>.

Sie k√∂nnen auch mehr √ºber jede der oben beschriebenen Bibliotheken in den jeweiligen Links lesen.


================================================
File: /docs/de/docs/how-to/index.md
================================================
# How-To ‚Äì Rezepte

Hier finden Sie verschiedene Rezepte und ‚ÄûHow-To‚Äú-Anleitungen zu **verschiedenen Themen**.

Die meisten dieser Ideen sind mehr oder weniger **unabh√§ngig**, und in den meisten F√§llen m√ºssen Sie diese nur studieren, wenn sie direkt auf **Ihr Projekt** anwendbar sind.

Wenn etwas f√ºr Ihr Projekt interessant und n√ºtzlich erscheint, lesen Sie es, andernfalls √ºberspringen Sie es einfach.

/// tip | Tipp

Wenn Sie strukturiert **FastAPI lernen** m√∂chten (empfohlen), lesen Sie stattdessen Kapitel f√ºr Kapitel das [Tutorial ‚Äì Benutzerhandbuch](../tutorial/index.md){.internal-link target=_blank}.

///


================================================
File: /docs/de/docs/how-to/separate-openapi-schemas.md
================================================
# Separate OpenAPI-Schemas f√ºr Eingabe und Ausgabe oder nicht

Bei Verwendung von **Pydantic v2** ist die generierte OpenAPI etwas genauer und **korrekter** als zuvor. üòé

Tats√§chlich gibt es in einigen F√§llen sogar **zwei JSON-Schemas** in OpenAPI f√ºr dasselbe Pydantic-Modell f√ºr Eingabe und Ausgabe, je nachdem, ob sie **Defaultwerte** haben.

Sehen wir uns an, wie das funktioniert und wie Sie es bei Bedarf √§ndern k√∂nnen.

## Pydantic-Modelle f√ºr Eingabe und Ausgabe

Nehmen wir an, Sie haben ein Pydantic-Modell mit Defaultwerten wie dieses:

{* ../../docs_src/separate_openapi_schemas/tutorial001_py310.py ln[1:7] hl[7] *}

### Modell f√ºr Eingabe

Wenn Sie dieses Modell wie hier als Eingabe verwenden:

{* ../../docs_src/separate_openapi_schemas/tutorial001_py310.py ln[1:15] hl[14] *}

... dann ist das Feld `description` **nicht erforderlich**. Weil es den Defaultwert `None` hat.

### Eingabemodell in der Dokumentation

Sie k√∂nnen √ºberpr√ºfen, dass das Feld `description` in der Dokumentation kein **rotes Sternchen** enth√§lt, es ist nicht als erforderlich markiert:

<div class="screenshot">
<img src="/img/tutorial/separate-openapi-schemas/image01.png">
</div>

### Modell f√ºr die Ausgabe

Wenn Sie jedoch dasselbe Modell als Ausgabe verwenden, wie hier:

{* ../../docs_src/separate_openapi_schemas/tutorial001_py310.py hl[19] *}

... dann, weil  `description` einen Defaultwert hat, wird es, wenn Sie f√ºr dieses Feld **nichts zur√ºckgeben**, immer noch diesen **Defaultwert** haben.

### Modell f√ºr Ausgabe-Responsedaten

Wenn Sie mit der Dokumentation interagieren und die Response √ºberpr√ºfen, enth√§lt die JSON-Response den Defaultwert (`null`), obwohl der Code nichts in eines der `description`-Felder geschrieben hat:

<div class="screenshot">
<img src="/img/tutorial/separate-openapi-schemas/image02.png">
</div>

Das bedeutet, dass es **immer einen Wert** hat, der Wert kann jedoch manchmal `None` sein (oder `null` in JSON).

Das bedeutet, dass Clients, die Ihre API verwenden, nicht pr√ºfen m√ºssen, ob der Wert vorhanden ist oder nicht. Sie k√∂nnen davon ausgehen, dass das Feld immer vorhanden ist. In einigen F√§llen hat es jedoch nur den Defaultwert `None`.

Um dies in OpenAPI zu kennzeichnen, markieren Sie dieses Feld als **erforderlich**, da es immer vorhanden sein wird.

Aus diesem Grund kann das JSON-Schema f√ºr ein Modell unterschiedlich sein, je nachdem, ob es f√ºr **Eingabe oder Ausgabe** verwendet wird:

* f√ºr die **Eingabe** ist `description` **nicht erforderlich**
* f√ºr die **Ausgabe** ist es **erforderlich** (und m√∂glicherweise `None` oder, in JSON-Begriffen, `null`)

### Ausgabemodell in der Dokumentation

Sie k√∂nnen das Ausgabemodell auch in der Dokumentation √ºberpr√ºfen. **Sowohl** `name` **als auch** `description` sind mit einem **roten Sternchen** als **erforderlich** markiert:

<div class="screenshot">
<img src="/img/tutorial/separate-openapi-schemas/image03.png">
</div>

### Eingabe- und Ausgabemodell in der Dokumentation

Und wenn Sie alle verf√ºgbaren Schemas (JSON-Schemas) in OpenAPI √ºberpr√ºfen, werden Sie feststellen, dass es zwei gibt, ein `Item-Input` und ein `Item-Output`.

F√ºr `Item-Input` ist `description` **nicht erforderlich**, es hat kein rotes Sternchen.

Aber f√ºr `Item-Output` ist `description` **erforderlich**, es hat ein rotes Sternchen.

<div class="screenshot">
<img src="/img/tutorial/separate-openapi-schemas/image04.png">
</div>

Mit dieser Funktion von **Pydantic v2** ist Ihre API-Dokumentation **pr√§ziser**, und wenn Sie √ºber automatisch generierte Clients und SDKs verf√ºgen, sind diese auch pr√§ziser, mit einer besseren **Entwicklererfahrung** und Konsistenz. üéâ

## Schemas nicht trennen

Nun gibt es einige F√§lle, in denen Sie m√∂glicherweise **dasselbe Schema f√ºr Eingabe und Ausgabe** haben m√∂chten.

Der Hauptanwendungsfall hierf√ºr besteht wahrscheinlich darin, dass Sie das mal tun m√∂chten, wenn Sie bereits √ºber einige automatisch generierte Client-Codes/SDKs verf√ºgen und im Moment nicht alle automatisch generierten Client-Codes/SDKs aktualisieren m√∂chten, m√∂glicherweise sp√§ter, aber nicht jetzt.

In diesem Fall k√∂nnen Sie diese Funktion in **FastAPI** mit dem Parameter `separate_input_output_schemas=False` deaktivieren.

/// info

Unterst√ºtzung f√ºr `separate_input_output_schemas` wurde in FastAPI `0.102.0` hinzugef√ºgt. ü§ì

///

{* ../../docs_src/separate_openapi_schemas/tutorial002_py310.py hl[10] *}

### Gleiches Schema f√ºr Eingabe- und Ausgabemodelle in der Dokumentation

Und jetzt wird es ein einziges Schema f√ºr die Eingabe und Ausgabe des Modells geben, nur `Item`, und es wird `description` als **nicht erforderlich** kennzeichnen:

<div class="screenshot">
<img src="/img/tutorial/separate-openapi-schemas/image05.png">
</div>

Dies ist das gleiche Verhalten wie in Pydantic v1. ü§ì


================================================
File: /docs/de/docs/learn/index.md
================================================
# Lernen

Hier finden Sie die einf√ºhrenden Kapitel und Tutorials zum Erlernen von **FastAPI**.

Sie k√∂nnten dies als **Buch**, als **Kurs**, als **offizielle** und empfohlene Methode zum Erlernen von FastAPI betrachten. üòé


================================================
File: /docs/de/docs/resources/index.md
================================================
# Ressourcen

Zus√§tzliche Ressourcen, externe Links, Artikel und mehr. ‚úàÔ∏è


================================================
File: /docs/de/docs/tutorial/background-tasks.md
================================================
# Hintergrundtasks

Sie k√∂nnen Hintergrundtasks (Hintergrund-Aufgaben) definieren, die *nach* der R√ºckgabe einer Response ausgef√ºhrt werden sollen.

Das ist n√ºtzlich f√ºr Vorg√§nge, die nach einem Request ausgef√ºhrt werden m√ºssen, bei denen der Client jedoch nicht unbedingt auf den Abschluss des Vorgangs warten muss, bevor er die Response erh√§lt.

Hierzu z√§hlen beispielsweise:

* E-Mail-Benachrichtigungen, die nach dem Ausf√ºhren einer Aktion gesendet werden:
    * Da die Verbindung zu einem E-Mail-Server und das Senden einer E-Mail in der Regel ‚Äûlangsam‚Äú ist (einige Sekunden), k√∂nnen Sie die Response sofort zur√ºcksenden und die E-Mail-Benachrichtigung im Hintergrund senden.
* Daten verarbeiten:
    * Angenommen, Sie erhalten eine Datei, die einen langsamen Prozess durchlaufen muss. Sie k√∂nnen als Response ‚ÄûAccepted‚Äú (HTTP 202) zur√ºckgeben und die Datei im Hintergrund verarbeiten.

## `BackgroundTasks` verwenden

Importieren Sie zun√§chst `BackgroundTasks` und definieren Sie einen Parameter in Ihrer *Pfadoperation-Funktion* mit der Typdeklaration `BackgroundTasks`:

{* ../../docs_src/background_tasks/tutorial001.py hl[1,13] *}

**FastAPI** erstellt f√ºr Sie das Objekt vom Typ `BackgroundTasks` und √ºbergibt es als diesen Parameter.

## Eine Taskfunktion erstellen

Erstellen Sie eine Funktion, die als Hintergrundtask ausgef√ºhrt werden soll.

Es handelt sich schlicht um eine Standard-Funktion, die Parameter empfangen kann.

Es kann sich um eine `async def`- oder normale `def`-Funktion handeln. **FastAPI** wei√ü, wie damit zu verfahren ist.

In diesem Fall schreibt die Taskfunktion in eine Datei (den Versand einer E-Mail simulierend).

Und da der Schreibvorgang nicht `async` und `await` verwendet, definieren wir die Funktion mit normalem `def`:

{* ../../docs_src/background_tasks/tutorial001.py hl[6:9] *}

## Den Hintergrundtask hinzuf√ºgen

√úbergeben Sie innerhalb Ihrer *Pfadoperation-Funktion* Ihre Taskfunktion mit der Methode `.add_task()` an das *Hintergrundtasks*-Objekt:

{* ../../docs_src/background_tasks/tutorial001.py hl[14] *}
